(()=>{var e={};e.id=279,e.ids=[279],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2268:(e,t,r)=>{"use strict";r.d(t,{SimplifiedCheckout:()=>s});let s=(0,r(2907).registerClientReference)(function(){throw Error("Attempted to call SimplifiedCheckout() from the server but SimplifiedCheckout is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/frontend/src/components/checkout/simplified-checkout.tsx","SimplifiedCheckout")},2487:(e,t,r)=>{Promise.resolve().then(r.bind(r,9601))},2655:(e,t,r)=>{Promise.resolve().then(r.bind(r,2268))},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},3873:e=>{"use strict";e.exports=require("path")},4787:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var s=r(7413),a=r(2268);function i(){return(0,s.jsx)(a.SimplifiedCheckout,{})}},6189:(e,t,r)=>{"use strict";var s=r(5773);r.o(s,"usePathname")&&r.d(t,{usePathname:function(){return s.usePathname}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},7499:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>d,pages:()=>c,routeModule:()=>h,tree:()=>u});var s=r(5239),a=r(8088),i=r(8170),n=r.n(i),o=r(893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let u={children:["",{children:["checkout",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,4787)),"/app/frontend/src/app/checkout/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,4431)),"/app/frontend/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,7398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,9999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,5284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["/app/frontend/src/app/checkout/page.tsx"],d={require:r,loadChunk:()=>Promise.resolve()},h=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/checkout/page",pathname:"/checkout",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:u}})},8038:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1991).A)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])},8059:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(1991).A)("truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]])},9121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},9601:(e,t,r)=>{"use strict";let s,a;r.d(t,{SimplifiedCheckout:()=>nj});var i,n,o,l,u,c,d,h,p,f,m,g,y,v,_,b=r(687),w=r(3210),k=r(6189),x=e=>"checkbox"===e.type,S=e=>e instanceof Date,T=e=>null==e;let j=e=>"object"==typeof e;var E=e=>!T(e)&&!Array.isArray(e)&&j(e)&&!S(e),A=e=>E(e)&&e.target?x(e.target)?e.target.checked:e.target.value:e,O=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,R=(e,t)=>e.has(O(t)),C=e=>{let t=e.constructor&&e.constructor.prototype;return E(t)&&t.hasOwnProperty("isPrototypeOf")},N="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function P(e){if(e instanceof Date)return new Date(e);let t="undefined"!=typeof FileList&&e instanceof FileList;if(N&&(e instanceof Blob||t))return e;let r=Array.isArray(e);if(!r&&!(E(e)&&C(e)))return e;let s=r?[]:Object.create(Object.getPrototypeOf(e));for(let t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=P(e[t]));return s}var I=e=>/^\w*$/.test(e),$=e=>void 0===e,D=e=>Array.isArray(e)?e.filter(Boolean):[],U=e=>D(e.replace(/["|']|\]/g,"").split(/\.|\[/)),L=(e,t,r)=>{if(!t||!E(e))return r;let s=(I(t)?[t]:U(t)).reduce((e,t)=>T(e)?e:e[t],e);return $(s)||s===e?$(e[t])?r:e[t]:s},F=e=>"boolean"==typeof e,V=e=>"function"==typeof e,B=(e,t,r)=>{let s=-1,a=I(t)?[t]:U(t),i=a.length,n=i-1;for(;++s<i;){let t=a[s],i=r;if(s!==n){let r=e[t];i=E(r)||Array.isArray(r)?r:isNaN(+a[s+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=i,e=e[t]}};let M={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},q={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},z={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},K=w.createContext(null);K.displayName="HookFormControlContext";let W=()=>w.useContext(K);var Z=(e,t,r,s=!0)=>{let a={defaultValues:t._defaultValues};for(let i in e)Object.defineProperty(a,i,{get:()=>(t._proxyFormState[i]!==q.all&&(t._proxyFormState[i]=!s||q.all),r&&(r[i]=!0),e[i])});return a};let G="undefined"!=typeof window?w.useLayoutEffect:w.useEffect;var H=e=>"string"==typeof e,J=(e,t,r,s,a)=>H(e)?(s&&t.watch.add(e),L(r,e,a)):Array.isArray(e)?e.map(e=>(s&&t.watch.add(e),L(r,e))):(s&&(t.watchAll=!0),r),Y=e=>T(e)||!j(e);function X(e,t,r=new WeakSet){if(Y(e)||Y(t))return Object.is(e,t);if(S(e)&&S(t))return Object.is(e.getTime(),t.getTime());let s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;if(r.has(e)||r.has(t))return!0;for(let i of(r.add(e),r.add(t),s)){let s=e[i];if(!a.includes(i))return!1;if("ref"!==i){let e=t[i];if(S(s)&&S(e)||E(s)&&E(e)||Array.isArray(s)&&Array.isArray(e)?!X(s,e,r):!Object.is(s,e))return!1}}return!0}let Q=e=>e.render(function(e){let t=W(),{name:r,disabled:s,control:a=t,shouldUnregister:i,defaultValue:n,exact:o=!0}=e,l=R(a._names.array,r),u=w.useMemo(()=>L(a._formValues,r,L(a._defaultValues,r,n)),[a,r,n]),c=function(e){let t=W(),{control:r=t,name:s,defaultValue:a,disabled:i,exact:n,compute:o}=e||{},l=w.useRef(a),u=w.useRef(o),c=w.useRef(void 0),d=w.useRef(r),h=w.useRef(s);u.current=o;let[p,f]=w.useState(()=>{let e=r._getWatch(s,l.current);return u.current?u.current(e):e}),m=w.useCallback(e=>{let t=J(s,r._names,e||r._formValues,!1,l.current);return u.current?u.current(t):t},[r._formValues,r._names,s]),g=w.useCallback(e=>{if(!i){let t=J(s,r._names,e||r._formValues,!1,l.current);if(u.current){let e=u.current(t);X(e,c.current)||(f(e),c.current=e)}else f(t)}},[r._formValues,r._names,i,s]);G(()=>(d.current===r&&X(h.current,s)||(d.current=r,h.current=s,g()),r._subscribe({name:s,formState:{values:!0},exact:n,callback:e=>{g(e.values)}})),[r,n,s,g]),w.useEffect(()=>r._removeUnmounted());let y=d.current!==r,v=h.current,_=w.useMemo(()=>{if(i)return null;let e=!y&&!X(v,s);return y||e?m():null},[i,y,s,v,m]);return null!==_?_:p}({control:a,name:r,defaultValue:u,exact:o}),d=function(e){let t=W(),{control:r=t,disabled:s,name:a,exact:i}=e||{},[n,o]=w.useState(r._formState),l=w.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return G(()=>r._subscribe({name:a,formState:l.current,exact:i,callback:e=>{s||o({...r._formState,...e})}}),[a,s,i]),w.useEffect(()=>{l.current.isValid&&r._setValid(!0)},[r]),w.useMemo(()=>Z(n,r,l.current,!1),[n,r])}({control:a,name:r,exact:o}),h=w.useRef(e),p=w.useRef(void 0),f=w.useRef(a.register(r,{...e.rules,value:c,...F(e.disabled)?{disabled:e.disabled}:{}}));h.current=e;let m=w.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!L(d.errors,r)},isDirty:{enumerable:!0,get:()=>!!L(d.dirtyFields,r)},isTouched:{enumerable:!0,get:()=>!!L(d.touchedFields,r)},isValidating:{enumerable:!0,get:()=>!!L(d.validatingFields,r)},error:{enumerable:!0,get:()=>L(d.errors,r)}}),[d,r]),g=w.useCallback(e=>f.current.onChange({target:{value:A(e),name:r},type:M.CHANGE}),[r]),y=w.useCallback(()=>f.current.onBlur({target:{value:L(a._formValues,r),name:r},type:M.BLUR}),[r,a._formValues]),v=w.useCallback(e=>{let t=L(a._fields,r);t&&t._f&&e&&(t._f.ref={focus:()=>V(e.focus)&&e.focus(),select:()=>V(e.select)&&e.select(),setCustomValidity:t=>V(e.setCustomValidity)&&e.setCustomValidity(t),reportValidity:()=>V(e.reportValidity)&&e.reportValidity()})},[a._fields,r]),_=w.useMemo(()=>({name:r,value:c,...F(s)||d.disabled?{disabled:d.disabled||s}:{},onChange:g,onBlur:y,ref:v}),[r,s,d.disabled,g,y,v,c]);return w.useEffect(()=>{let e=a._options.shouldUnregister||i,t=p.current;t&&t!==r&&!l&&a.unregister(t),a.register(r,{...h.current.rules,...F(h.current.disabled)?{disabled:h.current.disabled}:{}});let s=(e,t)=>{let r=L(a._fields,e);r&&r._f&&(r._f.mount=t)};if(s(r,!0),e){let e=P(L(a._options.defaultValues,r,h.current.defaultValue));B(a._defaultValues,r,e),$(L(a._formValues,r))&&B(a._formValues,r,e)}return l||a.register(r),p.current=r,()=>{(l?e&&!a._state.action:e)?a.unregister(r):s(r,!1)}},[r,a,l,i]),w.useEffect(()=>{a._setDisabledField({disabled:s,name:r})},[s,r,a]),w.useMemo(()=>({field:_,formState:d,fieldState:m}),[_,d,m])}(e)),ee=w.createContext(null);ee.displayName="HookFormContext";let et=()=>w.useContext(ee);var er=(e,t,r,s,a)=>t?{...r[e],types:{...r[e]&&r[e].types?r[e].types:{},[s]:a||!0}}:{},es=e=>Array.isArray(e)?e:[e],ea=()=>{let e=[];return{get observers(){return e},next:t=>{for(let r of e)r.next&&r.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter(e=>e!==t)}}),unsubscribe:()=>{e=[]}}},ei=e=>E(e)&&!Object.keys(e).length,en=e=>"file"===e.type,eo=e=>{if(!N)return!1;let t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},el=e=>"select-multiple"===e.type,eu=e=>"radio"===e.type,ec=e=>eu(e)||x(e),ed=e=>eo(e)&&e.isConnected;function eh(e,t){let r=Array.isArray(t)?t:I(t)?[t]:U(t),s=1===r.length?e:function(e,t){let r=t.slice(0,-1).length,s=0;for(;s<r;)e=$(e)?s++:e[t[s++]];return e}(e,r),a=r.length-1,i=r[a];return s&&delete s[i],0!==a&&(E(s)&&ei(s)||Array.isArray(s)&&function(e){for(let t in e)if(e.hasOwnProperty(t)&&!$(e[t]))return!1;return!0}(s))&&eh(e,r.slice(0,-1)),e}var ep=e=>{for(let t in e)if(V(e[t]))return!0;return!1};function ef(e){return Array.isArray(e)||E(e)&&!ep(e)}function em(e,t={}){for(let r in e){let s=e[r];ef(s)?(t[r]=Array.isArray(s)?[]:{},em(s,t[r])):$(s)||(t[r]=!0)}return t}function eg(e,t,r){for(let s in r||(r=em(t)),e){let a=e[s];if(ef(a))$(t)||Y(r[s])?r[s]=em(a,Array.isArray(a)?[]:{}):eg(a,T(t)?{}:t[s],r[s]);else{let e=t[s];r[s]=!X(a,e)}}return r}let ey={value:!1,isValid:!1},ev={value:!0,isValid:!0};var e_=e=>{if(Array.isArray(e)){if(e.length>1){let t=e.filter(e=>e&&e.checked&&!e.disabled).map(e=>e.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!$(e[0].attributes.value)?$(e[0].value)||""===e[0].value?ev:{value:e[0].value,isValid:!0}:ev:ey}return ey},eb=(e,{valueAsNumber:t,valueAsDate:r,setValueAs:s})=>$(e)?e:t?""===e?NaN:e?+e:e:r&&H(e)?new Date(e):s?s(e):e;let ew={isValid:!1,value:null};var ek=e=>Array.isArray(e)?e.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,ew):ew;function ex(e){let t=e.ref;return en(t)?t.files:eu(t)?ek(e.refs).value:el(t)?[...t.selectedOptions].map(({value:e})=>e):x(t)?e_(e.refs).value:eb($(t.value)?e.ref.value:t.value,e)}var eS=(e,t,r,s)=>{let a={};for(let r of e){let e=L(t,r);e&&B(a,r,e._f)}return{criteriaMode:r,names:[...e],fields:a,shouldUseNativeValidation:s}},eT=e=>e instanceof RegExp,ej=e=>$(e)?e:eT(e)?e.source:E(e)?eT(e.value)?e.value.source:e.value:e,eE=e=>({isOnSubmit:!e||e===q.onSubmit,isOnBlur:e===q.onBlur,isOnChange:e===q.onChange,isOnAll:e===q.all,isOnTouch:e===q.onTouched});let eA="AsyncFunction";var eO=e=>!!e&&!!e.validate&&!!(V(e.validate)&&e.validate.constructor.name===eA||E(e.validate)&&Object.values(e.validate).find(e=>e.constructor.name===eA)),eR=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate),eC=(e,t,r)=>!r&&(t.watchAll||t.watch.has(e)||[...t.watch].some(t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length))));let eN=(e,t,r,s)=>{for(let a of r||Object.keys(e)){let r=L(e,a);if(r){let{_f:e,...i}=r;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],a)&&!s)return!0;else if(e.ref&&t(e.ref,e.name)&&!s)return!0;else if(eN(i,t))break}else if(E(i)&&eN(i,t))break}}};function eP(e,t,r){let s=L(e,r);if(s||I(r))return{error:s,name:r};let a=r.split(".");for(;a.length;){let s=a.join("."),i=L(t,s),n=L(e,s);if(i&&!Array.isArray(i)&&r!==s)break;if(n&&n.type)return{name:s,error:n};if(n&&n.root&&n.root.type)return{name:`${s}.root`,error:n.root};a.pop()}return{name:r}}var eI=(e,t,r,s)=>{r(e);let{name:a,...i}=e;return ei(i)||Object.keys(i).length>=Object.keys(t).length||Object.keys(i).find(e=>t[e]===(!s||q.all))},e$=(e,t,r)=>!e||!t||e===t||es(e).some(e=>e&&(r?e===t:e.startsWith(t)||t.startsWith(e))),eD=(e,t,r,s,a)=>!a.isOnAll&&(!r&&a.isOnTouch?!(t||e):(r?s.isOnBlur:a.isOnBlur)?!e:(r?!s.isOnChange:!a.isOnChange)||e),eU=(e,t)=>!D(L(e,t)).length&&eh(e,t),eL=(e,t,r)=>{let s=es(L(e,r));return B(s,"root",t[r]),B(e,r,s),e};function eF(e,t,r="validate"){if(H(e)||Array.isArray(e)&&e.every(H)||F(e)&&!e)return{type:r,message:H(e)?e:"",ref:t}}var eV=e=>E(e)&&!eT(e)?e:{value:e,message:""},eB=async(e,t,r,s,a,i)=>{let{ref:n,refs:o,required:l,maxLength:u,minLength:c,min:d,max:h,pattern:p,validate:f,name:m,valueAsNumber:g,mount:y}=e._f,v=L(r,m);if(!y||t.has(m))return{};let _=o?o[0]:n,b=e=>{a&&_.reportValidity&&(_.setCustomValidity(F(e)?"":e||""),_.reportValidity())},w={},k=eu(n),S=x(n),j=(g||en(n))&&$(n.value)&&$(v)||eo(n)&&""===n.value||""===v||Array.isArray(v)&&!v.length,A=er.bind(null,m,s,w),O=(e,t,r,s=z.maxLength,a=z.minLength)=>{let i=e?t:r;w[m]={type:e?s:a,message:i,ref:n,...A(e?s:a,i)}};if(i?!Array.isArray(v)||!v.length:l&&(!(k||S)&&(j||T(v))||F(v)&&!v||S&&!e_(o).isValid||k&&!ek(o).isValid)){let{value:e,message:t}=H(l)?{value:!!l,message:l}:eV(l);if(e&&(w[m]={type:z.required,message:t,ref:_,...A(z.required,t)},!s))return b(t),w}if(!j&&(!T(d)||!T(h))){let e,t,r=eV(h),a=eV(d);if(T(v)||isNaN(v)){let s=n.valueAsDate||new Date(v),i=e=>new Date(new Date().toDateString()+" "+e),o="time"==n.type,l="week"==n.type;H(r.value)&&v&&(e=o?i(v)>i(r.value):l?v>r.value:s>new Date(r.value)),H(a.value)&&v&&(t=o?i(v)<i(a.value):l?v<a.value:s<new Date(a.value))}else{let s=n.valueAsNumber||(v?+v:v);T(r.value)||(e=s>r.value),T(a.value)||(t=s<a.value)}if((e||t)&&(O(!!e,r.message,a.message,z.max,z.min),!s))return b(w[m].message),w}if((u||c)&&!j&&(H(v)||i&&Array.isArray(v))){let e=eV(u),t=eV(c),r=!T(e.value)&&v.length>+e.value,a=!T(t.value)&&v.length<+t.value;if((r||a)&&(O(r,e.message,t.message),!s))return b(w[m].message),w}if(p&&!j&&H(v)){let{value:e,message:t}=eV(p);if(eT(e)&&!v.match(e)&&(w[m]={type:z.pattern,message:t,ref:n,...A(z.pattern,t)},!s))return b(t),w}if(f){if(V(f)){let e=eF(await f(v,r),_);if(e&&(w[m]={...e,...A(z.validate,e.message)},!s))return b(e.message),w}else if(E(f)){let e={};for(let t in f){if(!ei(e)&&!s)break;let a=eF(await f[t](v,r),_,t);a&&(e={...a,...A(t,a.message)},b(a.message),s&&(w[m]=e))}if(!ei(e)&&(w[m]={ref:_,...e},!s))return w}}return b(!0),w};let eM={mode:q.onSubmit,reValidateMode:q.onChange,shouldFocusError:!0},eq=(e,t,r)=>{if(e&&"reportValidity"in e){let s=L(r,t);e.setCustomValidity(s&&s.message||""),e.reportValidity()}},ez=(e,t)=>{for(let r in t.fields){let s=t.fields[r];s&&s.ref&&"reportValidity"in s.ref?eq(s.ref,r,e):s&&s.refs&&s.refs.forEach(t=>eq(t,r,e))}},eK=(e,t)=>{t.shouldUseNativeValidation&&ez(e,t);let r={};for(let s in e){let a=L(t.fields,s),i=Object.assign(e[s]||{},{ref:a&&a.ref});if(eW(t.names||Object.keys(e),s)){let e=Object.assign({},L(r,s));B(e,"root",i),B(r,s,e)}else B(r,s,i)}return r},eW=(e,t)=>{let r=eZ(t);return e.some(e=>eZ(e).match(`^${r}\\.\\d+`))};function eZ(e){return e.replace(/\]|\[/g,"")}function eG(e,t,r){function s(r,s){var a;for(let i in Object.defineProperty(r,"_zod",{value:r._zod??{},enumerable:!1}),(a=r._zod).traits??(a.traits=new Set),r._zod.traits.add(e),t(r,s),n.prototype)i in r||Object.defineProperty(r,i,{value:n.prototype[i].bind(r)});r._zod.constr=n,r._zod.def=s}let a=r?.Parent??Object;class i extends a{}function n(e){var t;let a=r?.Parent?new i:this;for(let r of(s(a,e),(t=a._zod).deferred??(t.deferred=[]),a._zod.deferred))r();return a}return Object.defineProperty(i,"name",{value:e}),Object.defineProperty(n,"init",{value:s}),Object.defineProperty(n,Symbol.hasInstance,{value:t=>!!r?.Parent&&t instanceof r.Parent||t?._zod?.traits?.has(e)}),Object.defineProperty(n,"name",{value:e}),n}Object.freeze({status:"aborted"}),Symbol("zod_brand");class eH extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}let eJ={};function eY(e){return e&&Object.assign(eJ,e),eJ}function eX(e,t){return"bigint"==typeof t?t.toString():t}let eQ=Error.captureStackTrace?Error.captureStackTrace:(...e)=>{};function e0(e){return"string"==typeof e?e:e?.message}function e1(e,t,r){let s={...e,path:e.path??[]};return e.message||(s.message=e0(e.inst?._zod.def?.error?.(e))??e0(t?.error?.(e))??e0(r.customError?.(e))??e0(r.localeError?.(e))??"Invalid input"),delete s.inst,delete s.continue,t?.reportInput||delete s.input,s}Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MAX_VALUE,Number.MAX_VALUE;let e2=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),Object.defineProperty(e,"message",{get:()=>JSON.stringify(t,eX,2),enumerable:!0}),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},e4=eG("$ZodError",e2),e9=eG("$ZodError",e2,{Parent:Error}),e5=(e,t,r,s)=>{let a=r?Object.assign(r,{async:!1}):{async:!1},i=e._zod.run({value:t,issues:[]},a);if(i instanceof Promise)throw new eH;if(i.issues.length){let e=new(s?.Err??e9)(i.issues.map(e=>e1(e,a,eY())));throw eQ(e,s?.callee),e}return i.value},e3=async(e,t,r,s)=>{let a=r?Object.assign(r,{async:!0}):{async:!0},i=e._zod.run({value:t,issues:[]},a);if(i instanceof Promise&&(i=await i),i.issues.length){let e=new(s?.Err??e9)(i.issues.map(e=>e1(e,a,eY())));throw eQ(e,s?.callee),e}return i.value};function e8(e,t){try{var r=e()}catch(e){return t(e)}return r&&r.then?r.then(void 0,t):r}!function(e){e.assertEqual=e=>{},e.assertIs=function(e){},e.assertNever=function(e){throw Error()},e.arrayToEnum=e=>{let t={};for(let r of e)t[r]=r;return t},e.getValidEnumValues=t=>{let r=e.objectKeys(t).filter(e=>"number"!=typeof t[t[e]]),s={};for(let e of r)s[e]=t[e];return e.objectValues(s)},e.objectValues=t=>e.objectKeys(t).map(function(e){return t[e]}),e.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{let t=[];for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t},e.find=(e,t)=>{for(let r of e)if(t(r))return r},e.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,e.joinValues=function(e,t=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(t)},e.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t}(i||(i={})),(n||(n={})).mergeShapes=(e,t)=>({...e,...t});let e6=i.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),e7=e=>{switch(typeof e){case"undefined":return e6.undefined;case"string":return e6.string;case"number":return Number.isNaN(e)?e6.nan:e6.number;case"boolean":return e6.boolean;case"function":return e6.function;case"bigint":return e6.bigint;case"symbol":return e6.symbol;case"object":if(Array.isArray(e))return e6.array;if(null===e)return e6.null;if(e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch)return e6.promise;if("undefined"!=typeof Map&&e instanceof Map)return e6.map;if("undefined"!=typeof Set&&e instanceof Set)return e6.set;if("undefined"!=typeof Date&&e instanceof Date)return e6.date;return e6.object;default:return e6.unknown}},te=i.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class tt extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};let t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){let t=e||function(e){return e.message},r={_errors:[]},s=e=>{for(let a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(s);else if("invalid_return_type"===a.code)s(a.returnTypeError);else if("invalid_arguments"===a.code)s(a.argumentsError);else if(0===a.path.length)r._errors.push(t(a));else{let e=r,s=0;for(;s<a.path.length;){let r=a.path[s];s===a.path.length-1?(e[r]=e[r]||{_errors:[]},e[r]._errors.push(t(a))):e[r]=e[r]||{_errors:[]},e=e[r],s++}}};return s(this),r}static assert(e){if(!(e instanceof tt))throw Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,i.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){let t={},r=[];for(let s of this.issues)if(s.path.length>0){let r=s.path[0];t[r]=t[r]||[],t[r].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}tt.create=e=>new tt(e);let tr=(e,t)=>{let r;switch(e.code){case te.invalid_type:r=e.received===e6.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case te.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(e.expected,i.jsonStringifyReplacer)}`;break;case te.unrecognized_keys:r=`Unrecognized key(s) in object: ${i.joinValues(e.keys,", ")}`;break;case te.invalid_union:r="Invalid input";break;case te.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${i.joinValues(e.options)}`;break;case te.invalid_enum_value:r=`Invalid enum value. Expected ${i.joinValues(e.options)}, received '${e.received}'`;break;case te.invalid_arguments:r="Invalid function arguments";break;case te.invalid_return_type:r="Invalid function return type";break;case te.invalid_date:r="Invalid date";break;case te.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(r=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(r=`${r} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?r=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?r=`Invalid input: must end with "${e.validation.endsWith}"`:i.assertNever(e.validation):r="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case te.too_small:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case te.too_big:r="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case te.custom:r="Invalid input";break;case te.invalid_intersection_types:r="Intersection results could not be merged";break;case te.not_multiple_of:r=`Number must be a multiple of ${e.multipleOf}`;break;case te.not_finite:r="Number must be finite";break;default:r=t.defaultError,i.assertNever(e)}return{message:r}};!function(e){e.errToObj=e=>"string"==typeof e?{message:e}:e||{},e.toString=e=>"string"==typeof e?e:e?.message}(o||(o={}));let ts=e=>{let{data:t,path:r,errorMaps:s,issueData:a}=e,i=[...r,...a.path||[]],n={...a,path:i};if(void 0!==a.message)return{...a,path:i,message:a.message};let o="";for(let e of s.filter(e=>!!e).slice().reverse())o=e(n,{data:t,defaultError:o}).message;return{...a,path:i,message:o}};function ta(e,t){let r=ts({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,tr,tr==tr?void 0:tr].filter(e=>!!e)});e.common.issues.push(r)}class ti{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){let r=[];for(let s of t){if("aborted"===s.status)return tn;"dirty"===s.status&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){let r=[];for(let e of t){let t=await e.key,s=await e.value;r.push({key:t,value:s})}return ti.mergeObjectSync(e,r)}static mergeObjectSync(e,t){let r={};for(let s of t){let{key:t,value:a}=s;if("aborted"===t.status||"aborted"===a.status)return tn;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"!==t.value&&(void 0!==a.value||s.alwaysSet)&&(r[t.value]=a.value)}return{status:e.value,value:r}}}let tn=Object.freeze({status:"aborted"}),to=e=>({status:"dirty",value:e}),tl=e=>({status:"valid",value:e}),tu=e=>"aborted"===e.status,tc=e=>"dirty"===e.status,td=e=>"valid"===e.status,th=e=>"undefined"!=typeof Promise&&e instanceof Promise;class tp{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}let tf=(e,t)=>{if(td(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let t=new tt(e.common.issues);return this._error=t,this._error}}};function tm(e){if(!e)return{};let{errorMap:t,invalid_type_error:r,required_error:s,description:a}=e;if(t&&(r||s))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return t?{errorMap:t,description:a}:{errorMap:(t,a)=>{let{message:i}=e;return"invalid_enum_value"===t.code?{message:i??a.defaultError}:void 0===a.data?{message:i??s??a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:i??r??a.defaultError}},description:a}}class tg{get description(){return this._def.description}_getType(e){return e7(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:e7(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ti,ctx:{common:e.parent.common,data:e.data,parsedType:e7(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){let t=this._parse(e);if(th(t))throw Error("Synchronous parse encountered promise.");return t}_parseAsync(e){return Promise.resolve(this._parse(e))}parse(e,t){let r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){let r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e7(e)},s=this._parseSync({data:e,path:r.path,parent:r});return tf(r,s)}"~validate"(e){let t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e7(e)};if(!this["~standard"].async)try{let r=this._parseSync({data:e,path:[],parent:t});return td(r)?{value:r.value}:{issues:t.common.issues}}catch(e){e?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(e=>td(e)?{value:e.value}:{issues:t.common.issues})}async parseAsync(e,t){let r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){let r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:e7(e)},s=this._parse({data:e,path:r.path,parent:r});return tf(r,await (th(s)?s:Promise.resolve(s)))}refine(e,t){let r=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement((t,s)=>{let a=e(t),i=()=>s.addIssue({code:te.custom,...r(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then(e=>!!e||(i(),!1)):!!a||(i(),!1)})}refinement(e,t){return this._refinement((r,s)=>!!e(r)||(s.addIssue("function"==typeof t?t(r,s):t),!1))}_refinement(e){return new t7({schema:this,typeName:l.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return re.create(this,this._def)}nullable(){return rt.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return tW.create(this)}promise(){return t6.create(this,this._def)}or(e){return tG.create([this,e],this._def)}and(e){return tY.create(this,e,this._def)}transform(e){return new t7({...tm(this._def),schema:this,typeName:l.ZodEffects,effect:{type:"transform",transform:e}})}default(e){return new rr({...tm(this._def),innerType:this,defaultValue:"function"==typeof e?e:()=>e,typeName:l.ZodDefault})}brand(){return new ri({typeName:l.ZodBranded,type:this,...tm(this._def)})}catch(e){return new rs({...tm(this._def),innerType:this,catchValue:"function"==typeof e?e:()=>e,typeName:l.ZodCatch})}describe(e){return new this.constructor({...this._def,description:e})}pipe(e){return rn.create(this,e)}readonly(){return ro.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}let ty=/^c[^\s-]{8,}$/i,tv=/^[0-9a-z]+$/,t_=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tb=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tw=/^[a-z0-9_-]{21}$/i,tk=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,tx=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,tS=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,tT=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,tj=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,tE=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,tA=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,tO=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,tR=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,tC="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",tN=RegExp(`^${tC}$`);function tP(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`);let r=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${r}`}class tI extends tg{_parse(e){var t,r,a,n;let o;if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==e6.string){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.string,received:t.parsedType}),tn}let l=new ti;for(let u of this._def.checks)if("min"===u.kind)e.data.length<u.value&&(ta(o=this._getOrReturnCtx(e,o),{code:te.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("max"===u.kind)e.data.length>u.value&&(ta(o=this._getOrReturnCtx(e,o),{code:te.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!1,message:u.message}),l.dirty());else if("length"===u.kind){let t=e.data.length>u.value,r=e.data.length<u.value;(t||r)&&(o=this._getOrReturnCtx(e,o),t?ta(o,{code:te.too_big,maximum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}):r&&ta(o,{code:te.too_small,minimum:u.value,type:"string",inclusive:!0,exact:!0,message:u.message}),l.dirty())}else if("email"===u.kind)tS.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"email",code:te.invalid_string,message:u.message}),l.dirty());else if("emoji"===u.kind)s||(s=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),s.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"emoji",code:te.invalid_string,message:u.message}),l.dirty());else if("uuid"===u.kind)tb.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"uuid",code:te.invalid_string,message:u.message}),l.dirty());else if("nanoid"===u.kind)tw.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"nanoid",code:te.invalid_string,message:u.message}),l.dirty());else if("cuid"===u.kind)ty.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"cuid",code:te.invalid_string,message:u.message}),l.dirty());else if("cuid2"===u.kind)tv.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"cuid2",code:te.invalid_string,message:u.message}),l.dirty());else if("ulid"===u.kind)t_.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"ulid",code:te.invalid_string,message:u.message}),l.dirty());else if("url"===u.kind)try{new URL(e.data)}catch{ta(o=this._getOrReturnCtx(e,o),{validation:"url",code:te.invalid_string,message:u.message}),l.dirty()}else"regex"===u.kind?(u.regex.lastIndex=0,u.regex.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"regex",code:te.invalid_string,message:u.message}),l.dirty())):"trim"===u.kind?e.data=e.data.trim():"includes"===u.kind?e.data.includes(u.value,u.position)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:{includes:u.value,position:u.position},message:u.message}),l.dirty()):"toLowerCase"===u.kind?e.data=e.data.toLowerCase():"toUpperCase"===u.kind?e.data=e.data.toUpperCase():"startsWith"===u.kind?e.data.startsWith(u.value)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:{startsWith:u.value},message:u.message}),l.dirty()):"endsWith"===u.kind?e.data.endsWith(u.value)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:{endsWith:u.value},message:u.message}),l.dirty()):"datetime"===u.kind?(function(e){let t=`${tC}T${tP(e)}`,r=[];return r.push(e.local?"Z?":"Z"),e.offset&&r.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${r.join("|")})`,RegExp(`^${t}$`)})(u).test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:"datetime",message:u.message}),l.dirty()):"date"===u.kind?tN.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:"date",message:u.message}),l.dirty()):"time"===u.kind?RegExp(`^${tP(u)}$`).test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{code:te.invalid_string,validation:"time",message:u.message}),l.dirty()):"duration"===u.kind?tx.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"duration",code:te.invalid_string,message:u.message}),l.dirty()):"ip"===u.kind?(t=e.data,!(("v4"===(r=u.version)||!r)&&tT.test(t)||("v6"===r||!r)&&tE.test(t))&&1&&(ta(o=this._getOrReturnCtx(e,o),{validation:"ip",code:te.invalid_string,message:u.message}),l.dirty())):"jwt"===u.kind?!function(e,t){if(!tk.test(e))return!1;try{let[r]=e.split(".");if(!r)return!1;let s=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),a=JSON.parse(atob(s));if("object"!=typeof a||null===a||"typ"in a&&a?.typ!=="JWT"||!a.alg||t&&a.alg!==t)return!1;return!0}catch{return!1}}(e.data,u.alg)&&(ta(o=this._getOrReturnCtx(e,o),{validation:"jwt",code:te.invalid_string,message:u.message}),l.dirty()):"cidr"===u.kind?(a=e.data,!(("v4"===(n=u.version)||!n)&&tj.test(a)||("v6"===n||!n)&&tA.test(a))&&1&&(ta(o=this._getOrReturnCtx(e,o),{validation:"cidr",code:te.invalid_string,message:u.message}),l.dirty())):"base64"===u.kind?tO.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"base64",code:te.invalid_string,message:u.message}),l.dirty()):"base64url"===u.kind?tR.test(e.data)||(ta(o=this._getOrReturnCtx(e,o),{validation:"base64url",code:te.invalid_string,message:u.message}),l.dirty()):i.assertNever(u);return{status:l.value,value:e.data}}_regex(e,t,r){return this.refinement(t=>e.test(t),{validation:t,code:te.invalid_string,...o.errToObj(r)})}_addCheck(e){return new tI({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...o.errToObj(e)})}url(e){return this._addCheck({kind:"url",...o.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...o.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...o.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...o.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...o.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...o.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...o.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...o.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...o.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...o.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...o.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...o.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===e?.precision?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...o.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===e?.precision?null:e?.precision,...o.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...o.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...o.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...o.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...o.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...o.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...o.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...o.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...o.errToObj(t)})}nonempty(e){return this.min(1,o.errToObj(e))}trim(){return new tI({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new tI({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new tI({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}tI.create=e=>new tI({checks:[],typeName:l.ZodString,coerce:e?.coerce??!1,...tm(e)});class t$ extends tg{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){let t;if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==e6.number){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.number,received:t.parsedType}),tn}let r=new ti;for(let s of this._def.checks)"int"===s.kind?i.isInteger(e.data)||(ta(t=this._getOrReturnCtx(e,t),{code:te.invalid_type,expected:"integer",received:"float",message:s.message}),r.dirty()):"min"===s.kind?(s.inclusive?e.data<s.value:e.data<=s.value)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_small,minimum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):"max"===s.kind?(s.inclusive?e.data>s.value:e.data>=s.value)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_big,maximum:s.value,type:"number",inclusive:s.inclusive,exact:!1,message:s.message}),r.dirty()):"multipleOf"===s.kind?0!==function(e,t){let r=(e.toString().split(".")[1]||"").length,s=(t.toString().split(".")[1]||"").length,a=r>s?r:s;return Number.parseInt(e.toFixed(a).replace(".",""))%Number.parseInt(t.toFixed(a).replace(".",""))/10**a}(e.data,s.value)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):"finite"===s.kind?Number.isFinite(e.data)||(ta(t=this._getOrReturnCtx(e,t),{code:te.not_finite,message:s.message}),r.dirty()):i.assertNever(s);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,o.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.toString(t))}setLimit(e,t,r,s){return new t$({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.toString(s)}]})}_addCheck(e){return new t$({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:o.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:o.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:o.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:o.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:o.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:o.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:o.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:o.toString(e)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&i.isInteger(e.value))}get isFinite(){let e=null,t=null;for(let r of this._def.checks)if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;else"min"===r.kind?(null===t||r.value>t)&&(t=r.value):"max"===r.kind&&(null===e||r.value<e)&&(e=r.value);return Number.isFinite(t)&&Number.isFinite(e)}}t$.create=e=>new t$({checks:[],typeName:l.ZodNumber,coerce:e?.coerce||!1,...tm(e)});class tD extends tg{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){let t;if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==e6.bigint)return this._getInvalidInput(e);let r=new ti;for(let s of this._def.checks)"min"===s.kind?(s.inclusive?e.data<s.value:e.data<=s.value)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_small,type:"bigint",minimum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):"max"===s.kind?(s.inclusive?e.data>s.value:e.data>=s.value)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_big,type:"bigint",maximum:s.value,inclusive:s.inclusive,message:s.message}),r.dirty()):"multipleOf"===s.kind?e.data%s.value!==BigInt(0)&&(ta(t=this._getOrReturnCtx(e,t),{code:te.not_multiple_of,multipleOf:s.value,message:s.message}),r.dirty()):i.assertNever(s);return{status:r.value,value:e.data}}_getInvalidInput(e){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.bigint,received:t.parsedType}),tn}gte(e,t){return this.setLimit("min",e,!0,o.toString(t))}gt(e,t){return this.setLimit("min",e,!1,o.toString(t))}lte(e,t){return this.setLimit("max",e,!0,o.toString(t))}lt(e,t){return this.setLimit("max",e,!1,o.toString(t))}setLimit(e,t,r,s){return new tD({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:o.toString(s)}]})}_addCheck(e){return new tD({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:o.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:o.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:o.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:o.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:o.toString(t)})}get minValue(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}tD.create=e=>new tD({checks:[],typeName:l.ZodBigInt,coerce:e?.coerce??!1,...tm(e)});class tU extends tg{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==e6.boolean){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.boolean,received:t.parsedType}),tn}return tl(e.data)}}tU.create=e=>new tU({typeName:l.ZodBoolean,coerce:e?.coerce||!1,...tm(e)});class tL extends tg{_parse(e){let t;if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==e6.date){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.date,received:t.parsedType}),tn}if(Number.isNaN(e.data.getTime()))return ta(this._getOrReturnCtx(e),{code:te.invalid_date}),tn;let r=new ti;for(let s of this._def.checks)"min"===s.kind?e.data.getTime()<s.value&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_small,message:s.message,inclusive:!0,exact:!1,minimum:s.value,type:"date"}),r.dirty()):"max"===s.kind?e.data.getTime()>s.value&&(ta(t=this._getOrReturnCtx(e,t),{code:te.too_big,message:s.message,inclusive:!0,exact:!1,maximum:s.value,type:"date"}),r.dirty()):i.assertNever(s);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new tL({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:o.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:o.toString(t)})}get minDate(){let e=null;for(let t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(let t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}tL.create=e=>new tL({checks:[],coerce:e?.coerce||!1,typeName:l.ZodDate,...tm(e)});class tF extends tg{_parse(e){if(this._getType(e)!==e6.symbol){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.symbol,received:t.parsedType}),tn}return tl(e.data)}}tF.create=e=>new tF({typeName:l.ZodSymbol,...tm(e)});class tV extends tg{_parse(e){if(this._getType(e)!==e6.undefined){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.undefined,received:t.parsedType}),tn}return tl(e.data)}}tV.create=e=>new tV({typeName:l.ZodUndefined,...tm(e)});class tB extends tg{_parse(e){if(this._getType(e)!==e6.null){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.null,received:t.parsedType}),tn}return tl(e.data)}}tB.create=e=>new tB({typeName:l.ZodNull,...tm(e)});class tM extends tg{constructor(){super(...arguments),this._any=!0}_parse(e){return tl(e.data)}}tM.create=e=>new tM({typeName:l.ZodAny,...tm(e)});class tq extends tg{constructor(){super(...arguments),this._unknown=!0}_parse(e){return tl(e.data)}}tq.create=e=>new tq({typeName:l.ZodUnknown,...tm(e)});class tz extends tg{_parse(e){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.never,received:t.parsedType}),tn}}tz.create=e=>new tz({typeName:l.ZodNever,...tm(e)});class tK extends tg{_parse(e){if(this._getType(e)!==e6.undefined){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.void,received:t.parsedType}),tn}return tl(e.data)}}tK.create=e=>new tK({typeName:l.ZodVoid,...tm(e)});class tW extends tg{_parse(e){let{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==e6.array)return ta(t,{code:te.invalid_type,expected:e6.array,received:t.parsedType}),tn;if(null!==s.exactLength){let e=t.data.length>s.exactLength.value,a=t.data.length<s.exactLength.value;(e||a)&&(ta(t,{code:e?te.too_big:te.too_small,minimum:a?s.exactLength.value:void 0,maximum:e?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(null!==s.minLength&&t.data.length<s.minLength.value&&(ta(t,{code:te.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),null!==s.maxLength&&t.data.length>s.maxLength.value&&(ta(t,{code:te.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((e,r)=>s.type._parseAsync(new tp(t,e,t.path,r)))).then(e=>ti.mergeArray(r,e));let a=[...t.data].map((e,r)=>s.type._parseSync(new tp(t,e,t.path,r)));return ti.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new tW({...this._def,minLength:{value:e,message:o.toString(t)}})}max(e,t){return new tW({...this._def,maxLength:{value:e,message:o.toString(t)}})}length(e,t){return new tW({...this._def,exactLength:{value:e,message:o.toString(t)}})}nonempty(e){return this.min(1,e)}}tW.create=(e,t)=>new tW({type:e,minLength:null,maxLength:null,exactLength:null,typeName:l.ZodArray,...tm(t)});class tZ extends tg{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let e=this._def.shape(),t=i.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==e6.object){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.object,received:t.parsedType}),tn}let{status:t,ctx:r}=this._processInputParams(e),{shape:s,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof tz&&"strip"===this._def.unknownKeys))for(let e in r.data)a.includes(e)||i.push(e);let n=[];for(let e of a){let t=s[e],a=r.data[e];n.push({key:{status:"valid",value:e},value:t._parse(new tp(r,a,r.path,e)),alwaysSet:e in r.data})}if(this._def.catchall instanceof tz){let e=this._def.unknownKeys;if("passthrough"===e)for(let e of i)n.push({key:{status:"valid",value:e},value:{status:"valid",value:r.data[e]}});else if("strict"===e)i.length>0&&(ta(r,{code:te.unrecognized_keys,keys:i}),t.dirty());else if("strip"===e);else throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let e=this._def.catchall;for(let t of i){let s=r.data[t];n.push({key:{status:"valid",value:t},value:e._parse(new tp(r,s,r.path,t)),alwaysSet:t in r.data})}}return r.common.async?Promise.resolve().then(async()=>{let e=[];for(let t of n){let r=await t.key,s=await t.value;e.push({key:r,value:s,alwaysSet:t.alwaysSet})}return e}).then(e=>ti.mergeObjectSync(t,e)):ti.mergeObjectSync(t,n)}get shape(){return this._def.shape()}strict(e){return o.errToObj,new tZ({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,r)=>{let s=this._def.errorMap?.(t,r).message??r.defaultError;return"unrecognized_keys"===t.code?{message:o.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new tZ({...this._def,unknownKeys:"strip"})}passthrough(){return new tZ({...this._def,unknownKeys:"passthrough"})}extend(e){return new tZ({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new tZ({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:l.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new tZ({...this._def,catchall:e})}pick(e){let t={};for(let r of i.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new tZ({...this._def,shape:()=>t})}omit(e){let t={};for(let r of i.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new tZ({...this._def,shape:()=>t})}deepPartial(){return function e(t){if(t instanceof tZ){let r={};for(let s in t.shape){let a=t.shape[s];r[s]=re.create(e(a))}return new tZ({...t._def,shape:()=>r})}if(t instanceof tW)return new tW({...t._def,type:e(t.element)});if(t instanceof re)return re.create(e(t.unwrap()));if(t instanceof rt)return rt.create(e(t.unwrap()));if(t instanceof tX)return tX.create(t.items.map(t=>e(t)));else return t}(this)}partial(e){let t={};for(let r of i.objectKeys(this.shape)){let s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new tZ({...this._def,shape:()=>t})}required(e){let t={};for(let r of i.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let e=this.shape[r];for(;e instanceof re;)e=e._def.innerType;t[r]=e}return new tZ({...this._def,shape:()=>t})}keyof(){return t5(i.objectKeys(this.shape))}}tZ.create=(e,t)=>new tZ({shape:()=>e,unknownKeys:"strip",catchall:tz.create(),typeName:l.ZodObject,...tm(t)}),tZ.strictCreate=(e,t)=>new tZ({shape:()=>e,unknownKeys:"strict",catchall:tz.create(),typeName:l.ZodObject,...tm(t)}),tZ.lazycreate=(e,t)=>new tZ({shape:e,unknownKeys:"strip",catchall:tz.create(),typeName:l.ZodObject,...tm(t)});class tG extends tg{_parse(e){let{ctx:t}=this._processInputParams(e),r=this._def.options;if(t.common.async)return Promise.all(r.map(async e=>{let r={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:r}),ctx:r}})).then(function(e){for(let t of e)if("valid"===t.result.status)return t.result;for(let r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;let r=e.map(e=>new tt(e.ctx.common.issues));return ta(t,{code:te.invalid_union,unionErrors:r}),tn});{let e,s=[];for(let a of r){let r={...t,common:{...t.common,issues:[]},parent:null},i=a._parseSync({data:t.data,path:t.path,parent:r});if("valid"===i.status)return i;"dirty"!==i.status||e||(e={result:i,ctx:r}),r.common.issues.length&&s.push(r.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;let a=s.map(e=>new tt(e));return ta(t,{code:te.invalid_union,unionErrors:a}),tn}}get options(){return this._def.options}}tG.create=(e,t)=>new tG({options:e,typeName:l.ZodUnion,...tm(t)});let tH=e=>{if(e instanceof t4)return tH(e.schema);if(e instanceof t7)return tH(e.innerType());if(e instanceof t9)return[e.value];if(e instanceof t3)return e.options;if(e instanceof t8)return i.objectValues(e.enum);else if(e instanceof rr)return tH(e._def.innerType);else if(e instanceof tV)return[void 0];else if(e instanceof tB)return[null];else if(e instanceof re)return[void 0,...tH(e.unwrap())];else if(e instanceof rt)return[null,...tH(e.unwrap())];else if(e instanceof ri)return tH(e.unwrap());else if(e instanceof ro)return tH(e.unwrap());else if(e instanceof rs)return tH(e._def.innerType);else return[]};class tJ extends tg{_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==e6.object)return ta(t,{code:te.invalid_type,expected:e6.object,received:t.parsedType}),tn;let r=this.discriminator,s=t.data[r],a=this.optionsMap.get(s);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(ta(t,{code:te.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),tn)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,r){let s=new Map;for(let r of t){let t=tH(r.shape[e]);if(!t.length)throw Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(let a of t){if(s.has(a))throw Error(`Discriminator property ${String(e)} has duplicate value ${String(a)}`);s.set(a,r)}}return new tJ({typeName:l.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:s,...tm(r)})}}class tY extends tg{_parse(e){let{status:t,ctx:r}=this._processInputParams(e),s=(e,s)=>{if(tu(e)||tu(s))return tn;let a=function e(t,r){let s=e7(t),a=e7(r);if(t===r)return{valid:!0,data:t};if(s===e6.object&&a===e6.object){let s=i.objectKeys(r),a=i.objectKeys(t).filter(e=>-1!==s.indexOf(e)),n={...t,...r};for(let s of a){let a=e(t[s],r[s]);if(!a.valid)return{valid:!1};n[s]=a.data}return{valid:!0,data:n}}if(s===e6.array&&a===e6.array){if(t.length!==r.length)return{valid:!1};let s=[];for(let a=0;a<t.length;a++){let i=e(t[a],r[a]);if(!i.valid)return{valid:!1};s.push(i.data)}return{valid:!0,data:s}}if(s===e6.date&&a===e6.date&&+t==+r)return{valid:!0,data:t};return{valid:!1}}(e.value,s.value);return a.valid?((tc(e)||tc(s))&&t.dirty(),{status:t.value,value:a.data}):(ta(r,{code:te.invalid_intersection_types}),tn)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([e,t])=>s(e,t)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}tY.create=(e,t,r)=>new tY({left:e,right:t,typeName:l.ZodIntersection,...tm(r)});class tX extends tg{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==e6.array)return ta(r,{code:te.invalid_type,expected:e6.array,received:r.parsedType}),tn;if(r.data.length<this._def.items.length)return ta(r,{code:te.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),tn;!this._def.rest&&r.data.length>this._def.items.length&&(ta(r,{code:te.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());let s=[...r.data].map((e,t)=>{let s=this._def.items[t]||this._def.rest;return s?s._parse(new tp(r,e,r.path,t)):null}).filter(e=>!!e);return r.common.async?Promise.all(s).then(e=>ti.mergeArray(t,e)):ti.mergeArray(t,s)}get items(){return this._def.items}rest(e){return new tX({...this._def,rest:e})}}tX.create=(e,t)=>{if(!Array.isArray(e))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new tX({items:e,typeName:l.ZodTuple,rest:null,...tm(t)})};class tQ extends tg{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==e6.object)return ta(r,{code:te.invalid_type,expected:e6.object,received:r.parsedType}),tn;let s=[],a=this._def.keyType,i=this._def.valueType;for(let e in r.data)s.push({key:a._parse(new tp(r,e,r.path,e)),value:i._parse(new tp(r,r.data[e],r.path,e)),alwaysSet:e in r.data});return r.common.async?ti.mergeObjectAsync(t,s):ti.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return new tQ(t instanceof tg?{keyType:e,valueType:t,typeName:l.ZodRecord,...tm(r)}:{keyType:tI.create(),valueType:e,typeName:l.ZodRecord,...tm(t)})}}class t0 extends tg{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==e6.map)return ta(r,{code:te.invalid_type,expected:e6.map,received:r.parsedType}),tn;let s=this._def.keyType,a=this._def.valueType,i=[...r.data.entries()].map(([e,t],i)=>({key:s._parse(new tp(r,e,r.path,[i,"key"])),value:a._parse(new tp(r,t,r.path,[i,"value"]))}));if(r.common.async){let e=new Map;return Promise.resolve().then(async()=>{for(let r of i){let s=await r.key,a=await r.value;if("aborted"===s.status||"aborted"===a.status)return tn;("dirty"===s.status||"dirty"===a.status)&&t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}})}{let e=new Map;for(let r of i){let s=r.key,a=r.value;if("aborted"===s.status||"aborted"===a.status)return tn;("dirty"===s.status||"dirty"===a.status)&&t.dirty(),e.set(s.value,a.value)}return{status:t.value,value:e}}}}t0.create=(e,t,r)=>new t0({valueType:t,keyType:e,typeName:l.ZodMap,...tm(r)});class t1 extends tg{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==e6.set)return ta(r,{code:te.invalid_type,expected:e6.set,received:r.parsedType}),tn;let s=this._def;null!==s.minSize&&r.data.size<s.minSize.value&&(ta(r,{code:te.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),null!==s.maxSize&&r.data.size>s.maxSize.value&&(ta(r,{code:te.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());let a=this._def.valueType;function i(e){let r=new Set;for(let s of e){if("aborted"===s.status)return tn;"dirty"===s.status&&t.dirty(),r.add(s.value)}return{status:t.value,value:r}}let n=[...r.data.values()].map((e,t)=>a._parse(new tp(r,e,r.path,t)));return r.common.async?Promise.all(n).then(e=>i(e)):i(n)}min(e,t){return new t1({...this._def,minSize:{value:e,message:o.toString(t)}})}max(e,t){return new t1({...this._def,maxSize:{value:e,message:o.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}t1.create=(e,t)=>new t1({valueType:e,minSize:null,maxSize:null,typeName:l.ZodSet,...tm(t)});class t2 extends tg{constructor(){super(...arguments),this.validate=this.implement}_parse(e){let{ctx:t}=this._processInputParams(e);if(t.parsedType!==e6.function)return ta(t,{code:te.invalid_type,expected:e6.function,received:t.parsedType}),tn;function r(e,r){return ts({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tr,tr].filter(e=>!!e),issueData:{code:te.invalid_arguments,argumentsError:r}})}function s(e,r){return ts({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,tr,tr].filter(e=>!!e),issueData:{code:te.invalid_return_type,returnTypeError:r}})}let a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof t6){let e=this;return tl(async function(...t){let n=new tt([]),o=await e._def.args.parseAsync(t,a).catch(e=>{throw n.addIssue(r(t,e)),n}),l=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(l,a).catch(e=>{throw n.addIssue(s(l,e)),n})})}{let e=this;return tl(function(...t){let n=e._def.args.safeParse(t,a);if(!n.success)throw new tt([r(t,n.error)]);let o=Reflect.apply(i,this,n.data),l=e._def.returns.safeParse(o,a);if(!l.success)throw new tt([s(o,l.error)]);return l.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new t2({...this._def,args:tX.create(e).rest(tq.create())})}returns(e){return new t2({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,r){return new t2({args:e||tX.create([]).rest(tq.create()),returns:t||tq.create(),typeName:l.ZodFunction,...tm(r)})}}class t4 extends tg{get schema(){return this._def.getter()}_parse(e){let{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}t4.create=(e,t)=>new t4({getter:e,typeName:l.ZodLazy,...tm(t)});class t9 extends tg{_parse(e){if(e.data!==this._def.value){let t=this._getOrReturnCtx(e);return ta(t,{received:t.data,code:te.invalid_literal,expected:this._def.value}),tn}return{status:"valid",value:e.data}}get value(){return this._def.value}}function t5(e,t){return new t3({values:e,typeName:l.ZodEnum,...tm(t)})}t9.create=(e,t)=>new t9({value:e,typeName:l.ZodLiteral,...tm(t)});class t3 extends tg{_parse(e){if("string"!=typeof e.data){let t=this._getOrReturnCtx(e),r=this._def.values;return ta(t,{expected:i.joinValues(r),received:t.parsedType,code:te.invalid_type}),tn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){let t=this._getOrReturnCtx(e),r=this._def.values;return ta(t,{received:t.data,code:te.invalid_enum_value,options:r}),tn}return tl(e.data)}get options(){return this._def.values}get enum(){let e={};for(let t of this._def.values)e[t]=t;return e}get Values(){let e={};for(let t of this._def.values)e[t]=t;return e}get Enum(){let e={};for(let t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return t3.create(e,{...this._def,...t})}exclude(e,t=this._def){return t3.create(this.options.filter(t=>!e.includes(t)),{...this._def,...t})}}t3.create=t5;class t8 extends tg{_parse(e){let t=i.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==e6.string&&r.parsedType!==e6.number){let e=i.objectValues(t);return ta(r,{expected:i.joinValues(e),received:r.parsedType,code:te.invalid_type}),tn}if(this._cache||(this._cache=new Set(i.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){let e=i.objectValues(t);return ta(r,{received:r.data,code:te.invalid_enum_value,options:e}),tn}return tl(e.data)}get enum(){return this._def.values}}t8.create=(e,t)=>new t8({values:e,typeName:l.ZodNativeEnum,...tm(t)});class t6 extends tg{unwrap(){return this._def.type}_parse(e){let{ctx:t}=this._processInputParams(e);return t.parsedType!==e6.promise&&!1===t.common.async?(ta(t,{code:te.invalid_type,expected:e6.promise,received:t.parsedType}),tn):tl((t.parsedType===e6.promise?t.data:Promise.resolve(t.data)).then(e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap})))}}t6.create=(e,t)=>new t6({type:e,typeName:l.ZodPromise,...tm(t)});class t7 extends tg{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===l.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){let{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:e=>{ta(r,e),e.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===s.type){let e=s.transform(r.data,a);if(r.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===t.value)return tn;let s=await this._def.schema._parseAsync({data:e,path:r.path,parent:r});return"aborted"===s.status?tn:"dirty"===s.status||"dirty"===t.value?to(s.value):s});{if("aborted"===t.value)return tn;let s=this._def.schema._parseSync({data:e,path:r.path,parent:r});return"aborted"===s.status?tn:"dirty"===s.status||"dirty"===t.value?to(s.value):s}}if("refinement"===s.type){let e=e=>{let t=s.refinement(e,a);if(r.common.async)return Promise.resolve(t);if(t instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?tn:("dirty"===r.status&&t.dirty(),e(r.value).then(()=>({status:t.value,value:r.value}))));{let s=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===s.status?tn:("dirty"===s.status&&t.dirty(),e(s.value),{status:t.value,value:s.value})}}if("transform"===s.type)if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(e=>td(e)?Promise.resolve(s.transform(e.value,a)).then(e=>({status:t.value,value:e})):tn);else{let e=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!td(e))return tn;let i=s.transform(e.value,a);if(i instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}i.assertNever(s)}}t7.create=(e,t,r)=>new t7({schema:e,typeName:l.ZodEffects,effect:t,...tm(r)}),t7.createWithPreprocess=(e,t,r)=>new t7({schema:t,effect:{type:"preprocess",transform:e},typeName:l.ZodEffects,...tm(r)});class re extends tg{_parse(e){return this._getType(e)===e6.undefined?tl(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}re.create=(e,t)=>new re({innerType:e,typeName:l.ZodOptional,...tm(t)});class rt extends tg{_parse(e){return this._getType(e)===e6.null?tl(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}rt.create=(e,t)=>new rt({innerType:e,typeName:l.ZodNullable,...tm(t)});class rr extends tg{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return t.parsedType===e6.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}rr.create=(e,t)=>new rr({innerType:e,typeName:l.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...tm(t)});class rs extends tg{_parse(e){let{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return th(s)?s.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new tt(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===s.status?s.value:this._def.catchValue({get error(){return new tt(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}rs.create=(e,t)=>new rs({innerType:e,typeName:l.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...tm(t)});class ra extends tg{_parse(e){if(this._getType(e)!==e6.nan){let t=this._getOrReturnCtx(e);return ta(t,{code:te.invalid_type,expected:e6.nan,received:t.parsedType}),tn}return{status:"valid",value:e.data}}}ra.create=e=>new ra({typeName:l.ZodNaN,...tm(e)}),Symbol("zod_brand");class ri extends tg{_parse(e){let{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class rn extends tg{_parse(e){let{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{let e=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?tn:"dirty"===e.status?(t.dirty(),to(e.value)):this._def.out._parseAsync({data:e.value,path:r.path,parent:r})})();{let e=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===e.status?tn:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:r.path,parent:r})}}static create(e,t){return new rn({in:e,out:t,typeName:l.ZodPipeline})}}class ro extends tg{_parse(e){let t=this._def.innerType._parse(e),r=e=>(td(e)&&(e.value=Object.freeze(e.value)),e);return th(t)?t.then(e=>r(e)):r(t)}unwrap(){return this._def.innerType}}ro.create=(e,t)=>new ro({innerType:e,typeName:l.ZodReadonly,...tm(t)}),tZ.lazycreate,function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"}(l||(l={}));let rl=tI.create;t$.create,ra.create,tD.create,tU.create,tL.create,tF.create,tV.create,tB.create,tM.create,tq.create,tz.create,tK.create,tW.create;let ru=tZ.create;tZ.strictCreate,tG.create,tJ.create,tY.create,tX.create,tQ.create,t0.create,t1.create,t2.create,t4.create,t9.create;let rc=t3.create;t8.create,t6.create,t7.create,re.create,rt.create,t7.createWithPreprocess,rn.create;var rd=r(9523),rh=r(9667),rp=r(8730),rf=r(4780);r(1215);var rm=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"].reduce((e,t)=>{let r=(0,rp.TL)(`Primitive.${t}`),s=w.forwardRef((e,s)=>{let{asChild:a,...i}=e;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,b.jsx)(a?r:t,{...i,ref:s})});return s.displayName=`Primitive.${t}`,{...e,[t]:s}},{}),rg=w.forwardRef((e,t)=>(0,b.jsx)(rm.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));rg.displayName="Label";let ry=(0,r(4224).F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),rv=w.forwardRef(({className:e,...t},r)=>(0,b.jsx)(rg,{ref:r,className:(0,rf.cn)(ry(),e),...t}));rv.displayName=rg.displayName;let r_=e=>{let{children:t,watch:r,getValues:s,getFieldState:a,setError:i,clearErrors:n,setValue:o,trigger:l,formState:u,resetField:c,reset:d,handleSubmit:h,unregister:p,control:f,register:m,setFocus:g,subscribe:y}=e;return w.createElement(ee.Provider,{value:w.useMemo(()=>({watch:r,getValues:s,getFieldState:a,setError:i,clearErrors:n,setValue:o,trigger:l,formState:u,resetField:c,reset:d,handleSubmit:h,unregister:p,control:f,register:m,setFocus:g,subscribe:y}),[n,f,u,a,s,h,m,d,c,i,g,o,y,l,p,r])},w.createElement(K.Provider,{value:f},t))},rb=w.createContext({}),rw=({...e})=>(0,b.jsx)(rb.Provider,{value:{name:e.name},children:(0,b.jsx)(Q,{...e})}),rk=()=>{let e=w.useContext(rb),t=w.useContext(rx),{getFieldState:r,formState:s}=et(),a=r(e.name,s);if(!e)throw Error("useFormField should be used within <FormField>");let{id:i}=t;return{id:i,name:e.name,formItemId:`${i}-form-item`,formDescriptionId:`${i}-form-item-description`,formMessageId:`${i}-form-item-message`,...a}},rx=w.createContext({}),rS=w.forwardRef(({className:e,...t},r)=>{let s=w.useId();return(0,b.jsx)(rx.Provider,{value:{id:s},children:(0,b.jsx)("div",{ref:r,className:(0,rf.cn)("space-y-2",e),...t})})});rS.displayName="FormItem";let rT=w.forwardRef(({className:e,...t},r)=>{let{error:s,formItemId:a}=rk();return(0,b.jsx)(rv,{ref:r,className:(0,rf.cn)(s&&"text-destructive",e),htmlFor:a,...t})});rT.displayName="FormLabel";let rj=w.forwardRef(({...e},t)=>{let{error:r,formItemId:s,formDescriptionId:a,formMessageId:i}=rk();return(0,b.jsx)(rp.DX,{ref:t,id:s,"aria-describedby":r?`${a} ${i}`:`${a}`,"aria-invalid":!!r,...e})});rj.displayName="FormControl",w.forwardRef(({className:e,...t},r)=>{let{formDescriptionId:s}=rk();return(0,b.jsx)("p",{ref:r,id:s,className:(0,rf.cn)("text-[0.8rem] text-muted-foreground",e),...t})}).displayName="FormDescription";let rE=w.forwardRef(({className:e,children:t,...r},s)=>{let{error:a,formMessageId:i}=rk(),n=a?String(a?.message??""):t;return n?(0,b.jsx)("p",{ref:s,id:i,className:(0,rf.cn)("text-[0.8rem] font-medium text-destructive",e),...r,children:n}):null});rE.displayName="FormMessage";var rA=r(569),rO=r(8599),rR=r(1273),rC=r(3416),rN=r(2031),rP=r(6963),rI=r(3495),r$=r(5551),rD=r(43),rU="rovingFocusGroup.onEntryFocus",rL={bubbles:!1,cancelable:!0},rF="RovingFocusGroup",[rV,rB,rM]=(0,rN.N)(rF),[rq,rz]=(0,rR.A)(rF,[rM]),[rK,rW]=rq(rF),rZ=w.forwardRef((e,t)=>(0,b.jsx)(rV.Provider,{scope:e.__scopeRovingFocusGroup,children:(0,b.jsx)(rV.Slot,{scope:e.__scopeRovingFocusGroup,children:(0,b.jsx)(rG,{...e,ref:t})})}));rZ.displayName=rF;var rG=w.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,orientation:s,loop:a=!1,dir:i,currentTabStopId:n,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:u,preventScrollOnEntryFocus:c=!1,...d}=e,h=w.useRef(null),p=(0,rO.s)(t,h),f=(0,rD.jH)(i),[m,g]=(0,r$.i)({prop:n,defaultProp:o??null,onChange:l,caller:rF}),[y,v]=w.useState(!1),_=(0,rI.c)(u),k=rB(r),x=w.useRef(!1),[S,T]=w.useState(0);return w.useEffect(()=>{let e=h.current;if(e)return e.addEventListener(rU,_),()=>e.removeEventListener(rU,_)},[_]),(0,b.jsx)(rK,{scope:r,orientation:s,dir:f,loop:a,currentTabStopId:m,onItemFocus:w.useCallback(e=>g(e),[g]),onItemShiftTab:w.useCallback(()=>v(!0),[]),onFocusableItemAdd:w.useCallback(()=>T(e=>e+1),[]),onFocusableItemRemove:w.useCallback(()=>T(e=>e-1),[]),children:(0,b.jsx)(rC.sG.div,{tabIndex:y||0===S?-1:0,"data-orientation":s,...d,ref:p,style:{outline:"none",...e.style},onMouseDown:(0,rA.mK)(e.onMouseDown,()=>{x.current=!0}),onFocus:(0,rA.mK)(e.onFocus,e=>{let t=!x.current;if(e.target===e.currentTarget&&t&&!y){let t=new CustomEvent(rU,rL);if(e.currentTarget.dispatchEvent(t),!t.defaultPrevented){let e=k().filter(e=>e.focusable);rX([e.find(e=>e.active),e.find(e=>e.id===m),...e].filter(Boolean).map(e=>e.ref.current),c)}}x.current=!1}),onBlur:(0,rA.mK)(e.onBlur,()=>v(!1))})})}),rH="RovingFocusGroupItem",rJ=w.forwardRef((e,t)=>{let{__scopeRovingFocusGroup:r,focusable:s=!0,active:a=!1,tabStopId:i,children:n,...o}=e,l=(0,rP.B)(),u=i||l,c=rW(rH,r),d=c.currentTabStopId===u,h=rB(r),{onFocusableItemAdd:p,onFocusableItemRemove:f,currentTabStopId:m}=c;return w.useEffect(()=>{if(s)return p(),()=>f()},[s,p,f]),(0,b.jsx)(rV.ItemSlot,{scope:r,id:u,focusable:s,active:a,children:(0,b.jsx)(rC.sG.span,{tabIndex:d?0:-1,"data-orientation":c.orientation,...o,ref:t,onMouseDown:(0,rA.mK)(e.onMouseDown,e=>{s?c.onItemFocus(u):e.preventDefault()}),onFocus:(0,rA.mK)(e.onFocus,()=>c.onItemFocus(u)),onKeyDown:(0,rA.mK)(e.onKeyDown,e=>{if("Tab"===e.key&&e.shiftKey)return void c.onItemShiftTab();if(e.target!==e.currentTarget)return;let t=function(e,t,r){var s;let a=(s=e.key,"rtl"!==r?s:"ArrowLeft"===s?"ArrowRight":"ArrowRight"===s?"ArrowLeft":s);if(!("vertical"===t&&["ArrowLeft","ArrowRight"].includes(a))&&!("horizontal"===t&&["ArrowUp","ArrowDown"].includes(a)))return rY[a]}(e,c.orientation,c.dir);if(void 0!==t){if(e.metaKey||e.ctrlKey||e.altKey||e.shiftKey)return;e.preventDefault();let r=h().filter(e=>e.focusable).map(e=>e.ref.current);if("last"===t)r.reverse();else if("prev"===t||"next"===t){"prev"===t&&r.reverse();let s=r.indexOf(e.currentTarget);r=c.loop?function(e,t){return e.map((r,s)=>e[(t+s)%e.length])}(r,s+1):r.slice(s+1)}setTimeout(()=>rX(r))}}),children:"function"==typeof n?n({isCurrentTabStop:d,hasTabStop:null!=m}):n})})});rJ.displayName=rH;var rY={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function rX(e,t=!1){let r=document.activeElement;for(let s of e)if(s===r||(s.focus({preventScroll:t}),document.activeElement!==r))return}var rQ=r(6156),r0=r(6059),r1="Radio",[r2,r4]=(0,rR.A)(r1),[r9,r5]=r2(r1),r3=w.forwardRef((e,t)=>{let{__scopeRadio:r,name:s,checked:a=!1,required:i,disabled:n,value:o="on",onCheck:l,form:u,...c}=e,[d,h]=w.useState(null),p=(0,rO.s)(t,e=>h(e)),f=w.useRef(!1),m=!d||u||!!d.closest("form");return(0,b.jsxs)(r9,{scope:r,checked:a,disabled:n,children:[(0,b.jsx)(rC.sG.button,{type:"button",role:"radio","aria-checked":a,"data-state":se(a),"data-disabled":n?"":void 0,disabled:n,value:o,...c,ref:p,onClick:(0,rA.mK)(e.onClick,e=>{a||l?.(),m&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})}),m&&(0,b.jsx)(r7,{control:d,bubbles:!f.current,name:s,value:o,checked:a,required:i,disabled:n,form:u,style:{transform:"translateX(-100%)"}})]})});r3.displayName=r1;var r8="RadioIndicator",r6=w.forwardRef((e,t)=>{let{__scopeRadio:r,forceMount:s,...a}=e,i=r5(r8,r);return(0,b.jsx)(r0.C,{present:s||i.checked,children:(0,b.jsx)(rC.sG.span,{"data-state":se(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:t})})});r6.displayName=r8;var r7=w.forwardRef(({__scopeRadio:e,control:t,checked:r,bubbles:s=!0,...a},i)=>{let n=w.useRef(null),o=(0,rO.s)(n,i),l=function(e){let t=w.useRef({value:e,previous:e});return w.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}(r),u=function(e){let[t,r]=w.useState(void 0);return(0,rQ.N)(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});let t=new ResizeObserver(t=>{let s,a;if(!Array.isArray(t)||!t.length)return;let i=t[0];if("borderBoxSize"in i){let e=i.borderBoxSize,t=Array.isArray(e)?e[0]:e;s=t.inlineSize,a=t.blockSize}else s=e.offsetWidth,a=e.offsetHeight;r({width:s,height:a})});return t.observe(e,{box:"border-box"}),()=>t.unobserve(e)}r(void 0)},[e]),t}(t);return w.useEffect(()=>{let e=n.current;if(!e)return;let t=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"checked").set;if(l!==r&&t){let a=new Event("click",{bubbles:s});t.call(e,r),e.dispatchEvent(a)}},[l,r,s]),(0,b.jsx)(rC.sG.input,{type:"radio","aria-hidden":!0,defaultChecked:r,...a,tabIndex:-1,ref:o,style:{...a.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});function se(e){return e?"checked":"unchecked"}r7.displayName="RadioBubbleInput";var st=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],sr="RadioGroup",[ss,sa]=(0,rR.A)(sr,[rz,r4]),si=rz(),sn=r4(),[so,sl]=ss(sr),su=w.forwardRef((e,t)=>{let{__scopeRadioGroup:r,name:s,defaultValue:a,value:i,required:n=!1,disabled:o=!1,orientation:l,dir:u,loop:c=!0,onValueChange:d,...h}=e,p=si(r),f=(0,rD.jH)(u),[m,g]=(0,r$.i)({prop:i,defaultProp:a??null,onChange:d,caller:sr});return(0,b.jsx)(so,{scope:r,name:s,required:n,disabled:o,value:m,onValueChange:g,children:(0,b.jsx)(rZ,{asChild:!0,...p,orientation:l,dir:f,loop:c,children:(0,b.jsx)(rC.sG.div,{role:"radiogroup","aria-required":n,"aria-orientation":l,"data-disabled":o?"":void 0,dir:f,...h,ref:t})})})});su.displayName=sr;var sc="RadioGroupItem",sd=w.forwardRef((e,t)=>{let{__scopeRadioGroup:r,disabled:s,...a}=e,i=sl(sc,r),n=i.disabled||s,o=si(r),l=sn(r),u=w.useRef(null),c=(0,rO.s)(t,u),d=i.value===a.value,h=w.useRef(!1);return w.useEffect(()=>{let e=e=>{st.includes(e.key)&&(h.current=!0)},t=()=>h.current=!1;return document.addEventListener("keydown",e),document.addEventListener("keyup",t),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",t)}},[]),(0,b.jsx)(rJ,{asChild:!0,...o,focusable:!n,active:d,children:(0,b.jsx)(r3,{disabled:n,required:i.required,checked:d,...l,...a,name:i.name,ref:c,onCheck:()=>i.onValueChange(a.value),onKeyDown:(0,rA.mK)(e=>{"Enter"===e.key&&e.preventDefault()}),onFocus:(0,rA.mK)(a.onFocus,()=>{h.current&&u.current?.click()})})})});sd.displayName=sc;var sh=w.forwardRef((e,t)=>{let{__scopeRadioGroup:r,...s}=e,a=sn(r);return(0,b.jsx)(r6,{...a,...s,ref:t})});sh.displayName="RadioGroupIndicator";var sp=r(1991);let sf=(0,sp.A)("circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),sm=w.forwardRef(({className:e,...t},r)=>(0,b.jsx)(su,{className:(0,rf.cn)("grid gap-2",e),...t,ref:r}));sm.displayName=su.displayName;let sg=w.forwardRef(({className:e,...t},r)=>(0,b.jsx)(sd,{ref:r,className:(0,rf.cn)("aspect-square h-4 w-4 rounded-full border border-primary text-primary shadow focus:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:(0,b.jsx)(sh,{className:"flex items-center justify-center",children:(0,b.jsx)(sf,{className:"h-3.5 w-3.5 fill-primary"})})}));sg.displayName=sd.displayName;var sy=r(5950);let sv=(0,sp.A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),s_=(0,sp.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),sb=(0,sp.A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);var sw=r(8059);let sk=(0,sp.A)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]),sx=(0,sp.A)("credit-card",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);var sS=r(8038),sT=r(1087),sj=r(2581),sE=r(4363);let sA=e=>e?(...t)=>e(...t):(...e)=>fetch(...e);class sO extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class sR extends sO{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class sC extends sO{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class sN extends sO{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}!function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"}(u||(u={}));class sP{constructor(e,{headers:t={},customFetch:r,region:s=u.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=sA(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return(0,sE.sH)(this,arguments,void 0,function*(e,t={}){var r;let s,a;try{let i,n,{headers:o,method:l,body:u,signal:c,timeout:d}=t,h={},{region:p}=t;p||(p=this.region);let f=new URL(`${this.url}/${e}`);p&&"any"!==p&&(h["x-region"]=p,f.searchParams.set("forceFunctionRegion",p)),u&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)?"undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer?(h["Content-Type"]="application/octet-stream",i=u):"string"==typeof u?(h["Content-Type"]="text/plain",i=u):"undefined"!=typeof FormData&&u instanceof FormData?i=u:(h["Content-Type"]="application/json",i=JSON.stringify(u)):i=!u||"string"==typeof u||"undefined"!=typeof Blob&&u instanceof Blob||u instanceof ArrayBuffer||"undefined"!=typeof FormData&&u instanceof FormData?u:JSON.stringify(u);let m=c;d&&(a=new AbortController,s=setTimeout(()=>a.abort(),d),c?(m=a.signal,c.addEventListener("abort",()=>a.abort())):m=a.signal);let g=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},h),this.headers),o),body:i,signal:m}).catch(e=>{throw new sR(e)}),y=g.headers.get("x-relay-error");if(y&&"true"===y)throw new sC(g);if(!g.ok)throw new sN(g);let v=(null!=(r=g.headers.get("Content-Type"))?r:"text/plain").split(";")[0].trim();return{data:"application/json"===v?yield g.json():"application/octet-stream"===v||"application/pdf"===v?yield g.blob():"text/event-stream"===v?g:"multipart/form-data"===v?yield g.formData():yield g.text(),error:null,response:g}}catch(e){return{data:null,error:e,response:e instanceof sN||e instanceof sC?e.context:void 0}}finally{s&&clearTimeout(s)}})}}var sI=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}},s$=class{constructor(e){var t,r;this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=new Headers(e.headers),this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=null!=(t=e.shouldThrowOnError)&&t,this.signal=e.signal,this.isMaybeSingle=null!=(r=e.isMaybeSingle)&&r,e.fetch?this.fetch=e.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=new Headers(this.headers),this.headers.set(e,t),this}then(e,t){var r=this;void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),"GET"!==this.method&&"HEAD"!==this.method&&this.headers.set("Content-Type","application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async e=>{var t,s,a,i;let n=null,o=null,l=null,u=e.status,c=e.statusText;if(e.ok){if("HEAD"!==r.method){let t=await e.text();""===t||(o="text/csv"===r.headers.get("Accept")||r.headers.get("Accept")&&(null==(a=r.headers.get("Accept"))?void 0:a.includes("application/vnd.pgrst.plan+text"))?t:JSON.parse(t))}let i=null==(t=r.headers.get("Prefer"))?void 0:t.match(/count=(exact|planned|estimated)/),d=null==(s=e.headers.get("content-range"))?void 0:s.split("/");i&&d&&d.length>1&&(l=parseInt(d[1])),r.isMaybeSingle&&"GET"===r.method&&Array.isArray(o)&&(o.length>1?(n={code:"PGRST116",details:`Results contain ${o.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},o=null,l=null,u=406,c="Not Acceptable"):o=1===o.length?o[0]:null)}else{let t=await e.text();try{n=JSON.parse(t),Array.isArray(n)&&404===e.status&&(o=[],n=null,u=200,c="OK")}catch(r){404===e.status&&""===t?(u=204,c="No Content"):n={message:t}}if(n&&r.isMaybeSingle&&(null==n||null==(i=n.details)?void 0:i.includes("0 rows"))&&(n=null,u=200,c="OK"),n&&r.shouldThrowOnError)throw new sI(n)}return{error:n,data:o,count:l,status:u,statusText:c}});return this.shouldThrowOnError||(s=s.catch(e=>{var t,r,s,a,i,n;let o="",l=null==e?void 0:e.cause;if(l){let t=null!=(r=null==l?void 0:l.message)?r:"",n=null!=(s=null==l?void 0:l.code)?s:"";o=`${null!=(a=null==e?void 0:e.name)?a:"FetchError"}: ${null==e?void 0:e.message}

Caused by: ${null!=(i=null==l?void 0:l.name)?i:"Error"}: ${t}`,n&&(o+=` (${n})`),(null==l?void 0:l.stack)&&(o+=`
${l.stack}`)}else o=null!=(n=null==e?void 0:e.stack)?n:"";return{error:{message:`${null!=(t=null==e?void 0:e.name)?t:"FetchError"}: ${null==e?void 0:e.message}`,details:o,hint:"",code:""},data:null,count:null,status:0,statusText:""}})),s.then(e,t)}returns(){return this}overrideTypes(){return this}},sD=class extends s${select(e){let t=!1,r=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e)).join("");return this.url.searchParams.set("select",r),this.headers.append("Prefer","return=representation"),this}order(e,{ascending:t=!0,nullsFirst:r,foreignTable:s,referencedTable:a=s}={}){let i=a?`${a}.order`:"order",n=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${n?`${n},`:""}${e}.${t?"asc":"desc"}${void 0===r?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:r=t}={}){let s=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,t,{foreignTable:r,referencedTable:s=r}={}){let a=void 0===s?"offset":`${s}.offset`,i=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,`${t-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return"GET"===this.method?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:e=!1,verbose:t=!1,settings:r=!1,buffers:s=!1,wal:a=!1,format:i="text"}={}){var n;let o=[e?"analyze":null,t?"verbose":null,r?"settings":null,s?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!=(n=this.headers.get("Accept"))?n:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`),this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(e){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${e}`),this}};let sU=RegExp("[,()]");var sL=class extends sD{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}regexMatch(e,t){return this.url.searchParams.append(e,`match.${t}`),this}regexIMatch(e,t){return this.url.searchParams.append(e,`imatch.${t}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}isDistinct(e,t){return this.url.searchParams.append(e,`isdistinct.${t}`),this}in(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&sU.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}notIn(e,t){let r=Array.from(new Set(t)).map(e=>"string"==typeof e&&sU.test(e)?`"${e}"`:`${e}`).join(",");return this.url.searchParams.append(e,`not.in.(${r})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:r,type:s}={}){let a="";"plain"===s?a="pl":"phrase"===s?a="ph":"websearch"===s&&(a="w");let i=void 0===r?"":`(${r})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach(([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)}),this}not(e,t,r){return this.url.searchParams.append(e,`not.${t}.${r}`),this}or(e,{foreignTable:t,referencedTable:r=t}={}){let s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,t,r){return this.url.searchParams.append(e,`${t}.${r}`),this}},sF=class{constructor(e,{headers:t={},schema:r,fetch:s}){this.url=e,this.headers=new Headers(t),this.schema=r,this.fetch=s}cloneRequestState(){return{url:new URL(this.url.toString()),headers:new Headers(this.headers)}}select(e,t){let{head:r=!1,count:s}=null!=t?t:{},a=!1,i=(null!=e?e:"*").split("").map(e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e)).join(""),{url:n,headers:o}=this.cloneRequestState();return n.searchParams.set("select",i),s&&o.append("Prefer",`count=${s}`),new sL({method:r?"HEAD":"GET",url:n,headers:o,schema:this.schema,fetch:this.fetch})}insert(e,{count:t,defaultToNull:r=!0}={}){var s;let{url:a,headers:i}=this.cloneRequestState();if(t&&i.append("Prefer",`count=${t}`),r||i.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);a.searchParams.set("columns",e.join(","))}}return new sL({method:"POST",url:a,headers:i,schema:this.schema,body:e,fetch:null!=(s=this.fetch)?s:fetch})}upsert(e,{onConflict:t,ignoreDuplicates:r=!1,count:s,defaultToNull:a=!0}={}){var i;let{url:n,headers:o}=this.cloneRequestState();if(o.append("Prefer",`resolution=${r?"ignore":"merge"}-duplicates`),void 0!==t&&n.searchParams.set("on_conflict",t),s&&o.append("Prefer",`count=${s}`),a||o.append("Prefer","missing=default"),Array.isArray(e)){let t=e.reduce((e,t)=>e.concat(Object.keys(t)),[]);if(t.length>0){let e=[...new Set(t)].map(e=>`"${e}"`);n.searchParams.set("columns",e.join(","))}}return new sL({method:"POST",url:n,headers:o,schema:this.schema,body:e,fetch:null!=(i=this.fetch)?i:fetch})}update(e,{count:t}={}){var r;let{url:s,headers:a}=this.cloneRequestState();return t&&a.append("Prefer",`count=${t}`),new sL({method:"PATCH",url:s,headers:a,schema:this.schema,body:e,fetch:null!=(r=this.fetch)?r:fetch})}delete({count:e}={}){var t;let{url:r,headers:s}=this.cloneRequestState();return e&&s.append("Prefer",`count=${e}`),new sL({method:"DELETE",url:r,headers:s,schema:this.schema,fetch:null!=(t=this.fetch)?t:fetch})}},sV=class e{constructor(e,{headers:t={},schema:r,fetch:s}={}){this.url=e,this.headers=new Headers(t),this.schemaName=r,this.fetch=s}from(e){if(!e||"string"!=typeof e||""===e.trim())throw Error("Invalid relation name: relation must be a non-empty string.");return new sF(new URL(`${this.url}/${e}`),{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:r=!1,get:s=!1,count:a}={}){var i;let n,o,l=new URL(`${this.url}/rpc/${e}`),u=e=>null!==e&&"object"==typeof e&&(!Array.isArray(e)||e.some(u)),c=r&&Object.values(t).some(u);c?(n="POST",o=t):r||s?(n=r?"HEAD":"GET",Object.entries(t).filter(([e,t])=>void 0!==t).map(([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`]).forEach(([e,t])=>{l.searchParams.append(e,t)})):(n="POST",o=t);let d=new Headers(this.headers);return c?d.set("Prefer",a?`count=${a},return=minimal`:"return=minimal"):a&&d.set("Prefer",`count=${a}`),new sL({method:n,url:l,headers:d,schema:this.schemaName,body:o,fetch:null!=(i=this.fetch)?i:fetch})}};class sB{constructor(){}static detectEnvironment(){var e;if("undefined"!=typeof WebSocket)return{type:"native",constructor:WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocket)return{type:"native",constructor:globalThis.WebSocket};if("undefined"!=typeof global&&void 0!==global.WebSocket)return{type:"native",constructor:global.WebSocket};if("undefined"!=typeof globalThis&&void 0!==globalThis.WebSocketPair&&void 0===globalThis.WebSocket)return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if("undefined"!=typeof globalThis&&globalThis.EdgeRuntime||"undefined"!=typeof navigator&&(null==(e=navigator.userAgent)?void 0:e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};let t=globalThis.process;if(t){let e=t.versions;if(e&&e.node){let t=parseInt(e.node.replace(/^v/,"").split(".")[0]);return t>=22?void 0!==globalThis.WebSocket?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${t} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${t} detected without native WebSocket support.`,workaround:'For Node.js < 22, install "ws" package and provide it via the transport option:\nimport ws from "ws"\nnew RealtimeClient(url, { transport: ws })'}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){let e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),Error(t)}static createWebSocket(e,t){return new(this.getWebSocketConstructor())(e,t)}static isWebSocketSupported(){try{let e=this.detectEnvironment();return"native"===e.type||"ws"===e.type}catch(e){return!1}}}let sM="2.0.0";!function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"}(c||(c={})),function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"}(d||(d={})),function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"}(h||(h={})),(p||(p={})).websocket="websocket",function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"}(f||(f={}));class sq{constructor(e){this.HEADER_LENGTH=1,this.USER_BROADCAST_PUSH_META_LENGTH=6,this.KINDS={userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST_EVENT="broadcast",this.allowedMetadataKeys=[],this.allowedMetadataKeys=null!=e?e:[]}encode(e,t){return e.event!==this.BROADCAST_EVENT||e.payload instanceof ArrayBuffer||"string"!=typeof e.payload.event?t(JSON.stringify([e.join_ref,e.ref,e.topic,e.event,e.payload])):t(this._binaryEncodeUserBroadcastPush(e))}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer(null==(t=e.payload)?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;let s=null!=(r=null==(t=e.payload)?void 0:t.payload)?r:new ArrayBuffer(0);return this._encodeUserBroadcastPush(e,this.BINARY_ENCODING,s)}_encodeJsonUserBroadcastPush(e){var t,r;let s=null!=(r=null==(t=e.payload)?void 0:t.payload)?r:{},a=new TextEncoder().encode(JSON.stringify(s)).buffer;return this._encodeUserBroadcastPush(e,this.JSON_ENCODING,a)}_encodeUserBroadcastPush(e,t,r){let s=e.topic,a=null!=(p=e.ref)?p:"",i=null!=(f=e.join_ref)?f:"",n=e.payload.event,o=this.allowedMetadataKeys?this._pick(e.payload,this.allowedMetadataKeys):{},l=0===Object.keys(o).length?"":JSON.stringify(o);if(i.length>255)throw Error(`joinRef length ${i.length} exceeds maximum of 255`);if(a.length>255)throw Error(`ref length ${a.length} exceeds maximum of 255`);if(s.length>255)throw Error(`topic length ${s.length} exceeds maximum of 255`);if(n.length>255)throw Error(`userEvent length ${n.length} exceeds maximum of 255`);if(l.length>255)throw Error(`metadata length ${l.length} exceeds maximum of 255`);let u=this.USER_BROADCAST_PUSH_META_LENGTH+i.length+a.length+s.length+n.length+l.length,c=new ArrayBuffer(this.HEADER_LENGTH+u),d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.userBroadcastPush),d.setUint8(h++,i.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),d.setUint8(h++,n.length),d.setUint8(h++,l.length),d.setUint8(h++,t),Array.from(i,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(a,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(s,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(n,e=>d.setUint8(h++,e.charCodeAt(0))),Array.from(l,e=>d.setUint8(h++,e.charCodeAt(0)));var p,f,m=new Uint8Array(c.byteLength+r.byteLength);return m.set(new Uint8Array(c),0),m.set(new Uint8Array(r),c.byteLength),m.buffer}decode(e,t){if(this._isArrayBuffer(e))return t(this._binaryDecode(e));if("string"==typeof e){let[r,s,a,i,n]=JSON.parse(e);return t({join_ref:r,ref:s,topic:a,event:i,payload:n})}return t({})}_binaryDecode(e){let t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;if(r===this.KINDS.userBroadcast)return this._decodeUserBroadcast(e,t,s)}_decodeUserBroadcast(e,t,r){let s=t.getUint8(1),a=t.getUint8(2),i=t.getUint8(3),n=t.getUint8(4),o=this.HEADER_LENGTH+4,l=r.decode(e.slice(o,o+s));o+=s;let u=r.decode(e.slice(o,o+a));o+=a;let c=r.decode(e.slice(o,o+i));o+=i;let d=e.slice(o,e.byteLength),h=n===this.JSON_ENCODING?JSON.parse(r.decode(d)):d,p={type:this.BROADCAST_EVENT,event:u,payload:h};return i>0&&(p.meta=JSON.parse(c)),{join_ref:null,ref:null,topic:l,event:this.BROADCAST_EVENT,payload:p}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||(null==(t=null==e?void 0:e.constructor)?void 0:t.name)==="ArrayBuffer"}_pick(e,t){return e&&"object"==typeof e?Object.fromEntries(Object.entries(e).filter(([e])=>t.includes(e))):{}}}class sz{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}!function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"}(m||(m={}));let sK=(e,t,r={})=>{var s;let a=null!=(s=r.skipTypes)?s:[];return t?Object.keys(t).reduce((r,s)=>(r[s]=sW(s,e,t,a),r),{}):{}},sW=(e,t,r,s)=>{let a=t.find(t=>t.name===e),i=null==a?void 0:a.type,n=r[e];return i&&!s.includes(i)?sZ(i,n):sG(n)},sZ=(e,t)=>{if("_"===e.charAt(0))return sX(t,e.slice(1,e.length));switch(e){case m.bool:return sH(t);case m.float4:case m.float8:case m.int2:case m.int4:case m.int8:case m.numeric:case m.oid:return sJ(t);case m.json:case m.jsonb:return sY(t);case m.timestamp:return sQ(t);case m.abstime:case m.date:case m.daterange:case m.int4range:case m.int8range:case m.money:case m.reltime:case m.text:case m.time:case m.timestamptz:case m.timetz:case m.tsrange:case m.tstzrange:default:return sG(t)}},sG=e=>e,sH=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},sJ=e=>{if("string"==typeof e){let t=parseFloat(e);if(!Number.isNaN(t))return t}return e},sY=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(e){}return e},sX=(e,t)=>{if("string"!=typeof e)return e;let r=e.length-1,s=e[r];if("{"===e[0]&&"}"===s){let s,a=e.slice(1,r);try{s=JSON.parse("["+a+"]")}catch(e){s=a?a.split(","):[]}return s.map(e=>sZ(t,e))}return e},sQ=e=>"string"==typeof e?e.replace(" ","T"):e,s0=e=>{let t=new URL(e);return t.protocol=t.protocol.replace(/^ws/i,"http"),t.pathname=t.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),""===t.pathname||"/"===t.pathname?t.pathname="/api/broadcast":t.pathname=t.pathname+"/api/broadcast",t.href};class s1{constructor(e,t,r={},s=1e4){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t(null==(r=this.receivedResp)?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){this.timeoutTimer||(this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref),this.channel._on(this.refEvent,{},e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)}),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout))}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(t=>t.status===e).forEach(e=>e.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}!function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"}(g||(g={}));class s2{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};let r=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.joinRef=this.channel._joinRef(),this.state=s2.syncState(this.state,e,t,r),this.pendingDiffs.forEach(e=>{this.state=s2.syncDiff(this.state,e,t,r)}),this.pendingDiffs=[],s()}),this.channel._on(r.diff,{},e=>{let{onJoin:t,onLeave:r,onSync:s}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=s2.syncDiff(this.state,e,t,r),s())}),this.onJoin((e,t,r)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:r})}),this.onLeave((e,t,r)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:r})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){let a=this.cloneDeep(e),i=this.transformState(t),n={},o={};return this.map(a,(e,t)=>{i[e]||(o[e]=t)}),this.map(i,(e,t)=>{let r=a[e];if(r){let s=t.map(e=>e.presence_ref),a=r.map(e=>e.presence_ref),i=t.filter(e=>0>a.indexOf(e.presence_ref)),l=r.filter(e=>0>s.indexOf(e.presence_ref));i.length>0&&(n[e]=i),l.length>0&&(o[e]=l)}else n[e]=t}),this.syncDiff(a,{joins:n,leaves:o},r,s)}static syncDiff(e,t,r,s){let{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(t,s)=>{var a;let i=null!=(a=e[t])?a:[];if(e[t]=this.cloneDeep(s),i.length>0){let r=e[t].map(e=>e.presence_ref),s=i.filter(e=>0>r.indexOf(e.presence_ref));e[t].unshift(...s)}r(t,i,s)}),this.map(i,(t,r)=>{let a=e[t];if(!a)return;let i=r.map(e=>e.presence_ref);a=a.filter(e=>0>i.indexOf(e.presence_ref)),e[t]=a,s(t,a,r),0===a.length&&delete e[t]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return Object.getOwnPropertyNames(e=this.cloneDeep(e)).reduce((t,r)=>{let s=e[r];return"metas"in s?t[r]=s.metas.map(e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}!function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"}(y||(y={})),function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"}(v||(v={})),function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"}(_||(_={}));class s4{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=d.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new s1(this,h.join,this.params,this.timeout),this.rejoinTimer=new sz(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=d.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(e=>e.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=d.closed,this.socket._remove(this)}),this._onError(e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=d.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=d.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=d.errored,this.rejoinTimer.scheduleTimeout())}),this._on(h.reply,{},(e,t)=>{this._trigger(this._replyEventName(t),e)}),this.presence=new s2(this),this.broadcastEndpointURL=s0(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(null==(a=null==(s=this.params.config)?void 0:s.broadcast)?void 0:a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==d.closed){let{config:{broadcast:i,presence:n,private:o}}=this.params,l=null!=(s=null==(r=this.bindings.postgres_changes)?void 0:r.map(e=>e.filter))?s:[],u=!!this.bindings[v.PRESENCE]&&this.bindings[v.PRESENCE].length>0||(null==(a=this.params.config.presence)?void 0:a.enabled)===!0,c={},h={broadcast:i,presence:Object.assign(Object.assign({},n),{enabled:u}),postgres_changes:l,private:o};this.socket.accessTokenValue&&(c.access_token=this.socket.accessTokenValue),this._onError(t=>null==e?void 0:e(_.CHANNEL_ERROR,t)),this._onClose(()=>null==e?void 0:e(_.CLOSED)),this.updateJoinPayload(Object.assign({config:h},c)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:t})=>{var r;if(this.socket._isManualToken()||this.socket.setAuth(),void 0===t){null==e||e(_.SUBSCRIBED);return}{let s=this.bindings.postgres_changes,a=null!=(r=null==s?void 0:s.length)?r:0,i=[];for(let r=0;r<a;r++){let a=s[r],{filter:{event:n,schema:o,table:l,filter:u}}=a,c=t&&t[r];if(c&&c.event===n&&s4.isFilterValueEqual(c.schema,o)&&s4.isFilterValueEqual(c.table,l)&&s4.isFilterValueEqual(c.filter,u))i.push(Object.assign(Object.assign({},a),{id:c.id}));else{this.unsubscribe(),this.state=d.errored,null==e||e(_.CHANNEL_ERROR,Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=i,e&&e(_.SUBSCRIBED);return}}).receive("error",t=>{this.state=d.errored,null==e||e(_.CHANNEL_ERROR,Error(JSON.stringify(Object.values(t).join(", ")||"error")))}).receive("timeout",()=>{null==e||e(_.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===d.joined&&e===v.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(async()=>await this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;if(null==t)return Promise.reject("Payload is required for httpSend()");let a={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(a.Authorization=`Bearer ${this.socket.accessTokenValue}`);let i={method:"POST",headers:a,body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},n=await this._fetchWithTimeout(this.broadcastEndpointURL,i,null!=(s=r.timeout)?s:this.timeout);if(202===n.status)return{success:!0};let o=n.statusText;try{let e=await n.json();o=e.error||e.message||o}catch(e){}return Promise.reject(Error(o))}async send(e,t={}){var r,s;if(this._canPush()||"broadcast"!==e.type)return new Promise(r=>{var s,a,i;let n=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null==(i=null==(a=null==(s=this.params)?void 0:s.config)?void 0:a.broadcast)?void 0:i.ack)||r("ok"),n.receive("ok",()=>r("ok")),n.receive("error",()=>r("error")),n.receive("timeout",()=>r("timed out"))});{console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");let{event:a,payload:i}=e,n={apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"};this.socket.accessTokenValue&&(n.Authorization=`Bearer ${this.socket.accessTokenValue}`);let o={method:"POST",headers:n,body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:i,private:this.private}]})};try{let e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!=(r=t.timeout)?r:this.timeout);return await (null==(s=e.body)?void 0:s.cancel()),e.ok?"ok":"error"}catch(e){if("AbortError"===e.name)return"timed out";return"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=d.leaving;let t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(h.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{(r=new s1(this,h.leave,{},e)).receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{null==r||r.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=d.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){let s=new AbortController,a=setTimeout(()=>s.abort(),r),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),i}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new s1(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>100){let e=this.pushBuffer.shift();e&&(e.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${e.event}`,e.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;let i=e.toLocaleLowerCase(),{close:n,error:o,leave:l,join:u}=h;if(r&&[n,o,l,u].indexOf(i)>=0&&r!==this._joinRef())return;let c=this._onMessage(i,t,r);if(t&&!c)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null==(s=this.bindings.postgres_changes)||s.filter(e=>{var t,r,s;return(null==(t=e.filter)?void 0:t.event)==="*"||(null==(s=null==(r=e.filter)?void 0:r.event)?void 0:s.toLocaleLowerCase())===i}).map(e=>e.callback(c,r)):null==(a=this.bindings[i])||a.filter(e=>{var r,s,a,n,o,l;if(!["broadcast","presence","postgres_changes"].includes(i))return e.type.toLocaleLowerCase()===i;if("id"in e){let i=e.id,n=null==(r=e.filter)?void 0:r.event;return i&&(null==(s=t.ids)?void 0:s.includes(i))&&("*"===n||(null==n?void 0:n.toLocaleLowerCase())===(null==(a=t.data)?void 0:a.type.toLocaleLowerCase()))}{let r=null==(o=null==(n=null==e?void 0:e.filter)?void 0:n.event)?void 0:o.toLocaleLowerCase();return"*"===r||r===(null==(l=null==t?void 0:t.event)?void 0:l.toLocaleLowerCase())}}).map(e=>{if("object"==typeof c&&"ids"in c){let e=c.data,{schema:t,table:r,commit_timestamp:s,type:a,errors:i}=e;c=Object.assign(Object.assign({},{schema:t,table:r,commit_timestamp:s,eventType:a,new:{},old:{},errors:i}),this._getPayloadRecords(e))}e.callback(c,r)})}_isClosed(){return this.state===d.closed}_isJoined(){return this.state===d.joined}_isJoining(){return this.state===d.joining}_isLeaving(){return this.state===d.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){let s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){let r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(e=>{var s;return!((null==(s=e.type)?void 0:s.toLocaleLowerCase())===r&&s4.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(let r in e)if(e[r]!==t[r])return!1;return!0}static isFilterValueEqual(e,t){return(null!=e?e:void 0)===(null!=t?t:void 0)}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(h.close,{},e)}_onError(e){this._on(h.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=d.joining,this.joinPush.resend(e))}_getPayloadRecords(e){let t={new:{},old:{}};return("INSERT"===e.type||"UPDATE"===e.type)&&(t.new=sK(e.columns,e.record)),("UPDATE"===e.type||"DELETE"===e.type)&&(t.old=sK(e.columns,e.old_record)),t}}let s9=()=>{},s5={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},s3=[1e3,2e3,5e3,1e4],s8=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class s6{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this._manuallySetToken=!1,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=1e4,this.transport=null,this.heartbeatIntervalMs=s5.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=s9,this.ref=0,this.reconnectTimer=null,this.vsn=sM,this.logger=s9,this.conn=null,this.sendBuffer=[],this.serializer=new sq,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._heartbeatSentAt=null,this._resolveFetch=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),!(null==(r=null==t?void 0:t.params)?void 0:r.apikey))throw Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${p.websocket}`,this.httpEndpoint=s0(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(null==t?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||null!==this.conn&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=sB.createWebSocket(this.endpointURL())}catch(t){this._setConnectionState("disconnected");let e=t.message;if(e.includes("Node.js"))throw Error(`${e}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`);throw Error(`WebSocket not available: ${e}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){let r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},"function"==typeof this.conn.close&&(e?this.conn.close(e,null!=t?t:""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){let t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){let e=await Promise.all(this.channels.map(e=>e.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case c.connecting:return f.Connecting;case c.open:return f.Open;case c.closing:return f.Closing;default:return f.Closed}}isConnected(){return this.connectionState()===f.Open}isConnecting(){return"connecting"===this._connectionState}isDisconnecting(){return"disconnecting"===this._connectionState}channel(e,t={config:{}}){let r=`realtime:${e}`,s=this.getChannels().find(e=>e.topic===r);if(s)return s;{let r=new s4(`realtime:${e}`,t,this);return this.channels.push(r),r}}push(e){let{topic:t,event:r,payload:s,ref:a}=e,i=()=>{this.encode(e,e=>{var t;null==(t=this.conn)||t.send(e)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}_isManualToken(){return this._manuallySetToken}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(e){this.log("error","error in heartbeat callback",e)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this._heartbeatSentAt=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(e){this.log("error","error in heartbeat callback",e)}this._wasManualDisconnect=!1,null==(e=this.conn)||e.close(1e3,"heartbeat timeout"),setTimeout(()=>{var e;this.isConnected()||null==(e=this.reconnectTimer)||e.scheduleTimeout()},s5.HEARTBEAT_TIMEOUT_FALLBACK);return}this._heartbeatSentAt=Date.now(),this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(e){this.log("error","error in heartbeat callback",e)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(t=>t.topic===e&&(t._isJoined()||t._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,e=>{if("phoenix"===e.topic&&"phx_reply"===e.event&&e.ref&&e.ref===this.pendingHeartbeatRef){let t=this._heartbeatSentAt?Date.now()-this._heartbeatSentAt:void 0;try{this.heartbeatCallback("ok"===e.payload.status?"ok":"error",t)}catch(e){this.log("error","error in heartbeat callback",e)}this._heartbeatSentAt=null,this.pendingHeartbeatRef=null}let{topic:t,event:r,payload:s,ref:a}=e,i=a?`(${a})`:"",n=s.status||"";this.log("receive",`${n} ${t} ${r} ${i}`.trim(),s),this.channels.filter(e=>e._isMember(t)).forEach(e=>e._trigger(r,s,a)),this._triggerStateCallbacks("message",e)})}_clearTimer(e){var t;"heartbeat"===e&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):"reconnect"===e&&(null==(t=this.reconnectTimer)||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e),this.conn.readyState===c.open&&this._onConnOpen())}_teardownConnection(){if(this.conn){if(this.conn.readyState===c.open||this.conn.readyState===c.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this._terminateWorker(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(e=>{this.log("error","error waiting for auth on connect",e),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");let e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this._terminateWorker()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_terminateWorker(){this.workerRef&&(this.log("worker","terminating worker"),this.workerRef.terminate(),this.workerRef=void 0)}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||null==(t=this.reconnectTimer)||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e);try{this.heartbeatCallback("error")}catch(e){this.log("error","error in heartbeat callback",e)}}_triggerChanError(){this.channels.forEach(e=>e._trigger(h.error))}_appendParams(e,t){if(0===Object.keys(t).length)return e;let r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{let e=new Blob([s8],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}_setConnectionState(e,t=!1){this._connectionState=e,"connecting"===e?this._wasManualDisconnect=!1:"disconnecting"===e&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t,r=!1;if(e)t=e,r=!0;else if(this.accessToken)try{t=await this.accessToken()}catch(e){this.log("error","Error fetching access token from callback",e),t=this.accessTokenValue}else t=this.accessTokenValue;r?this._manuallySetToken=!0:this.accessToken&&(this._manuallySetToken=!1),this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(e=>{let r={access_token:t,version:"realtime-js/2.93.1"};t&&e.updateJoinPayload(r),e.joinedOnce&&e._isJoined()&&e._push(h.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this._isManualToken()||this.setAuth().catch(t=>{this.log("error",`Error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(t){this.log("error",`error in ${e} callback`,t)}})}catch(t){this.log("error",`error triggering ${e} callbacks`,t)}}_setupReconnectionTimer(){this.reconnectTimer=new sz(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},s5.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,i,n,o,l,u,c,d,h;switch(this.transport=null!=(t=null==e?void 0:e.transport)?t:null,this.timeout=null!=(r=null==e?void 0:e.timeout)?r:1e4,this.heartbeatIntervalMs=null!=(s=null==e?void 0:e.heartbeatIntervalMs)?s:s5.HEARTBEAT_INTERVAL,this.worker=null!=(a=null==e?void 0:e.worker)&&a,this.accessToken=null!=(i=null==e?void 0:e.accessToken)?i:null,this.heartbeatCallback=null!=(n=null==e?void 0:e.heartbeatCallback)?n:s9,this.vsn=null!=(o=null==e?void 0:e.vsn)?o:sM,(null==e?void 0:e.params)&&(this.params=e.params),(null==e?void 0:e.logger)&&(this.logger=e.logger),((null==e?void 0:e.logLevel)||(null==e?void 0:e.log_level))&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=null!=(l=null==e?void 0:e.reconnectAfterMs)?l:e=>s3[e-1]||1e4,this.vsn){case"1.0.0":this.encode=null!=(u=null==e?void 0:e.encode)?u:(e,t)=>t(JSON.stringify(e)),this.decode=null!=(c=null==e?void 0:e.decode)?c:(e,t)=>t(JSON.parse(e));break;case sM:this.encode=null!=(d=null==e?void 0:e.encode)?d:this.serializer.encode.bind(this.serializer),this.decode=null!=(h=null==e?void 0:e.decode)?h:this.serializer.decode.bind(this.serializer);break;default:throw Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if("undefined"!=typeof window&&!window.Worker)throw Error("Web Worker is not supported");this.workerUrl=null==e?void 0:e.workerUrl}}}var s7=class extends Error{constructor(e,t){super(e),this.name="IcebergError",this.status=t.status,this.icebergType=t.icebergType,this.icebergCode=t.icebergCode,this.details=t.details,this.isCommitStateUnknown="CommitStateUnknownException"===t.icebergType||[500,502,504].includes(t.status)&&t.icebergType?.includes("CommitState")===!0}isNotFound(){return 404===this.status}isConflict(){return 409===this.status}isAuthenticationTimeout(){return 419===this.status}};async function ae(e){return e&&"none"!==e.type?"bearer"===e.type?{Authorization:`Bearer ${e.token}`}:"header"===e.type?{[e.name]:e.value}:"custom"===e.type?await e.getHeaders():{}:{}}function at(e){return e.join("\x1f")}var ar=class{constructor(e,t=""){this.client=e,this.prefix=t}async listNamespaces(e){let t=e?{parent:at(e.namespace)}:void 0;return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces`,query:t})).data.namespaces.map(e=>({namespace:e}))}async createNamespace(e,t){let r={namespace:e.namespace,properties:t?.properties};return(await this.client.request({method:"POST",path:`${this.prefix}/namespaces`,body:r})).data}async dropNamespace(e){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${at(e.namespace)}`})}async loadNamespaceMetadata(e){return{properties:(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${at(e.namespace)}`})).data.properties}}async namespaceExists(e){try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${at(e.namespace)}`}),!0}catch(e){if(e instanceof s7&&404===e.status)return!1;throw e}}async createNamespaceIfNotExists(e,t){try{return await this.createNamespace(e,t)}catch(e){if(e instanceof s7&&409===e.status)return;throw e}}};function as(e){return e.join("\x1f")}var aa=class{constructor(e,t="",r){this.client=e,this.prefix=t,this.accessDelegation=r}async listTables(e){return(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables`})).data.identifiers}async createTable(e,t){let r={};return this.accessDelegation&&(r["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables`,body:t,headers:r})).data.metadata}async updateTable(e,t){let r=await this.client.request({method:"POST",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables/${e.name}`,body:t});return{"metadata-location":r.data["metadata-location"],metadata:r.data.metadata}}async dropTable(e,t){await this.client.request({method:"DELETE",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables/${e.name}`,query:{purgeRequested:String(t?.purge??!1)}})}async loadTable(e){let t={};return this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation),(await this.client.request({method:"GET",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables/${e.name}`,headers:t})).data.metadata}async tableExists(e){let t={};this.accessDelegation&&(t["X-Iceberg-Access-Delegation"]=this.accessDelegation);try{return await this.client.request({method:"HEAD",path:`${this.prefix}/namespaces/${as(e.namespace)}/tables/${e.name}`,headers:t}),!0}catch(e){if(e instanceof s7&&404===e.status)return!1;throw e}}async createTableIfNotExists(e,t){try{return await this.createTable(e,t)}catch(r){if(r instanceof s7&&409===r.status)return await this.loadTable({namespace:e.namespace,name:t.name});throw r}}},ai=class{constructor(e){let t="v1";e.catalogName&&(t+=`/${e.catalogName}`);let r=e.baseUrl.endsWith("/")?e.baseUrl:`${e.baseUrl}/`;this.client=function(e){let t=e.fetchImpl??globalThis.fetch;return{async request({method:r,path:s,query:a,body:i,headers:n}){let o=function(e,t,r){let s=new URL(t,e);if(r)for(let[e,t]of Object.entries(r))void 0!==t&&s.searchParams.set(e,t);return s.toString()}(e.baseUrl,s,a),l=await ae(e.auth),u=await t(o,{method:r,headers:{...i?{"Content-Type":"application/json"}:{},...l,...n},body:i?JSON.stringify(i):void 0}),c=await u.text(),d=(u.headers.get("content-type")||"").includes("application/json"),h=d&&c?JSON.parse(c):c;if(!u.ok){let e=d?h:void 0,t=e?.error;throw new s7(t?.message??`Request failed with status ${u.status}`,{status:u.status,icebergType:t?.type,icebergCode:t?.code,details:e})}return{status:u.status,headers:u.headers,data:h}}}}({baseUrl:r,auth:e.auth,fetchImpl:e.fetch}),this.accessDelegation=e.accessDelegation?.join(","),this.namespaceOps=new ar(this.client,t),this.tableOps=new aa(this.client,t,this.accessDelegation)}async listNamespaces(e){return this.namespaceOps.listNamespaces(e)}async createNamespace(e,t){return this.namespaceOps.createNamespace(e,t)}async dropNamespace(e){await this.namespaceOps.dropNamespace(e)}async loadNamespaceMetadata(e){return this.namespaceOps.loadNamespaceMetadata(e)}async listTables(e){return this.tableOps.listTables(e)}async createTable(e,t){return this.tableOps.createTable(e,t)}async updateTable(e,t){return this.tableOps.updateTable(e,t)}async dropTable(e,t){await this.tableOps.dropTable(e,t)}async loadTable(e){return this.tableOps.loadTable(e)}async namespaceExists(e){return this.namespaceOps.namespaceExists(e)}async tableExists(e){return this.tableOps.tableExists(e)}async createNamespaceIfNotExists(e,t){return this.namespaceOps.createNamespaceIfNotExists(e,t)}async createTableIfNotExists(e,t){return this.tableOps.createTableIfNotExists(e,t)}},an=/^decimal\s*\(\s*(\d+)\s*,\s*(\d+)\s*\)$/,ao=/^fixed\s*\[\s*(\d+)\s*\]$/,al=class extends Error{constructor(e,t="storage",r,s){super(e),this.__isStorageError=!0,this.namespace=t,this.name="vectors"===t?"StorageVectorsError":"StorageError",this.status=r,this.statusCode=s}};function au(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}var ac=class extends al{constructor(e,t,r,s="storage"){super(e,s,t,r),this.name="vectors"===s?"StorageVectorsApiError":"StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}},ad=class extends al{constructor(e,t,r="storage"){super(e,r),this.name="vectors"===r?"StorageVectorsUnknownError":"StorageUnknownError",this.originalError=t}};let ah=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),ap=e=>{if("object"!=typeof e||null===e)return!1;let t=Object.getPrototypeOf(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},af=e=>{if(Array.isArray(e))return e.map(e=>af(e));if("function"==typeof e||e!==Object(e))return e;let t={};return Object.entries(e).forEach(([e,r])=>{t[e.replace(/([-_][a-z])/gi,e=>e.toUpperCase().replace(/[-_]/g,""))]=af(r)}),t},am=e=>!(!e||"string"!=typeof e||0===e.length||e.length>100||e.trim()!==e||e.includes("/")||e.includes("\\"))&&/^[\w!.\*'() &$@=;:+,?-]+$/.test(e);function ag(e){return(ag="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ay(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function av(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ay(Object(r),!0).forEach(function(t){!function(e,t,r){var s;(s=function(e,t){if("object"!=ag(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=ag(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==ag(s)?s:s+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ay(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let a_=e=>{var t;return e.msg||e.message||e.error_description||("string"==typeof e.error?e.error:null==(t=e.error)?void 0:t.message)||JSON.stringify(e)},ab=async(e,t,r,s)=>{if(e&&"object"==typeof e&&"status"in e&&"ok"in e&&"number"==typeof e.status&&!(null==r?void 0:r.noResolveJson)){let r=e.status||500;"function"==typeof e.json?e.json().then(e=>{let a=(null==e?void 0:e.statusCode)||(null==e?void 0:e.code)||r+"";t(new ac(a_(e),r,a,s))}).catch(()=>{t(new ac(e.statusText||`HTTP ${r} error`,r,r+"",s))}):t(new ac(e.statusText||`HTTP ${r} error`,r,r+"",s))}else t(new ad(a_(e),e,s))},aw=(e,t,r,s)=>{let a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"!==e&&"HEAD"!==e&&s&&(ap(s)?(a.headers=av({"Content-Type":"application/json"},null==t?void 0:t.headers),a.body=JSON.stringify(s)):a.body=s,(null==t?void 0:t.duplex)&&(a.duplex=t.duplex)),av(av({},a),r)};async function ak(e,t,r,s,a,i,n){return new Promise((o,l)=>{e(r,aw(t,s,a,i)).then(e=>{if(!e.ok)throw e;if(null==s?void 0:s.noResolveJson)return e;if("vectors"===n){let t=e.headers.get("content-type");if(!t||!t.includes("application/json"))return{}}return e.json()}).then(e=>o(e)).catch(e=>ab(e,l,s,n))})}let{get:ax,post:aS,put:aT,head:aj,remove:aE}=function(e="storage"){return{get:async(t,r,s,a)=>ak(t,"GET",r,s,a,void 0,e),post:async(t,r,s,a,i)=>ak(t,"POST",r,a,i,s,e),put:async(t,r,s,a,i)=>ak(t,"PUT",r,a,i,s,e),head:async(t,r,s,a)=>ak(t,"HEAD",r,av(av({},s),{},{noResolveJson:!0}),a,void 0,e),remove:async(t,r,s,a,i)=>ak(t,"DELETE",r,a,i,s,e)}}("storage");var aA=class{constructor(e,t={},r,s="storage"){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.fetch=ah(r),this.namespace=s}throwOnError(){return this.shouldThrowOnError=!0,this}async handleOperation(e){try{return{data:await e(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(au(e))return{data:null,error:e};throw e}}},aO=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}async execute(){try{return{data:(await this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(au(e))return{data:null,error:e};throw e}}};a=Symbol.toStringTag;var aR=class{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[a]="BlobDownloadBuilder",this.promise=null}asStream(){return new aO(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}async execute(){try{return{data:await (await this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(au(e))return{data:null,error:e};throw e}}};let aC={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},aN={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};var aP=class extends aA{constructor(e,t={},r,s){super(e,t,s,"storage"),this.bucketId=r}async uploadOrUpdate(e,t,r,s){var a=this;return a.handleOperation(async()=>{let i,n=av(av({},aN),s),o=av(av({},a.headers),"POST"===e&&{"x-upsert":String(n.upsert)}),l=n.metadata;"undefined"!=typeof Blob&&r instanceof Blob?((i=new FormData).append("cacheControl",n.cacheControl),l&&i.append("metadata",a.encodeMetadata(l)),i.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?((i=r).has("cacheControl")||i.append("cacheControl",n.cacheControl),l&&!i.has("metadata")&&i.append("metadata",a.encodeMetadata(l))):(i=r,o["cache-control"]=`max-age=${n.cacheControl}`,o["content-type"]=n.contentType,l&&(o["x-metadata"]=a.toBase64(a.encodeMetadata(l))),("undefined"!=typeof ReadableStream&&i instanceof ReadableStream||i&&"object"==typeof i&&"pipe"in i&&"function"==typeof i.pipe)&&!n.duplex&&(n.duplex="half")),(null==s?void 0:s.headers)&&(o=av(av({},o),s.headers));let u=a._removeEmptyFolders(t),c=a._getFinalPath(u),d=await ("PUT"==e?aT:aS)(a.fetch,`${a.url}/object/${c}`,i,av({headers:o},(null==n?void 0:n.duplex)?{duplex:n.duplex}:{}));return{path:u,id:d.Id,fullPath:d.Key}})}async upload(e,t,r){return this.uploadOrUpdate("POST",e,t,r)}async uploadToSignedUrl(e,t,r,s){var a=this;let i=a._removeEmptyFolders(e),n=a._getFinalPath(i),o=new URL(a.url+`/object/upload/sign/${n}`);return o.searchParams.set("token",t),a.handleOperation(async()=>{let e,t=av({upsert:aN.upsert},s),n=av(av({},a.headers),{"x-upsert":String(t.upsert)});return"undefined"!=typeof Blob&&r instanceof Blob?((e=new FormData).append("cacheControl",t.cacheControl),e.append("",r)):"undefined"!=typeof FormData&&r instanceof FormData?(e=r).append("cacheControl",t.cacheControl):(e=r,n["cache-control"]=`max-age=${t.cacheControl}`,n["content-type"]=t.contentType),{path:i,fullPath:(await aT(a.fetch,o.toString(),e,{headers:n})).Key}})}async createSignedUploadUrl(e,t){var r=this;return r.handleOperation(async()=>{let s=r._getFinalPath(e),a=av({},r.headers);(null==t?void 0:t.upsert)&&(a["x-upsert"]="true");let i=await aS(r.fetch,`${r.url}/object/upload/sign/${s}`,{},{headers:a}),n=new URL(r.url+i.url),o=n.searchParams.get("token");if(!o)throw new al("No token returned by API");return{signedUrl:n.toString(),path:e,token:o}})}async update(e,t,r){return this.uploadOrUpdate("PUT",e,t,r)}async move(e,t,r){var s=this;return s.handleOperation(async()=>await aS(s.fetch,`${s.url}/object/move`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers}))}async copy(e,t,r){var s=this;return s.handleOperation(async()=>({path:(await aS(s.fetch,`${s.url}/object/copy`,{bucketId:s.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==r?void 0:r.destinationBucket},{headers:s.headers})).Key}))}async createSignedUrl(e,t,r){var s=this;return s.handleOperation(async()=>{let a=s._getFinalPath(e),i=await aS(s.fetch,`${s.url}/object/sign/${a}`,av({expiresIn:t},(null==r?void 0:r.transform)?{transform:r.transform}:{}),{headers:s.headers}),n=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return{signedUrl:encodeURI(`${s.url}${i.signedURL}${n}`)}})}async createSignedUrls(e,t,r){var s=this;return s.handleOperation(async()=>{let a=await aS(s.fetch,`${s.url}/object/sign/${s.bucketId}`,{expiresIn:t,paths:e},{headers:s.headers}),i=(null==r?void 0:r.download)?`&download=${!0===r.download?"":r.download}`:"";return a.map(e=>av(av({},e),{},{signedUrl:e.signedURL?encodeURI(`${s.url}${e.signedURL}${i}`):null}))})}download(e,t){let r=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",s=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=s?`?${s}`:"",i=this._getFinalPath(e);return new aR(()=>ax(this.fetch,`${this.url}/${r}/${i}${a}`,{headers:this.headers,noResolveJson:!0}),this.shouldThrowOnError)}async info(e){var t=this;let r=t._getFinalPath(e);return t.handleOperation(async()=>af(await ax(t.fetch,`${t.url}/object/info/${r}`,{headers:t.headers})))}async exists(e){let t=this._getFinalPath(e);try{return await aj(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(au(e)&&e instanceof ad){let t=e.originalError;if([400,404].includes(null==t?void 0:t.status))return{data:!1,error:e}}throw e}}getPublicUrl(e,t){let r=this._getFinalPath(e),s=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&s.push(a);let i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==n&&s.push(n);let o=s.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${r}${o}`)}}}async remove(e){var t=this;return t.handleOperation(async()=>await aE(t.fetch,`${t.url}/object/${t.bucketId}`,{prefixes:e},{headers:t.headers}))}async list(e,t,r){var s=this;return s.handleOperation(async()=>{let a=av(av(av({},aC),t),{},{prefix:e||""});return await aS(s.fetch,`${s.url}/object/list/${s.bucketId}`,a,{headers:s.headers},r)})}async listV2(e,t){var r=this;return r.handleOperation(async()=>{let s=av({},e);return await aS(r.fetch,`${r.url}/object/list-v2/${r.bucketId}`,s,{headers:r.headers},t)})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){let t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}};let aI={"X-Client-Info":"storage-js/2.93.1"};var a$=class extends aA{constructor(e,t={},r,s){let a=new URL(e);(null==s?void 0:s.useNewHostname)&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),super(a.href.replace(/\/$/,""),av(av({},aI),t),r,"storage")}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=t.listBucketOptionsToQueryString(e);return await ax(t.fetch,`${t.url}/bucket${r}`,{headers:t.headers})})}async getBucket(e){var t=this;return t.handleOperation(async()=>await ax(t.fetch,`${t.url}/bucket/${e}`,{headers:t.headers}))}async createBucket(e,t={public:!1}){var r=this;return r.handleOperation(async()=>await aS(r.fetch,`${r.url}/bucket`,{id:e,name:e,type:t.type,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async updateBucket(e,t){var r=this;return r.handleOperation(async()=>await aT(r.fetch,`${r.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:r.headers}))}async emptyBucket(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/bucket/${e}/empty`,{},{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await aE(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}listBucketOptionsToQueryString(e){let t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}},aD=class extends aA{constructor(e,t={},r){super(e.replace(/\/$/,""),av(av({},aI),t),r,"storage")}async createBucket(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/bucket`,{name:e},{headers:t.headers}))}async listBuckets(e){var t=this;return t.handleOperation(async()=>{let r=new URLSearchParams;(null==e?void 0:e.limit)!==void 0&&r.set("limit",e.limit.toString()),(null==e?void 0:e.offset)!==void 0&&r.set("offset",e.offset.toString()),(null==e?void 0:e.sortColumn)&&r.set("sortColumn",e.sortColumn),(null==e?void 0:e.sortOrder)&&r.set("sortOrder",e.sortOrder),(null==e?void 0:e.search)&&r.set("search",e.search);let s=r.toString(),a=s?`${t.url}/bucket?${s}`:`${t.url}/bucket`;return await ax(t.fetch,a,{headers:t.headers})})}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await aE(t.fetch,`${t.url}/bucket/${e}`,{},{headers:t.headers}))}from(e){var t=this;if(!am(e))throw new al("Invalid bucket name: File, folder, and bucket names must follow AWS object key naming guidelines and should avoid the use of any other characters.");let r=new ai({baseUrl:this.url,catalogName:e,auth:{type:"custom",getHeaders:async()=>t.headers},fetch:this.fetch}),s=this.shouldThrowOnError;return new Proxy(r,{get(e,t){let r=e[t];return"function"!=typeof r?r:async(...t)=>{try{return{data:await r.apply(e,t),error:null}}catch(e){if(s)throw e;return{data:null,error:e}}}}})}},aU=class extends aA{constructor(e,t={},r){super(e.replace(/\/$/,""),av(av({},aI),{},{"Content-Type":"application/json"},t),r,"vectors")}async createIndex(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/CreateIndex`,e,{headers:t.headers})||{})}async getIndex(e,t){var r=this;return r.handleOperation(async()=>await aS(r.fetch,`${r.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers}))}async listIndexes(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/ListIndexes`,e,{headers:t.headers}))}async deleteIndex(e,t){var r=this;return r.handleOperation(async()=>await aS(r.fetch,`${r.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:r.headers})||{})}},aL=class extends aA{constructor(e,t={},r){super(e.replace(/\/$/,""),av(av({},aI),{},{"Content-Type":"application/json"},t),r,"vectors")}async putVectors(e){var t=this;if(e.vectors.length<1||e.vectors.length>500)throw Error("Vector batch size must be between 1 and 500 items");return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/PutVectors`,e,{headers:t.headers})||{})}async getVectors(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/GetVectors`,e,{headers:t.headers}))}async listVectors(e){var t=this;if(void 0!==e.segmentCount){if(e.segmentCount<1||e.segmentCount>16)throw Error("segmentCount must be between 1 and 16");if(void 0!==e.segmentIndex&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/ListVectors`,e,{headers:t.headers}))}async queryVectors(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/QueryVectors`,e,{headers:t.headers}))}async deleteVectors(e){var t=this;if(e.keys.length<1||e.keys.length>500)throw Error("Keys batch size must be between 1 and 500 items");return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/DeleteVectors`,e,{headers:t.headers})||{})}},aF=class extends aA{constructor(e,t={},r){super(e.replace(/\/$/,""),av(av({},aI),{},{"Content-Type":"application/json"},t),r,"vectors")}async createBucket(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}async getBucket(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/GetVectorBucket`,{vectorBucketName:e},{headers:t.headers}))}async listBuckets(e={}){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/ListVectorBuckets`,e,{headers:t.headers}))}async deleteBucket(e){var t=this;return t.handleOperation(async()=>await aS(t.fetch,`${t.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:t.headers})||{})}},aV=class extends aF{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new aB(this.url,this.headers,e,this.fetch)}async createBucket(e){return super.createBucket.call(this,e)}async getBucket(e){return super.getBucket.call(this,e)}async listBuckets(e={}){return super.listBuckets.call(this,e)}async deleteBucket(e){return super.deleteBucket.call(this,e)}},aB=class extends aU{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}async createIndex(e){return super.createIndex.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName}))}async listIndexes(e={}){return super.listIndexes.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName}))}async getIndex(e){return super.getIndex.call(this,this.vectorBucketName,e)}async deleteIndex(e){return super.deleteIndex.call(this,this.vectorBucketName,e)}index(e){return new aM(this.url,this.headers,this.vectorBucketName,e,this.fetch)}},aM=class extends aL{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}async putVectors(e){return super.putVectors.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async getVectors(e){return super.getVectors.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async listVectors(e={}){return super.listVectors.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async queryVectors(e){return super.queryVectors.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}async deleteVectors(e){return super.deleteVectors.call(this,av(av({},e),{},{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))}},aq=class extends a${constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new aP(this.url,this.headers,e,this.fetch)}get vectors(){return new aV(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new aD(this.url+"/iceberg",this.headers,this.fetch)}};let az="2.93.1",aK={"X-Client-Info":`gotrue-js/${az}`},aW="X-Supabase-Api-Version",aZ={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},aG=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i;class aH extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function aJ(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class aY extends aH{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}class aX extends aH{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class aQ extends aH{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class a0 extends aQ{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function a1(e){return aJ(e)&&"AuthSessionMissingError"===e.name}class a2 extends aQ{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class a4 extends aQ{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class a9 extends aQ{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class a5 extends aQ{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class a3 extends aQ{constructor(){super("PKCE code verifier not found in storage. This can happen if the auth flow was initiated in a different browser or device, or if the storage was cleared. For SSR frameworks (Next.js, SvelteKit, etc.), use @supabase/ssr on both the server and client to store the code verifier in cookies.","AuthPKCECodeVerifierMissingError",400,"pkce_code_verifier_not_found")}}class a8 extends aQ{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function a6(e){return aJ(e)&&"AuthRetryableFetchError"===e.name}class a7 extends aQ{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class ie extends aQ{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}let it="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),ir=" 	\n\r=".split(""),is=(()=>{let e=Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<ir.length;t+=1)e[ir[t].charCodeAt(0)]=-2;for(let t=0;t<it.length;t+=1)e[it[t].charCodeAt(0)]=t;return e})();function ia(e,t,r){if(null!==e)for(t.queue=t.queue<<8|e,t.queuedBits+=8;t.queuedBits>=6;)r(it[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6;else if(t.queuedBits>0)for(t.queue=t.queue<<6-t.queuedBits,t.queuedBits=6;t.queuedBits>=6;)r(it[t.queue>>t.queuedBits-6&63]),t.queuedBits-=6}function ii(e,t,r){let s=is[e];if(s>-1)for(t.queue=t.queue<<6|s,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else if(-2===s)return;else throw Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}function io(e){let t=[],r=e=>{t.push(String.fromCodePoint(e))},s={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},i=e=>{!function(e,t,r){if(0===t.utf8seq){if(e<=127)return r(e);for(let r=1;r<6;r+=1)if((e>>7-r&1)==0){t.utf8seq=r;break}if(2===t.utf8seq)t.codepoint=31&e;else if(3===t.utf8seq)t.codepoint=15&e;else if(4===t.utf8seq)t.codepoint=7&e;else throw Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|63&e,t.utf8seq-=1,0===t.utf8seq&&r(t.codepoint)}}(e,s,r)};for(let t=0;t<e.length;t+=1)ii(e.charCodeAt(t),a,i);return t.join("")}function il(e){let t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};for(let t=0;t<e.length;t+=1)ii(e.charCodeAt(t),r,s);return new Uint8Array(t)}function iu(e){let t=[],r={queue:0,queuedBits:0},s=e=>{t.push(e)};return e.forEach(e=>ia(e,r,s)),ia(null,r,s),t.join("")}let ic=()=>"undefined"!=typeof window&&"undefined"!=typeof document,id={tested:!1,writable:!1},ih=()=>{if(!ic())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(e){return!1}if(id.tested)return id.writable;let e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),id.tested=!0,id.writable=!0}catch(e){id.tested=!0,id.writable=!1}return id.writable},ip=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),im=e=>"object"==typeof e&&null!==e&&"status"in e&&"ok"in e&&"json"in e&&"function"==typeof e.json,ig=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},iy=async(e,t)=>{let r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch(e){return r}},iv=async(e,t)=>{await e.removeItem(t)};class i_{constructor(){this.promise=new i_.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}function ib(e){let t=e.split(".");if(3!==t.length)throw new ie("Invalid JWT structure");for(let e=0;e<t.length;e++)if(!aG.test(t[e]))throw new ie("JWT not in base64url format");return{header:JSON.parse(io(t[0])),payload:JSON.parse(io(t[1])),signature:il(t[2]),raw:{header:t[0],payload:t[1]}}}async function iw(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function ik(e){return("0"+e.toString(16)).substr(-2)}async function ix(e){let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")}async function iS(e){return"undefined"==typeof crypto||void 0===crypto.subtle||"undefined"==typeof TextEncoder?(console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e):btoa(await ix(e)).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function iT(e,t,r=!1){let s=function(){let e=new Uint32Array(56);if("undefined"==typeof crypto){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length,r="";for(let s=0;s<56;s++)r+=e.charAt(Math.floor(Math.random()*t));return r}return crypto.getRandomValues(e),Array.from(e,ik).join("")}(),a=s;r&&(a+="/PASSWORD_RECOVERY"),await ig(e,`${t}-code-verifier`,a);let i=await iS(s),n=s===i?"plain":"s256";return[i,n]}i_.promiseConstructor=Promise;let ij=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i,iE=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function iA(e){if(!iE.test(e))throw Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function iO(){return new Proxy({},{get:(e,t)=>{if("__isUserNotAvailableProxy"===t)return!0;if("symbol"==typeof t){let e=t.toString();if("Symbol(Symbol.toPrimitive)"===e||"Symbol(Symbol.toStringTag)"===e||"Symbol(util.inspect.custom)"===e)return}throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function iR(e){return JSON.parse(JSON.stringify(e))}let iC=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),iN=[502,503,504];async function iP(e){var t;let r,s;if(!im(e))throw new a8(iC(e),0);if(iN.includes(e.status))throw new a8(iC(e),e.status);try{r=await e.json()}catch(e){throw new aX(iC(e),e)}let a=function(e){let t=e.headers.get(aW);if(!t||!t.match(ij))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(e){return null}}(e);if(a&&a.getTime()>=aZ["2024-01-01"].timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?s=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(s=r.error_code),s){if("weak_password"===s)throw new a7(iC(r),e.status,(null==(t=r.weak_password)?void 0:t.reasons)||[]);else if("session_not_found"===s)throw new a0}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0))throw new a7(iC(r),e.status,r.weak_password.reasons);throw new aY(iC(r),e.status||500,s)}let iI=(e,t,r,s)=>{let a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),r))};async function i$(e,t,r,s){var a;let i=Object.assign({},null==s?void 0:s.headers);i[aW]||(i[aW]=aZ["2024-01-01"].name),(null==s?void 0:s.jwt)&&(i.Authorization=`Bearer ${s.jwt}`);let n=null!=(a=null==s?void 0:s.query)?a:{};(null==s?void 0:s.redirectTo)&&(n.redirect_to=s.redirectTo);let o=Object.keys(n).length?"?"+new URLSearchParams(n).toString():"",l=await iD(e,t,r+o,{headers:i,noResolveJson:null==s?void 0:s.noResolveJson},{},null==s?void 0:s.body);return(null==s?void 0:s.xform)?null==s?void 0:s.xform(l):{data:Object.assign({},l),error:null}}async function iD(e,t,r,s,a,i){let n,o=iI(t,s,a,i);try{n=await e(r,Object.assign({},o))}catch(e){throw console.error(e),new a8(iC(e),0)}if(n.ok||await iP(n),null==s?void 0:s.noResolveJson)return n;try{return await n.json()}catch(e){await iP(e)}}function iU(e){var t,r,s;let a=null;(s=e).access_token&&s.refresh_token&&s.expires_in&&(a=Object.assign({},e),e.expires_at||(a.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:a,user:null!=(t=e.user)?t:e},error:null}}function iL(e){let t=iU(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce((e,t)=>e&&"string"==typeof t,!0)&&(t.data.weak_password=e.weak_password),t}function iF(e){var t;return{data:{user:null!=(t=e.user)?t:e},error:null}}function iV(e){return{data:e,error:null}}function iB(e){let{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i}=e;return{data:{properties:{action_link:t,email_otp:r,hashed_token:s,redirect_to:a,verification_type:i},user:Object.assign({},(0,sE.Tt)(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]))},error:null}}function iM(e){return e}let iq=["global","local","others"];class iz{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=ip(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=iq[0]){if(0>iq.indexOf(t))throw Error(`@supabase/auth-js: Parameter scope must be one of ${iq.join(", ")}`);try{return await i$(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async inviteUserByEmail(e,t={}){try{return await i$(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:iF})}catch(e){if(aJ(e))return{data:{user:null},error:e};throw e}}async generateLink(e){try{let{options:t}=e,r=(0,sE.Tt)(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=null==r?void 0:r.newEmail,delete s.newEmail),await i$(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:iB,redirectTo:null==t?void 0:t.redirectTo})}catch(e){if(aJ(e))return{data:{properties:null,user:null},error:e};throw e}}async createUser(e){try{return await i$(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:iF})}catch(e){if(aJ(e))return{data:{user:null},error:e};throw e}}async listUsers(e){var t,r,s,a,i,n,o;try{let l={nextPage:null,lastPage:0,total:0},u=await i$(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(a=null==(s=null==e?void 0:e.perPage)?void 0:s.toString())?a:""},xform:iM});if(u.error)throw u.error;let c=await u.json(),d=null!=(i=u.headers.get("x-total-count"))?i:0,h=null!=(o=null==(n=u.headers.get("link"))?void 0:n.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(aJ(e))return{data:{users:[]},error:e};throw e}}async getUserById(e){iA(e);try{return await i$(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:iF})}catch(e){if(aJ(e))return{data:{user:null},error:e};throw e}}async updateUserById(e,t){iA(e);try{return await i$(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:iF})}catch(e){if(aJ(e))return{data:{user:null},error:e};throw e}}async deleteUser(e,t=!1){iA(e);try{return await i$(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:iF})}catch(e){if(aJ(e))return{data:{user:null},error:e};throw e}}async _listFactors(e){iA(e.userId);try{let{data:t,error:r}=await i$(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:r}}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _deleteFactor(e){iA(e.userId),iA(e.id);try{return{data:await i$(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _listOAuthClients(e){var t,r,s,a,i,n,o;try{let l={nextPage:null,lastPage:0,total:0},u=await i$(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:null!=(r=null==(t=null==e?void 0:e.page)?void 0:t.toString())?r:"",per_page:null!=(a=null==(s=null==e?void 0:e.perPage)?void 0:s.toString())?a:""},xform:iM});if(u.error)throw u.error;let c=await u.json(),d=null!=(i=u.headers.get("x-total-count"))?i:0,h=null!=(o=null==(n=u.headers.get("link"))?void 0:n.split(","))?o:[];return h.length>0&&(h.forEach(e=>{let t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),r=JSON.parse(e.split(";")[1].split("=")[1]);l[`${r}Page`]=t}),l.total=parseInt(d)),{data:Object.assign(Object.assign({},c),l),error:null}}catch(e){if(aJ(e))return{data:{clients:[]},error:e};throw e}}async _createOAuthClient(e){try{return await i$(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _getOAuthClient(e){try{return await i$(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _updateOAuthClient(e,t){try{return await i$(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _deleteOAuthClient(e){try{return await i$(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(e){if(aJ(e))return{data:null,error:e};throw e}}async _regenerateOAuthClientSecret(e){try{return await i$(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:e=>({data:e,error:null})})}catch(e){if(aJ(e))return{data:null,error:e};throw e}}}function iK(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}let iW={debug:!!(globalThis&&ih()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"))};class iZ extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class iG extends iZ{}async function iH(e,t,r){iW.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);let s=new globalThis.AbortController;return t>0&&setTimeout(()=>{s.abort(),iW.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async s=>{if(s){iW.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,s.name);try{return await r()}finally{iW.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,s.name)}}if(0===t)throw iW.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new iG(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(iW.debug)try{let e=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(e,null,"  "))}catch(e){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",e)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}))}function iJ(e){if(!/^0x[a-fA-F0-9]{40}$/.test(e))throw Error(`@supabase/auth-js: Address "${e}" is invalid.`);return e.toLowerCase()}class iY extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=null!=(a=null!=s?s:r instanceof Error?r.name:void 0)?a:"Unknown Error",this.code=t}}class iX extends iY{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}class iQ{createNewAbortSignal(){if(this.controller){let e=Error("Cancelling existing WebAuthn API call for new one");e.name="AbortError",this.controller.abort(e)}let e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){let e=Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}let i0=new iQ;function i1(e){return"localhost"===e||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(e)}function i2(){var e,t;return!!(ic()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&"function"==typeof(null==(e=null==navigator?void 0:navigator.credentials)?void 0:e.create)&&"function"==typeof(null==(t=null==navigator?void 0:navigator.credentials)?void 0:t.get))}async function i4(e){try{let t=await navigator.credentials.create(e);if(!t)return{data:null,error:new iX("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new iX("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){var r,s,a;let{publicKey:i}=t;if(!i)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new iY({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("ConstraintError"===e.name){if((null==(r=i.authenticatorSelection)?void 0:r.requireResidentKey)===!0)return new iY({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:e});else if("conditional"===t.mediation&&(null==(s=i.authenticatorSelection)?void 0:s.userVerification)==="required")return new iY({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:e});else if((null==(a=i.authenticatorSelection)?void 0:a.userVerification)==="required")return new iY({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:e})}else if("InvalidStateError"===e.name)return new iY({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:e});else if("NotAllowedError"===e.name)return new iY({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("NotSupportedError"===e.name)return new iY(0===i.pubKeyCredParams.filter(e=>"public-key"===e.type).length?{message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:e}:{message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!i1(t))return new iY({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(i.rp.id!==t)return new iY({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("TypeError"===e.name){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new iY({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:e})}else if("UnknownError"===e.name)return new iY({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new iY({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}async function i9(e){try{let t=await navigator.credentials.get(e);if(!t)return{data:null,error:new iX("Empty credential response",t)};if(!(t instanceof PublicKeyCredential))return{data:null,error:new iX("Browser returned unexpected credential type",t)};return{data:t,error:null}}catch(t){return{data:null,error:function({error:e,options:t}){let{publicKey:r}=t;if(!r)throw Error("options was missing required publicKey property");if("AbortError"===e.name){if(t.signal instanceof AbortSignal)return new iY({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:e})}else if("NotAllowedError"===e.name)return new iY({message:e.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e});else if("SecurityError"===e.name){let t=window.location.hostname;if(!i1(t))return new iY({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:e});if(r.rpId!==t)return new iY({message:`The RP ID "${r.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:e})}else if("UnknownError"===e.name)return new iY({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:e});return new iY({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:e})}({error:t,options:e})}}}let i5={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},i3={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function i8(...e){let t=e=>null!==e&&"object"==typeof e&&!Array.isArray(e),r=e=>e instanceof ArrayBuffer||ArrayBuffer.isView(e),s={};for(let a of e)if(a)for(let e in a){let i=a[e];if(void 0!==i)if(Array.isArray(i))s[e]=i;else if(r(i))s[e]=i;else if(t(i)){let r=s[e];t(r)?s[e]=i8(r,i):s[e]=i8(i)}else s[e]=i}return s}class i6{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{var i,n,o,l;let{data:u,error:c}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!u)return{data:null,error:c};let d=null!=s?s:i0.createNewAbortSignal();if("create"===u.webauthn.type){let{user:e}=u.webauthn.credential_options.publicKey;e.name||(e.name=`${e.id}:${r}`),e.displayName||(e.displayName=e.name)}switch(u.webauthn.type){case"create":{let t=(i=u.webauthn.credential_options.publicKey,n=null==a?void 0:a.create,i8(i5,i,n||{})),{data:r,error:s}=await i4({publicKey:t,signal:d});if(r)return{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:r}},error:null};return{data:null,error:s}}case"request":{let t=(o=u.webauthn.credential_options.publicKey,l=null==a?void 0:a.request,i8(i3,o,l||{})),{data:r,error:s}=await i9(Object.assign(Object.assign({},u.webauthn.credential_options),{publicKey:t,signal:d}));if(r)return{data:{factorId:e,challengeId:u.id,webauthn:{type:u.webauthn.type,credential_response:r}},error:null};return{data:null,error:s}}}}catch(e){if(aJ(e))return{data:null,error:e};return{data:null,error:new aX("Unexpected error in challenge",e)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new aH("rpId is required for WebAuthn authentication")};try{if(!i2())return{data:null,error:new aX("Browser does not support WebAuthn",null)};let{data:i,error:n}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!i)return{data:null,error:n};let{webauthn:o}=i;return this._verify({factorId:e,challengeId:i.challengeId,webauthn:{type:o.type,rpId:t,rpOrigins:r,credential_response:o.credential_response}})}catch(e){if(aJ(e))return{data:null,error:e};return{data:null,error:new aX("Unexpected error in authenticate",e)}}}async _register({friendlyName:e,webauthn:{rpId:t="undefined"!=typeof window?window.location.hostname:void 0,rpOrigins:r="undefined"!=typeof window?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new aH("rpId is required for WebAuthn registration")};try{if(!i2())return{data:null,error:new aX("Browser does not support WebAuthn",null)};let{data:i,error:n}=await this._enroll({friendlyName:e});if(!i)return await this.client.mfa.listFactors().then(t=>{var r;return null==(r=t.data)?void 0:r.all.find(t=>"webauthn"===t.factor_type&&t.friendly_name===e&&"unverified"!==t.status)}).then(e=>e?this.client.mfa.unenroll({factorId:null==e?void 0:e.id}):void 0),{data:null,error:n};let{data:o,error:l}=await this._challenge({factorId:i.id,friendlyName:i.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});if(!o)return{data:null,error:l};return this._verify({factorId:i.id,challengeId:o.challengeId,webauthn:{rpId:t,rpOrigins:r,type:o.webauthn.type,credential_response:o.webauthn.credential_response}})}catch(e){if(aJ(e))return{data:null,error:e};return{data:null,error:new aX("Unexpected error in register",e)}}}}if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}let i7={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:aK,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1,lockAcquireTimeout:1e4};async function ne(e,t,r){return await r()}let nt={};class nr{get jwks(){var e,t;return null!=(t=null==(e=nt[this.storageKey])?void 0:e.jwks)?t:{keys:[]}}set jwks(e){nt[this.storageKey]=Object.assign(Object.assign({},nt[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return null!=(t=null==(e=nt[this.storageKey])?void 0:e.cachedAt)?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){nt[this.storageKey]=Object.assign(Object.assign({},nt[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.autoRefreshTickTimeout=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;let a=Object.assign(Object.assign({},i7),e);if(this.storageKey=a.storageKey,this.instanceID=null!=(t=nr.nextInstanceID[this.storageKey])?t:0,nr.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,"function"==typeof a.debug&&(this.logger=a.debug),this.instanceID>0&&ic()){let e=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(e),this.logDebugMessages&&console.trace(e)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new iz({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=ip(a.fetch),this.lock=a.lock||ne,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,this.lockAcquireTimeout=a.lockAcquireTimeout,a.lock?this.lock=a.lock:this.persistSession&&ic()&&(null==(r=null==globalThis?void 0:globalThis.navigator)?void 0:r.locks)?this.lock=iH:this.lock=ne,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new i6(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this),listGrants:this._listOAuthGrants.bind(this),revokeGrant:this._revokeOAuthGrant.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:ih()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=iK(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=iK(this.memoryStorage)),ic()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(e){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",e)}null==(s=this.broadcastChannel)||s.addEventListener("message",async e=>{this._debug("received broadcast notification from other tab or client",e);try{await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}catch(e){this._debug("#broadcastChannel","error",e)}})}this.initialize().catch(e=>{this._debug("#initialize()","error",e)})}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${az}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(this.lockAcquireTimeout,async()=>await this._initialize()))()),await this.initializePromise}async _initialize(){var e;try{let t={},r="none";if(ic()&&(t=function(e){let t={},r=new URL(e);if(r.hash&&"#"===r.hash[0])try{new URLSearchParams(r.hash.substring(1)).forEach((e,r)=>{t[r]=e})}catch(e){}return r.searchParams.forEach((e,r)=>{t[r]=e}),t}(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),ic()&&this.detectSessionInUrl&&"none"!==r){let{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),aJ(a)&&"AuthImplicitGrantRedirectError"===a.name){let t=null==(e=a.details)?void 0:e.code}return{error:a}}let{session:i,redirectType:n}=s;return this._debug("#_initialize()","detected session in URL",i,"redirect type",n),await this._saveSession(i),setTimeout(async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(e){if(aJ(e))return this._returnResult({error:e});return this._returnResult({error:new aX("Unexpected error during initialization",e)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{let{data:a,error:i}=await i$(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!=(r=null==(t=null==e?void 0:e.options)?void 0:t.data)?r:{},gotrue_meta_security:{captcha_token:null==(s=null==e?void 0:e.options)?void 0:s.captchaToken}},xform:iU});if(i||!a)return this._returnResult({data:{user:null,session:null},error:i});let n=a.session,o=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",n)),this._returnResult({data:{user:o,session:n},error:null})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signUp(e){var t,r,s;try{let a;if("email"in e){let{email:r,password:s,options:i}=e,n=null,o=null;"pkce"===this.flowType&&([n,o]=await iT(this.storage,this.storageKey)),a=await i$(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:r,password:s,data:null!=(t=null==i?void 0:i.data)?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:o},xform:iU})}else if("phone"in e){let{phone:t,password:i,options:n}=e;a=await i$(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!=(r=null==n?void 0:n.data)?r:{},channel:null!=(s=null==n?void 0:n.channel)?s:"sms",gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:iU})}else throw new a4("You must provide either an email or phone number and a password");let{data:i,error:n}=a;if(n||!i)return await iv(this.storage,`${this.storageKey}-code-verifier`),this._returnResult({data:{user:null,session:null},error:n});let o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithPassword(e){try{let t;if("email"in e){let{email:r,password:s,options:a}=e;t=await i$(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:iL})}else if("phone"in e){let{phone:r,password:s,options:a}=e;t=await i$(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:r,password:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:iL})}else throw new a4("You must provide either an email or phone number and a password");let{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){let e=new a2;return this._returnResult({data:{user:null,session:null},error:e})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null==(t=e.options)?void 0:t.redirectTo,scopes:null==(r=e.options)?void 0:r.scopes,queryParams:null==(s=e.options)?void 0:s.queryParams,skipBrowserRedirect:null==(a=e.options)?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(this.lockAcquireTimeout,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){let{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,i,n,o,l,u,c,d,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let c,{chain:d,wallet:m,statement:g,options:y}=e;if(ic())if("object"==typeof m)c=m;else{let e=window;if("ethereum"in e&&"object"==typeof e.ethereum&&"request"in e.ethereum&&"function"==typeof e.ethereum.request)c=e.ethereum;else throw Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof m||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");c=m}let v=new URL(null!=(t=null==y?void 0:y.url)?t:window.location.href),_=await c.request({method:"eth_requestAccounts"}).then(e=>e).catch(()=>{throw Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!_||0===_.length)throw Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");let b=iJ(_[0]),w=null==(r=null==y?void 0:y.signInWithEthereum)?void 0:r.chainId;w||(w=parseInt(await c.request({method:"eth_chainId"}),16)),p=function(e){var t;let{chainId:r,domain:s,expirationTime:a,issuedAt:i=new Date,nonce:n,notBefore:o,requestId:l,resources:u,scheme:c,uri:d,version:h}=e;if(!Number.isInteger(r))throw Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${r}`);if(!s)throw Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(n&&n.length<8)throw Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${n}`);if(!d)throw Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if("1"!==h)throw Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${h}`);if(null==(t=e.statement)?void 0:t.includes("\n"))throw Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${e.statement}`);let p=iJ(e.address),f=c?`${c}://${s}`:s,m=e.statement?`${e.statement}
`:"",g=`${f} wants you to sign in with your Ethereum account:
${p}

${m}`,y=`URI: ${d}
Version: ${h}
Chain ID: ${r}${n?`
Nonce: ${n}`:""}
Issued At: ${i.toISOString()}`;if(a&&(y+=`
Expiration Time: ${a.toISOString()}`),o&&(y+=`
Not Before: ${o.toISOString()}`),l&&(y+=`
Request ID: ${l}`),u){let e="\nResources:";for(let t of u){if(!t||"string"!=typeof t)throw Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${t}`);e+=`
- ${t}`}y+=e}return`${g}
${y}`}({domain:v.host,address:b,statement:g,uri:v.href,version:"1",chainId:w,nonce:null==(s=null==y?void 0:y.signInWithEthereum)?void 0:s.nonce,issuedAt:null!=(i=null==(a=null==y?void 0:y.signInWithEthereum)?void 0:a.issuedAt)?i:new Date,expirationTime:null==(n=null==y?void 0:y.signInWithEthereum)?void 0:n.expirationTime,notBefore:null==(o=null==y?void 0:y.signInWithEthereum)?void 0:o.notBefore,requestId:null==(l=null==y?void 0:y.signInWithEthereum)?void 0:l.requestId,resources:null==(u=null==y?void 0:y.signInWithEthereum)?void 0:u.resources}),f=await c.request({method:"personal_sign",params:[(h=p,"0x"+Array.from(new TextEncoder().encode(h),e=>e.toString(16).padStart(2,"0")).join("")),b]})}try{let{data:t,error:r}=await i$(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:p,signature:f},(null==(c=e.options)?void 0:c.captchaToken)?{gotrue_meta_security:{captcha_token:null==(d=e.options)?void 0:d.captchaToken}}:null),xform:iU});if(r)throw r;if(!t||!t.session||!t.user){let e=new a2;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSolana(e){var t,r,s,a,i,n,o,l,u,c,d,h;let p,f;if("message"in e)p=e.message,f=e.signature;else{let d,{chain:h,wallet:m,statement:g,options:y}=e;if(ic())if("object"==typeof m)d=m;else{let e=window;if("solana"in e&&"object"==typeof e.solana&&("signIn"in e.solana&&"function"==typeof e.solana.signIn||"signMessage"in e.solana&&"function"==typeof e.solana.signMessage))d=e.solana;else throw Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if("object"!=typeof m||!(null==y?void 0:y.url))throw Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");d=m}let v=new URL(null!=(t=null==y?void 0:y.url)?t:window.location.href);if("signIn"in d&&d.signIn){let e,t=await d.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},null==y?void 0:y.signInWithSolana),{version:"1",domain:v.host,uri:v.href}),g?{statement:g}:null));if(Array.isArray(t)&&t[0]&&"object"==typeof t[0])e=t[0];else if(t&&"object"==typeof t&&"signedMessage"in t&&"signature"in t)e=t;else throw Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in e&&"signature"in e&&("string"==typeof e.signedMessage||e.signedMessage instanceof Uint8Array)&&e.signature instanceof Uint8Array)p="string"==typeof e.signedMessage?e.signedMessage:new TextDecoder().decode(e.signedMessage),f=e.signature;else throw Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in d)||"function"!=typeof d.signMessage||!("publicKey"in d)||"object"!=typeof d||!d.publicKey||!("toBase58"in d.publicKey)||"function"!=typeof d.publicKey.toBase58)throw Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");p=[`${v.host} wants you to sign in with your Solana account:`,d.publicKey.toBase58(),...g?["",g,""]:[""],"Version: 1",`URI: ${v.href}`,`Issued At: ${null!=(s=null==(r=null==y?void 0:y.signInWithSolana)?void 0:r.issuedAt)?s:new Date().toISOString()}`,...(null==(a=null==y?void 0:y.signInWithSolana)?void 0:a.notBefore)?[`Not Before: ${y.signInWithSolana.notBefore}`]:[],...(null==(i=null==y?void 0:y.signInWithSolana)?void 0:i.expirationTime)?[`Expiration Time: ${y.signInWithSolana.expirationTime}`]:[],...(null==(n=null==y?void 0:y.signInWithSolana)?void 0:n.chainId)?[`Chain ID: ${y.signInWithSolana.chainId}`]:[],...(null==(o=null==y?void 0:y.signInWithSolana)?void 0:o.nonce)?[`Nonce: ${y.signInWithSolana.nonce}`]:[],...(null==(l=null==y?void 0:y.signInWithSolana)?void 0:l.requestId)?[`Request ID: ${y.signInWithSolana.requestId}`]:[],...(null==(c=null==(u=null==y?void 0:y.signInWithSolana)?void 0:u.resources)?void 0:c.length)?["Resources",...y.signInWithSolana.resources.map(e=>`- ${e}`)]:[]].join("\n");let e=await d.signMessage(new TextEncoder().encode(p),"utf8");if(!e||!(e instanceof Uint8Array))throw Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");f=e}}try{let{data:t,error:r}=await i$(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:p,signature:iu(f)},(null==(d=e.options)?void 0:d.captchaToken)?{gotrue_meta_security:{captcha_token:null==(h=e.options)?void 0:h.captchaToken}}:null),xform:iU});if(r)throw r;if(!t||!t.session||!t.user){let e=new a2;return this._returnResult({data:{user:null,session:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign({},t),error:r})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _exchangeCodeForSession(e){let t=await iy(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(null!=t?t:"").split("/");try{if(!r&&"pkce"===this.flowType)throw new a3;let{data:t,error:a}=await i$(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:iU});if(await iv(this.storage,`${this.storageKey}-code-verifier`),a)throw a;if(!t||!t.session||!t.user){let e=new a2;return this._returnResult({data:{user:null,session:null,redirectType:null},error:e})}return t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),this._returnResult({data:Object.assign(Object.assign({},t),{redirectType:null!=s?s:null}),error:a})}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:{user:null,session:null,redirectType:null},error:e});throw e}}async signInWithIdToken(e){try{let{options:t,provider:r,token:s,access_token:a,nonce:i}=e,{data:n,error:o}=await i$(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:iU});if(o)return this._returnResult({data:{user:null,session:null},error:o});if(!n||!n.session||!n.user){let e=new a2;return this._returnResult({data:{user:null,session:null},error:e})}return n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),this._returnResult({data:n,error:o})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithOtp(e){var t,r,s,a,i;try{if("email"in e){let{email:s,options:a}=e,i=null,n=null;"pkce"===this.flowType&&([i,n]=await iT(this.storage,this.storageKey));let{error:o}=await i$(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:s,data:null!=(t=null==a?void 0:a.data)?t:{},create_user:null==(r=null==a?void 0:a.shouldCreateUser)||r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:n},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}if("phone"in e){let{phone:t,options:r}=e,{data:n,error:o}=await i$(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!=(s=null==r?void 0:r.data)?s:{},create_user:null==(a=null==r?void 0:r.shouldCreateUser)||a,gotrue_meta_security:{captcha_token:null==r?void 0:r.captchaToken},channel:null!=(i=null==r?void 0:r.channel)?i:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o})}throw new a4("You must provide either an email or phone number.")}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=null==(t=e.options)?void 0:t.redirectTo,a=null==(r=e.options)?void 0:r.captchaToken);let{data:i,error:n}=await i$(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:iU});if(n)throw n;if(!i)throw Error("An error occurred on token verification.");let o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),this._returnResult({data:{user:l,session:o},error:null})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async signInWithSSO(e){var t,r,s,a,i;try{let n=null,o=null;"pkce"===this.flowType&&([n,o]=await iT(this.storage,this.storageKey));let l=await i$(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!=(r=null==(t=e.options)?void 0:t.redirectTo)?r:void 0}),(null==(s=null==e?void 0:e.options)?void 0:s.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:n,code_challenge_method:o}),headers:this.headers,xform:iV});return(null==(a=l.data)?void 0:a.url)&&ic()&&!(null==(i=e.options)?void 0:i.skipBrowserRedirect)&&window.location.assign(l.data.url),this._returnResult(l)}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:null,error:e});throw e}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new a0;let{error:s}=await i$(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{let t=`${this.url}/resend`;if("email"in e){let{email:r,type:s,options:a}=e,{error:i}=await i$(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:i})}if("phone"in e){let{phone:r,type:s,options:a}=e,{data:i,error:n}=await i$(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:n})}throw new a4("You must provide either an email or phone number and a type")}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async getSession(){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>this._useSession(async e=>e))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){let e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch(e){}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;let e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(e){}})()),await e;this.pendingInLock.length;){let e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{let t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",Error().stack);try{let t=null,r=await iy(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),null!==r&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};let s=!!t.expires_at&&1e3*t.expires_at-Date.now()<9e4;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",t.expires_at),!s){if(this.userStorage){let e=await iy(this.userStorage,this.storageKey+"-user");(null==e?void 0:e.user)?t.user=e.user:t.user=iO()}if(this.storage.isServer&&t.user&&!t.user.__isUserNotAvailableProxy){var e;let r={value:this.suppressGetSessionWarning};t.user=(e=t.user,new Proxy(e,{get:(e,t,s)=>{if("__isInsecureUserWarningProxy"===t)return!0;if("symbol"==typeof t){let r=t.toString();if("Symbol(Symbol.toPrimitive)"===r||"Symbol(Symbol.toStringTag)"===r||"Symbol(util.inspect.custom)"===r||"Symbol(nodejs.util.inspect.custom)"===r)return Reflect.get(e,t,s)}return r.value||"string"!=typeof t||(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),r.value=!0),Reflect.get(e,t,s)}})),r.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:t},error:null}}let{data:a,error:i}=await this._callRefreshToken(t.refresh_token);if(i)return this._returnResult({data:{session:null},error:i});return this._returnResult({data:{session:a},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;let t=await this._acquireLock(this.lockAcquireTimeout,async()=>await this._getUser());return t.data.user&&(this.suppressGetSessionWarning=!0),t}async _getUser(e){try{if(e)return await i$(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:iF});return await this._useSession(async e=>{var t,r,s;let{data:a,error:i}=e;if(i)throw i;return(null==(t=a.session)?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await i$(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!=(s=null==(r=a.session)?void 0:r.access_token)?s:void 0,xform:iF}):{data:{user:null},error:new a0}})}catch(e){if(aJ(e))return a1(e)&&(await this._removeSession(),await iv(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:e});throw e}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{let{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new a0;let i=s.session,n=null,o=null;"pkce"===this.flowType&&null!=e.email&&([n,o]=await iT(this.storage,this.storageKey));let{data:l,error:u}=await i$(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:n,code_challenge_method:o}),jwt:i.access_token,xform:iF});if(u)throw u;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),this._returnResult({data:{user:i.user},error:null})})}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:{user:null},error:e});throw e}}async setSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new a0;let t=Date.now()/1e3,r=t,s=!0,a=null,{payload:i}=ib(e.access_token);if(i.exp&&(s=(r=i.exp)<=t),s){let{data:t,error:r}=await this._callRefreshToken(e.refresh_token);if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!t)return{data:{user:null,session:null},error:null};a=t}else{let{data:s,error:i}=await this._getUser(e.access_token);if(i)return this._returnResult({data:{user:null,session:null},error:i});a={access_token:e.access_token,refresh_token:e.refresh_token,user:s.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(e){if(aJ(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){let{data:s,error:a}=t;if(a)throw a;e=null!=(r=s.session)?r:void 0}if(!(null==e?void 0:e.refresh_token))throw new a0;let{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(e){if(aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async _getSessionFromURL(e,t){try{if(!ic())throw new a9("No browser detected.");if(e.error||e.error_description||e.error_code)throw new a9(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new a5("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new a9("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new a5("No code detected.");let{data:t,error:r}=await this._exchangeCodeForSession(e.code);if(r)throw r;let s=new URL(window.location.href);return s.searchParams.delete("code"),window.history.replaceState(window.history.state,"",s.toString()),{data:{session:t.session,redirectType:null},error:null}}let{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:i,expires_in:n,expires_at:o,token_type:l}=e;if(!a||!n||!i||!l)throw new a9("No session defined in URL");let u=Math.round(Date.now()/1e3),c=parseInt(n),d=u+c;o&&(d=parseInt(o));let h=d-u;1e3*h<=3e4&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${c}s`);let p=d-c;u-p>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",p,d,u):u-p<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",p,d,u);let{data:f,error:m}=await this._getUser(a);if(m)throw m;let g={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:c,expires_at:d,refresh_token:i,token_type:l,user:f.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:g,redirectType:e.type},error:null})}catch(e){if(aJ(e))return this._returnResult({data:{session:null,redirectType:null},error:e});throw e}}_isImplicitGrantCallback(e){return"function"==typeof this.detectSessionInUrl?this.detectSessionInUrl(new URL(window.location.href),e):!!(e.access_token||e.error_description)}async _isPKCECallback(e){let t=await iy(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;let{data:s,error:a}=t;if(a&&!a1(a))return this._returnResult({error:a});let i=null==(r=s.session)?void 0:r.access_token;if(i){let{error:t}=await this.admin.signOut(i,e);if(t&&!(aJ(t)&&"AuthApiError"===t.name&&(404===t.status||401===t.status||403===t.status)||a1(t)))return this._returnResult({error:t})}return"others"!==e&&(await this._removeSession(),await iv(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){let t=Symbol("auth-callback"),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>{await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{this._emitInitialSession(t)})})(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{let{data:{session:s},error:a}=t;if(a)throw a;await (null==(r=this.stateChangeEmitters.get(e))?void 0:r.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",e,"session",s)}catch(t){await (null==(s=this.stateChangeEmitters.get(e))?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",t),console.error(t)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;"pkce"===this.flowType&&([r,s]=await iT(this.storage,this.storageKey,!0));try{return await i$(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:null,error:e});throw e}}async getUserIdentities(){var e;try{let{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:null!=(e=t.user.identities)?e:[]},error:null})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{let{data:r,error:s}=await this._useSession(async t=>{var r,s,a,i,n;let{data:o,error:l}=t;if(l)throw l;let u=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null==(r=e.options)?void 0:r.redirectTo,scopes:null==(s=e.options)?void 0:s.scopes,queryParams:null==(a=e.options)?void 0:a.queryParams,skipBrowserRedirect:!0});return await i$(this.fetch,"GET",u,{headers:this.headers,jwt:null!=(n=null==(i=o.session)?void 0:i.access_token)?n:void 0})});if(s)throw s;return!ic()||(null==(t=e.options)?void 0:t.skipBrowserRedirect)||window.location.assign(null==r?void 0:r.url),this._returnResult({data:{provider:e.provider,url:null==r?void 0:r.url},error:null})}catch(t){if(aJ(t))return this._returnResult({data:{provider:e.provider,url:null},error:t});throw t}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{let{error:s,data:{session:a}}=t;if(s)throw s;let{options:i,provider:n,token:o,access_token:l,nonce:u}=e,{data:c,error:d}=await i$(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:null!=(r=null==a?void 0:a.access_token)?r:void 0,body:{provider:n,id_token:o,access_token:l,nonce:u,link_identity:!0,gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken}},xform:iU});if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user)return this._returnResult({data:{user:null,session:null},error:new a2});return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("USER_UPDATED",c.session)),this._returnResult({data:c,error:d})}catch(e){if(await iv(this.storage,`${this.storageKey}-code-verifier`),aJ(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;let{data:a,error:i}=t;if(i)throw i;return await i$(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!=(s=null==(r=a.session)?void 0:r.access_token)?s:void 0})})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _refreshAccessToken(e){let t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{var r,s;let a=Date.now();return await (r=async r=>(r>0&&await iw(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await i$(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:iU})),s=(e,t)=>{let r=200*Math.pow(2,e);return t&&a6(t)&&Date.now()+r-a<3e4},new Promise((e,t)=>{(async()=>{for(let a=0;a<1/0;a++)try{let t=await r(a);if(!s(a,null,t))return void e(t)}catch(e){if(!s(a,e))return void t(e)}})()}))}catch(e){if(this._debug(t,"error",e),aJ(e))return this._returnResult({data:{session:null,user:null},error:e});throw e}finally{this._debug(t,"end")}}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){let r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),ic()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;let r="#_recoverAndRefresh()";this._debug(r,"begin");try{let s=await iy(this.storage,this.storageKey);if(s&&this.userStorage){let t=await iy(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!t&&(t={user:s.user},await ig(this.userStorage,this.storageKey+"-user",t)),s.user=null!=(e=null==t?void 0:t.user)?e:iO()}else if(s&&!s.user&&!s.user){let e=await iy(this.storage,this.storageKey+"-user");e&&(null==e?void 0:e.user)?(s.user=e.user,await iv(this.storage,this.storageKey+"-user"),await ig(this.storage,this.storageKey,s)):s.user=iO()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),null!==s&&await this._removeSession();return}let a=(null!=(t=s.expires_at)?t:1/0)*1e3-Date.now()<9e4;if(this._debug(r,`session has${a?"":" not"} expired with margin of 90000s`),a){if(this.autoRefreshToken&&s.refresh_token){let{error:e}=await this._callRefreshToken(s.refresh_token);e&&(console.error(e),a6(e)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else if(s.user&&!0===s.user.__isUserNotAvailableProxy)try{let{data:e,error:t}=await this._getUser(s.access_token);!t&&(null==e?void 0:e.user)?(s.user=e.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(e){console.error("Error getting user data:",e),this._debug(r,"error getting user data, skipping SIGNED_IN notification",e)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(e){this._debug(r,"error",e),console.error(e);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new a0;if(this.refreshingDeferred)return this.refreshingDeferred.promise;let s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new i_;let{data:t,error:r}=await this._refreshAccessToken(e);if(r)throw r;if(!t.session)throw new a0;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);let s={data:t.session,error:null};return this.refreshingDeferred.resolve(s),s}catch(e){if(this._debug(s,"error",e),aJ(e)){let r={data:null,error:e};return a6(e)||await this._removeSession(),null==(t=this.refreshingDeferred)||t.resolve(r),r}throw null==(r=this.refreshingDeferred)||r.reject(e),e}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){let s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});let s=[],a=Array.from(this.stateChangeEmitters.values()).map(async r=>{try{await r.callback(e,t)}catch(e){s.push(e)}});if(await Promise.all(a),s.length>0){for(let e=0;e<s.length;e+=1)console.error(s[e]);throw s[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await iv(this.storage,`${this.storageKey}-code-verifier`);let t=Object.assign({},e),r=t.user&&!0===t.user.__isUserNotAvailableProxy;if(this.userStorage){!r&&t.user&&await ig(this.userStorage,this.storageKey+"-user",{user:t.user});let e=Object.assign({},t);delete e.user;let s=iR(e);await ig(this.storage,this.storageKey,s)}else{let e=iR(t);await ig(this.storage,this.storageKey,e)}}async _removeSession(){this._debug("#_removeSession()"),this.suppressGetSessionWarning=!1,await iv(this.storage,this.storageKey),await iv(this.storage,this.storageKey+"-code-verifier"),await iv(this.storage,this.storageKey+"-user"),this.userStorage&&await iv(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");let e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ic()&&(null==window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(e){console.error("removing visibilitychange callback failed",e)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");let e=setInterval(()=>this._autoRefreshTokenTick(),3e4);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e);let t=setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0);this.autoRefreshTickTimeout=t,t&&"object"==typeof t&&"function"==typeof t.unref?t.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(t)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");let e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e);let t=this.autoRefreshTickTimeout;this.autoRefreshTickTimeout=null,t&&clearTimeout(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{let e=Date.now();try{return await this._useSession(async t=>{let{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");let s=Math.floor((1e3*r.expires_at-e)/3e4);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),s<=3&&await this._callRefreshToken(r.refresh_token)})}catch(e){console.error("Auto refresh tick failed with error. This is likely a transient error.",e)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof iZ)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ic()||!(null==window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>{try{await this._onVisibilityChanged(!1)}catch(e){this._debug("#visibilityChangedCallback","error",e)}},null==window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){let t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(this.lockAcquireTimeout,async()=>{if("visible"!==document.visibilityState)return void this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");await this._recoverAndRefresh()}))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){let s=[`provider=${encodeURIComponent(t)}`];if((null==r?void 0:r.redirectTo)&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),(null==r?void 0:r.scopes)&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),"pkce"===this.flowType){let[e,t]=await iT(this.storage,this.storageKey),r=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});s.push(r.toString())}if(null==r?void 0:r.queryParams){let e=new URLSearchParams(r.queryParams);s.push(e.toString())}return(null==r?void 0:r.skipBrowserRedirect)&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;let{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await i$(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token})})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;let{data:a,error:i}=t;if(i)return this._returnResult({data:null,error:i});let n=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:"totp"===e.factorType?{issuer:e.issuer}:{}),{data:o,error:l}=await i$(this.fetch,"POST",`${this.url}/factors`,{body:n,headers:this.headers,jwt:null==(r=null==a?void 0:a.session)?void 0:r.access_token});return l?this._returnResult({data:null,error:l}):("totp"===e.factorType&&"totp"===o.type&&(null==(s=null==o?void 0:o.totp)?void 0:s.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),this._returnResult({data:o,error:null}))})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _verify(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r,s,a;let{data:i,error:n}=t;if(n)return this._returnResult({data:null,error:n});let o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:"create"===e.webauthn.type?(s=e.webauthn.credential_response,"toJSON"in s&&"function"==typeof s.toJSON?s.toJSON():{id:s.id,rawId:s.id,response:{attestationObject:iu(new Uint8Array(s.response.attestationObject)),clientDataJSON:iu(new Uint8Array(s.response.clientDataJSON))},type:"public-key",clientExtensionResults:s.getClientExtensionResults(),authenticatorAttachment:null!=(a=s.authenticatorAttachment)?a:void 0}):function(e){var t;if("toJSON"in e&&"function"==typeof e.toJSON)return e.toJSON();let r=e.getClientExtensionResults(),s=e.response;return{id:e.id,rawId:e.id,response:{authenticatorData:iu(new Uint8Array(s.authenticatorData)),clientDataJSON:iu(new Uint8Array(s.clientDataJSON)),signature:iu(new Uint8Array(s.signature)),userHandle:s.userHandle?iu(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:null!=(t=e.authenticatorAttachment)?t:void 0}}(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:u}=await i$(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:null==(r=null==i?void 0:i.session)?void 0:r.access_token});return u?this._returnResult({data:null,error:u}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:u}))})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}})}async _challenge(e){return this._acquireLock(this.lockAcquireTimeout,async()=>{try{return await this._useSession(async t=>{var r;let{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});let i=await i$(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:null==(r=null==s?void 0:s.session)?void 0:r.access_token});if(i.error)return i;let{data:n}=i;if("webauthn"!==n.type)return{data:n,error:null};switch(n.webauthn.type){case"create":return{data:Object.assign(Object.assign({},n),{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_options:Object.assign(Object.assign({},n.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential creation options are required");if("undefined"!=typeof PublicKeyCredential&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseCreationOptionsFromJSON)return PublicKeyCredential.parseCreationOptionsFromJSON(e);let{challenge:t,user:r,excludeCredentials:s}=e,a=(0,sE.Tt)(e,["challenge","user","excludeCredentials"]),i=il(t).buffer,n=Object.assign(Object.assign({},r),{id:il(r.id).buffer}),o=Object.assign(Object.assign({},a),{challenge:i,user:n});if(s&&s.length>0){o.excludeCredentials=Array(s.length);for(let e=0;e<s.length;e++){let t=s[e];o.excludeCredentials[e]=Object.assign(Object.assign({},t),{id:il(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return o}(n.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},n),{webauthn:Object.assign(Object.assign({},n.webauthn),{credential_options:Object.assign(Object.assign({},n.webauthn.credential_options),{publicKey:function(e){if(!e)throw Error("Credential request options are required");if("undefined"!=typeof PublicKeyCredential&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&"function"==typeof PublicKeyCredential.parseRequestOptionsFromJSON)return PublicKeyCredential.parseRequestOptionsFromJSON(e);let{challenge:t,allowCredentials:r}=e,s=(0,sE.Tt)(e,["challenge","allowCredentials"]),a=il(t).buffer,i=Object.assign(Object.assign({},s),{challenge:a});if(r&&r.length>0){i.allowCredentials=Array(r.length);for(let e=0;e<r.length;e++){let t=r[e];i.allowCredentials[e]=Object.assign(Object.assign({},t),{id:il(t.id).buffer,type:t.type||"public-key",transports:t.transports})}}return i}(n.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}})}async _challengeAndVerify(e){let{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;let{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};let s={all:[],phone:[],totp:[],webauthn:[]};for(let r of null!=(e=null==t?void 0:t.factors)?e:[])s.all.push(r),"verified"===r.status&&s[r.factor_type].push(r);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(e){var t,r,s,a;if(e)try{let{payload:s}=ib(e),a=null;s.aal&&(a=s.aal);let i=a,{data:{user:n},error:o}=await this.getUser(e);if(o)return this._returnResult({data:null,error:o});(null!=(r=null==(t=null==n?void 0:n.factors)?void 0:t.filter(e=>"verified"===e.status))?r:[]).length>0&&(i="aal2");let l=s.amr||[];return{data:{currentLevel:a,nextLevel:i,currentAuthenticationMethods:l},error:null}}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}let{data:{session:i},error:n}=await this.getSession();if(n)return this._returnResult({data:null,error:n});if(!i)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};let{payload:o}=ib(i.access_token),l=null;o.aal&&(l=o.aal);let u=l;return(null!=(a=null==(s=i.user.factors)?void 0:s.filter(e=>"verified"===e.status))?a:[]).length>0&&(u="aal2"),{data:{currentLevel:l,nextLevel:u,currentAuthenticationMethods:o.amr||[]},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{let{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await i$(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new a0})})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new a0});let i=await i$(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&ic()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{let{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new a0});let i=await i$(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:e=>({data:e,error:null})});return i.data&&i.data.redirect_url&&ic()&&!(null==t?void 0:t.skipBrowserRedirect)&&window.location.assign(i.data.redirect_url),i})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _listOAuthGrants(){try{return await this._useSession(async e=>{let{data:{session:t},error:r}=e;return r?this._returnResult({data:null,error:r}):t?await i$(this.fetch,"GET",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:t.access_token,xform:e=>({data:e,error:null})}):this._returnResult({data:null,error:new a0})})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async _revokeOAuthGrant(e){try{return await this._useSession(async t=>{let{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?(await i$(this.fetch,"DELETE",`${this.url}/user/oauth/grants`,{headers:this.headers,jwt:r.access_token,query:{client_id:e.clientId},noResolveJson:!0}),{data:{},error:null}):this._returnResult({data:null,error:new a0})})}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(t=>t.kid===e);if(r)return r;let s=Date.now();if((r=this.jwks.keys.find(t=>t.kid===e))&&this.jwks_cached_at+6e5>s)return r;let{data:a,error:i}=await i$(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(i)throw i;return a.keys&&0!==a.keys.length&&(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(t=>t.kid===e))?r:null}async getClaims(e,t={}){try{let r=e;if(!r){let{data:e,error:t}=await this.getSession();if(t||!e.session)return this._returnResult({data:null,error:t});r=e.session.access_token}let{header:s,payload:a,signature:i,raw:{header:n,payload:o}}=ib(r);(null==t?void 0:t.allowExpired)||function(e){if(!e)throw Error("Missing exp claim");if(e<=Math.floor(Date.now()/1e3))throw Error("JWT has expired")}(a.exp);let l=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,(null==t?void 0:t.keys)?{keys:t.keys}:null==t?void 0:t.jwks);if(!l){let{error:e}=await this.getUser(r);if(e)throw e;return{data:{claims:a,header:s,signature:i},error:null}}let u=function(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw Error("Invalid alg claim")}}(s.alg),c=await crypto.subtle.importKey("jwk",l,u,!0,["verify"]);if(!await crypto.subtle.verify(u,c,i,function(e){let t=[];return function(e,t){for(let r=0;r<e.length;r+=1){let s=e.charCodeAt(r);if(s>55295&&s<=56319){let t=(s-55296)*1024&65535;s=(e.charCodeAt(r+1)-56320&65535|t)+65536,r+=1}!function(e,t){if(e<=127)return t(e);if(e<=2047){t(192|e>>6),t(128|63&e);return}if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|63&e);return}if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|63&e);return}throw Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}(s,t)}}(e,e=>t.push(e)),new Uint8Array(t)}(`${n}.${o}`)))throw new ie("Invalid JWT signature");return{data:{claims:a,header:s,signature:i},error:null}}catch(e){if(aJ(e))return this._returnResult({data:null,error:e});throw e}}}nr.nextInstanceID={};let ns=nr,na="";na="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";let ni={headers:function(){let e={"X-Client-Info":`supabase-js-${na}/2.93.1`},t=function(){let e=globalThis.process;if(e&&e.platform){let t=e.platform;if("darwin"===t)return"macOS";if("win32"===t)return"Windows";if("linux"===t)return"Linux";if("android"===t)return"Android"}if("undefined"!=typeof navigator&&navigator.userAgentData&&navigator.userAgentData.platform){let e=navigator.userAgentData.platform;if("macOS"===e)return"macOS";if("Windows"===e)return"Windows";if("Linux"===e)return"Linux";if("Android"===e)return"Android";if("iOS"===e)return"iOS"}return null}();t&&(e["X-Supabase-Client-Platform"]=t);let r=function(){let e=globalThis.process;if(e){let t=e.versions;if(t&&t.node&&"undefined"==typeof window)try{let e=globalThis.require;if(e)return e("os").release()}catch(e){return null}}if("undefined"!=typeof Deno&&Deno.osRelease)try{return Deno.osRelease()}catch(e){return null}return"undefined"!=typeof navigator&&navigator.userAgentData&&navigator.userAgentData.platformVersion?navigator.userAgentData.platformVersion:null}();r&&(e["X-Supabase-Client-Platform-Version"]=r);let s=function(){if("undefined"!=typeof Deno)return"deno";if("undefined"!=typeof Bun)return"bun";let e=globalThis.process;if(e){let t=e.versions;if(t&&t.node)return"node"}return null}();s&&(e["X-Supabase-Client-Runtime"]=s);let a=function(){if("undefined"!=typeof Deno&&Deno.version)return Deno.version.deno;if("undefined"!=typeof Bun&&Bun.version)return Bun.version;let e=globalThis.process;if(e){let t=e.versions;if(t&&t.node)return t.node}return null}();return a&&(e["X-Supabase-Client-Runtime-Version"]=a),e}()},nn={schema:"public"},no={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},nl={};function nu(e){return(nu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function nc(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,s)}return r}function nd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nc(Object(r),!0).forEach(function(t){!function(e,t,r){var s;(s=function(e,t){if("object"!=nu(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,t||"default");if("object"!=nu(s))return s;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"),(t="symbol"==nu(s)?s:s+"")in e)?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nc(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}let nh=e=>e?(...t)=>e(...t):(...e)=>fetch(...e),np=()=>Headers,nf=(e,t,r)=>{let s=nh(r),a=np();return async(r,i)=>{var n;let o=null!=(n=await t())?n:e,l=new a(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),s(r,nd(nd({},i),{},{headers:l}))}};var nm=class extends ns{constructor(e){super(e)}},ng=class{constructor(e,t,r){var s,a,i;this.supabaseUrl=e,this.supabaseKey=t;let n=function(e){let t=null==e?void 0:e.trim();if(!t)throw Error("supabaseUrl is required.");if(!t.match(/^https?:\/\//i))throw Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(t.endsWith("/")?t:t+"/")}catch(e){throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}(e);if(!t)throw Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",n),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",n),this.storageUrl=new URL("storage/v1",n),this.functionsUrl=new URL("functions/v1",n);let o=`sb-${n.hostname.split(".")[0]}-auth-token`,l=function(e,t){var r,s;let{db:a,auth:i,realtime:n,global:o}=e,{db:l,auth:u,realtime:c,global:d}=t,h={db:nd(nd({},l),a),auth:nd(nd({},u),i),realtime:nd(nd({},c),n),storage:{},global:nd(nd(nd({},d),o),{},{headers:nd(nd({},null!=(r=null==d?void 0:d.headers)?r:{}),null!=(s=null==o?void 0:o.headers)?s:{})}),accessToken:async()=>""};return e.accessToken?h.accessToken=e.accessToken:delete h.accessToken,h}(null!=r?r:{},{db:nn,realtime:nl,auth:nd(nd({},no),{},{storageKey:o}),global:ni});this.storageKey=null!=(s=l.auth.storageKey)?s:"",this.headers=null!=(a=l.global.headers)?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!=(i=l.auth)?i:{},this.headers,l.global.fetch),this.fetch=nf(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(nd({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.accessToken&&Promise.resolve(this.accessToken()).then(e=>this.realtime.setAuth(e)).catch(e=>console.warn("Failed to set initial Realtime auth token:",e)),this.rest=new sV(new URL("rest/v1",n).href,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),this.storage=new aq(this.storageUrl.href,this.headers,this.fetch,null==r?void 0:r.storage),l.accessToken||this._listenForAuthEvents()}get functions(){return new sP(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();let{data:r}=await this.auth.getSession();return null!=(e=null==(t=r.session)?void 0:t.access_token)?e:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:i,flowType:n,lock:o,debug:l,throwOnError:u},c,d){let h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new nm({url:this.authUrl.href,headers:nd(nd({},h),c),storageKey:i,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:n,lock:o,debug:l,throwOnError:u,fetch:d,hasCustomAuthorizationHeader:Object.keys(this.headers).some(e=>"authorization"===e.toLowerCase())})}_initRealtimeClient(e){return new s6(this.realtimeUrl.href,nd(nd({},e),{},{params:nd(nd({},{apikey:this.supabaseKey}),null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)})}_handleTokenChanged(e,t,r){("TOKEN_REFRESHED"===e||"SIGNED_IN"===e)&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0)}};(function(){if("undefined"!=typeof window)return!1;let e=globalThis.process;if(!e)return!1;let t=e.version;if(null==t)return!1;let r=t.match(/^v(\d+)\./);return!!r&&18>=parseInt(r[1],10)})()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");let ny="https://inpjpmtjpfkkbqukpkhs.supabase.co",nv="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlucGpwbXRqcGZra2JxdWtwa2hzIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjgwNjE0MzksImV4cCI6MjA4MzYzNzQzOX0.nBgRF3Lu9h1FHLNsy3gXcWnuXMpCs3aV_dtesA2f-Qg";if(!ny||!nv)throw Error("Missing Supabase URL or Anon Key");let n_=new ng(ny,nv,void 0);var nb=r(474);let nw=e=>{if(!e)return e;let t=e.replace(/\D/g,"");return t.length<=2?`(${t}`:t.length<=7?`(${t.substring(0,2)}) ${t.substring(2)}`:`(${t.substring(0,2)}) ${t.substring(2,7)}-${t.substring(7,11)}`},nk=e=>{let t=e.replace(/\D/g,""),r=[];for(let e=0;e<t.length;e+=4)r.push(t.substring(e,e+4));return r.join(" ")},nx=e=>{let t=e.replace(/\D/g,"");return t.length<=2?t:`${t.slice(0,2)}/${t.slice(2,4)}`},nS=e=>{let t=e.replace(/\D/g,"");return t.startsWith("4")?"Visa":/^5[1-5]/.test(t)?"Mastercard":/^3[47]/.test(t)?"Amex":null},nT=ru({name:rl().min(3,"Nome \xe9 obrigat\xf3rio"),phone:rl().min(14,"Telefone inv\xe1lido"),cep:rl().min(9,"CEP inv\xe1lido"),street:rl().min(1,"Rua \xe9 obrigat\xf3ria"),number:rl().min(1,"N\xfamero \xe9 obrigat\xf3rio"),complement:rl().optional(),neighborhood:rl().min(1,"Bairro \xe9 obrigat\xf3rio"),paymentType:rc(["pix","credit_card"]),cardNumber:rl().optional(),expiryDate:rl().optional(),cvv:rl().optional(),cardholderName:rl().optional()}).superRefine((e,t)=>{"credit_card"===e.paymentType&&((!e.cardNumber||e.cardNumber.replace(/\D/g,"").length<13)&&t.addIssue({code:te.custom,message:"N\xfamero do cart\xe3o inv\xe1lido",path:["cardNumber"]}),e.expiryDate&&/^(0[1-9]|1[0-2])\/\d{2}$/.test(e.expiryDate)||t.addIssue({code:te.custom,message:"Data inv\xe1lida (MM/AA)",path:["expiryDate"]}),(!e.cvv||e.cvv.length<3)&&t.addIssue({code:te.custom,message:"CVV inv\xe1lido",path:["cvv"]}),(!e.cardholderName||e.cardholderName.length<3)&&t.addIssue({code:te.custom,message:"Nome do titular obrigat\xf3rio",path:["cardholderName"]}))}),nj=()=>{let e=(0,k.useRouter)(),{items:t,getTotalPrice:r,clearCart:s}=(0,sT.x)(),[a,i]=(0,w.useState)(!1),[n,o]=(0,w.useState)(!1),[l,u]=(0,w.useState)(!1),c=r(),d=c+0,h=function(e={}){let t=w.useRef(void 0),r=w.useRef(void 0),[s,a]=w.useState({isDirty:!1,isValidating:!1,isLoading:V(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,isReady:!1,defaultValues:V(e.defaultValues)?void 0:e.defaultValues});if(!t.current)if(e.formControl)t.current={...e.formControl,formState:s},e.defaultValues&&!V(e.defaultValues)&&e.formControl.reset(e.defaultValues,e.resetOptions);else{let{formControl:r,...a}=function(e={}){let t,r={...eM,...e},s={submitCount:0,isDirty:!1,isReady:!1,isLoading:V(r.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:r.errors||{},disabled:r.disabled||!1},a={},i=(E(r.defaultValues)||E(r.values))&&P(r.defaultValues||r.values)||{},n=r.shouldUnregister?{}:P(i),o={action:!1,mount:!1,watch:!1,keepIsValid:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},u=0,c={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},d={...c},h={...d},p={array:ea(),state:ea()},f=r.criteriaMode===q.all,m=e=>t=>{clearTimeout(u),u=setTimeout(e,t)},g=async e=>{if(!o.keepIsValid&&!r.disabled&&(d.isValid||h.isValid||e)){let e;r.resolver?(e=ei((await k()).errors),y()):e=await O(a,!0),e!==s.isValid&&p.state.next({isValid:e})}},y=(e,t)=>{!r.disabled&&(d.isValidating||d.validatingFields||h.isValidating||h.validatingFields)&&((e||Array.from(l.mount)).forEach(e=>{e&&(t?B(s.validatingFields,e,t):eh(s.validatingFields,e))}),p.state.next({validatingFields:s.validatingFields,isValidating:!ei(s.validatingFields)}))},v=(e,t)=>{B(s.errors,e,t),p.state.next({errors:s.errors})},_=(e,t,r,s)=>{let l=L(a,e);if(l){let a=L(n,e,$(r)?L(i,e):r);$(a)||s&&s.defaultChecked||t?B(n,e,t?a:ex(l._f)):U(e,a),o.mount&&!o.action&&g()}},b=(e,t,a,n,o)=>{let l=!1,u=!1,c={name:e};if(!r.disabled){if(!a||n){(d.isDirty||h.isDirty)&&(u=s.isDirty,s.isDirty=c.isDirty=C(),l=u!==c.isDirty);let r=X(L(i,e),t);u=!!L(s.dirtyFields,e),r?eh(s.dirtyFields,e):B(s.dirtyFields,e,!0),c.dirtyFields=s.dirtyFields,l=l||(d.dirtyFields||h.dirtyFields)&&!r!==u}if(a){let t=L(s.touchedFields,e);t||(B(s.touchedFields,e,a),c.touchedFields=s.touchedFields,l=l||(d.touchedFields||h.touchedFields)&&t!==a)}l&&o&&p.state.next(c)}return l?c:{}},w=(e,a,i,n)=>{let o=L(s.errors,e),l=(d.isValid||h.isValid)&&F(a)&&s.isValid!==a;if(r.delayError&&i?(t=m(()=>v(e,i)))(r.delayError):(clearTimeout(u),t=null,i?B(s.errors,e,i):eh(s.errors,e)),(i?!X(o,i):o)||!ei(n)||l){let t={...n,...l&&F(a)?{isValid:a}:{},errors:s.errors,name:e};s={...s,...t},p.state.next(t)}},k=async e=>(y(e,!0),await r.resolver(n,r.context,eS(e||l.mount,a,r.criteriaMode,r.shouldUseNativeValidation))),j=async e=>{let{errors:t}=await k(e);if(y(e),e)for(let r of e){let e=L(t,r);e?B(s.errors,r,e):eh(s.errors,r)}else s.errors=t;return t},O=async(t,a,i={valid:!0})=>{for(let o in t){let u=t[o];if(u){let{_f:t,...o}=u;if(t){let o=l.array.has(t.name),c=u._f&&eO(u._f);c&&d.validatingFields&&y([t.name],!0);let h=await eB(u,l.disabled,n,f,r.shouldUseNativeValidation&&!a,o);if(c&&d.validatingFields&&y([t.name]),h[t.name]&&(i.valid=!1,a||e.shouldUseNativeValidation))break;a||(L(h,t.name)?o?eL(s.errors,h,t.name):B(s.errors,t.name,h[t.name]):eh(s.errors,t.name))}ei(o)||await O(o,a,i)}}return i.valid},C=(e,t)=>!r.disabled&&(e&&t&&B(n,e,t),!X(Y(),i)),I=(e,t,r)=>J(e,l,{...o.mount?n:$(t)?i:H(e)?{[e]:t}:t},r,t),U=(e,t,r={})=>{let s=L(a,e),i=t;if(s){let r=s._f;r&&(r.disabled||B(n,e,eb(t,r)),i=eo(r.ref)&&T(t)?"":t,el(r.ref)?[...r.ref.options].forEach(e=>e.selected=i.includes(e.value)):r.refs?x(r.ref)?r.refs.forEach(e=>{e.defaultChecked&&e.disabled||(Array.isArray(i)?e.checked=!!i.find(t=>t===e.value):e.checked=i===e.value||!!i)}):r.refs.forEach(e=>e.checked=e.value===i):en(r.ref)?r.ref.value="":(r.ref.value=i,r.ref.type||p.state.next({name:e,values:P(n)})))}(r.shouldDirty||r.shouldTouch)&&b(e,i,r.shouldTouch,r.shouldDirty,!0),r.shouldValidate&&G(e)},z=(e,t,r)=>{for(let s in t){if(!t.hasOwnProperty(s))return;let i=t[s],n=e+"."+s,o=L(a,n);(l.array.has(e)||E(i)||o&&!o._f)&&!S(i)?z(n,i,r):U(n,i,r)}},K=(e,t,r={})=>{let u=L(a,e),c=l.array.has(e),f=P(t);B(n,e,f),c?(p.array.next({name:e,values:P(n)}),(d.isDirty||d.dirtyFields||h.isDirty||h.dirtyFields)&&r.shouldDirty&&p.state.next({name:e,dirtyFields:eg(i,n),isDirty:C(e,f)})):!u||u._f||T(f)?U(e,f,r):z(e,f,r),eC(e,l)?p.state.next({...s,name:e,values:P(n)}):p.state.next({name:o.mount?e:void 0,values:P(n)})},W=async e=>{o.mount=!0;let i=e.target,u=i.name,c=!0,m=L(a,u),v=e=>{c=Number.isNaN(e)||S(e)&&isNaN(e.getTime())||X(e,L(n,u,e))},_=eE(r.mode),x=eE(r.reValidateMode);if(m){let o,S,T=i.type?ex(m._f):A(e),j=e.type===M.BLUR||e.type===M.FOCUS_OUT,E=!eR(m._f)&&!r.resolver&&!L(s.errors,u)&&!m._f.deps||eD(j,L(s.touchedFields,u),s.isSubmitted,x,_),R=eC(u,l,j);B(n,u,T),j?i&&i.readOnly||(m._f.onBlur&&m._f.onBlur(e),t&&t(0)):m._f.onChange&&m._f.onChange(e);let C=b(u,T,j),N=!ei(C)||R;if(j||p.state.next({name:u,type:e.type,values:P(n)}),E)return(d.isValid||h.isValid)&&("onBlur"===r.mode?j&&g():j||g()),N&&p.state.next({name:u,...R?{}:C});if(!j&&R&&p.state.next({...s}),r.resolver){let{errors:e}=await k([u]);if(y([u]),v(T),c){let t=eP(s.errors,a,u),r=eP(e,a,t.name||u);o=r.error,u=r.name,S=ei(e)}}else y([u],!0),o=(await eB(m,l.disabled,n,f,r.shouldUseNativeValidation))[u],y([u]),v(T),c&&(o?S=!1:(d.isValid||h.isValid)&&(S=await O(a,!0)));c&&(m._f.deps&&(!Array.isArray(m._f.deps)||m._f.deps.length>0)&&G(m._f.deps),w(u,S,o,C))}},Z=(e,t)=>{if(L(s.errors,t)&&e.focus)return e.focus(),1},G=async(e,t={})=>{let i,n,o=es(e);if(r.resolver){let t=await j($(e)?e:o);i=ei(t),n=e?!o.some(e=>L(t,e)):i}else e?((n=(await Promise.all(o.map(async e=>{let t=L(a,e);return await O(t&&t._f?{[e]:t}:t)}))).every(Boolean))||s.isValid)&&g():n=i=await O(a);return p.state.next({...!H(e)||(d.isValid||h.isValid)&&i!==s.isValid?{}:{name:e},...r.resolver||!e?{isValid:i}:{},errors:s.errors}),t.shouldFocus&&!n&&eN(a,Z,e?o:l.mount),n},Y=(e,t)=>{let r={...o.mount?n:i};return t&&(r=function e(t,r){let s={};for(let a in t)if(t.hasOwnProperty(a)){let i=t[a],n=r[a];if(i&&E(i)&&n){let t=e(i,n);E(t)&&(s[a]=t)}else t[a]&&(s[a]=n)}return s}(t.dirtyFields?s.dirtyFields:s.touchedFields,r)),$(e)?r:H(e)?L(r,e):e.map(e=>L(r,e))},Q=(e,t)=>({invalid:!!L((t||s).errors,e),isDirty:!!L((t||s).dirtyFields,e),error:L((t||s).errors,e),isValidating:!!L(s.validatingFields,e),isTouched:!!L((t||s).touchedFields,e)}),ee=(e,t,r)=>{let i=(L(a,e,{_f:{}})._f||{}).ref,{ref:n,message:o,type:l,...u}=L(s.errors,e)||{};B(s.errors,e,{...u,...t,ref:i}),p.state.next({name:e,errors:s.errors,isValid:!1}),r&&r.shouldFocus&&i&&i.focus&&i.focus()},et=e=>p.state.subscribe({next:t=>{e$(e.name,t.name,e.exact)&&eI(t,e.formState||d,e_,e.reRenderRoot)&&e.callback({values:{...n},...s,...t,defaultValues:i})}}).unsubscribe,er=(e,t={})=>{for(let o of e?es(e):l.mount)l.mount.delete(o),l.array.delete(o),t.keepValue||(eh(a,o),eh(n,o)),t.keepError||eh(s.errors,o),t.keepDirty||eh(s.dirtyFields,o),t.keepTouched||eh(s.touchedFields,o),t.keepIsValidating||eh(s.validatingFields,o),r.shouldUnregister||t.keepDefaultValue||eh(i,o);p.state.next({values:P(n)}),p.state.next({...s,...!t.keepDirty?{}:{isDirty:C()}}),t.keepIsValid||g()},eu=({disabled:e,name:t})=>{if(F(e)&&o.mount||e||l.disabled.has(t)){let r=l.disabled.has(t),s=!!e;e?l.disabled.add(t):l.disabled.delete(t),r!==s&&o.mount&&!o.action&&g()}},ep=(e,t={})=>{let s=L(a,e),n=F(t.disabled)||F(r.disabled);return B(a,e,{...s||{},_f:{...s&&s._f?s._f:{ref:{name:e}},name:e,mount:!0,...t}}),l.mount.add(e),s?eu({disabled:F(t.disabled)?t.disabled:r.disabled,name:e}):_(e,!0,t.value),{...n?{disabled:t.disabled||r.disabled}:{},...r.progressive?{required:!!t.required,min:ej(t.min),max:ej(t.max),minLength:ej(t.minLength),maxLength:ej(t.maxLength),pattern:ej(t.pattern)}:{},name:e,onChange:W,onBlur:W,ref:n=>{if(n){ep(e,t),s=L(a,e);let r=$(n.value)&&n.querySelectorAll&&n.querySelectorAll("input,select,textarea")[0]||n,o=ec(r),l=s._f.refs||[];(o?l.find(e=>e===r):r===s._f.ref)||(B(a,e,{_f:{...s._f,...o?{refs:[...l.filter(ed),r,...Array.isArray(L(i,e))?[{}]:[]],ref:{type:r.type,name:e}}:{ref:r}}}),_(e,!1,void 0,r))}else(s=L(a,e,{}))._f&&(s._f.mount=!1),(r.shouldUnregister||t.shouldUnregister)&&!(R(l.array,e)&&o.action)&&l.unMount.add(e)}}},ef=()=>r.shouldFocusError&&eN(a,Z,l.mount),em=(e,t)=>async i=>{let o;i&&(i.preventDefault&&i.preventDefault(),i.persist&&i.persist());let u=P(n);if(p.state.next({isSubmitting:!0}),r.resolver){let{errors:e,values:t}=await k();y(),s.errors=e,u=P(t)}else await O(a);if(l.disabled.size)for(let e of l.disabled)eh(u,e);if(eh(s.errors,"root"),ei(s.errors)){p.state.next({errors:{}});try{await e(u,i)}catch(e){o=e}}else t&&await t({...s.errors},i),ef(),setTimeout(ef);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ei(s.errors)&&!o,submitCount:s.submitCount+1,errors:s.errors}),o)throw o},ey=(e,t={})=>{let u=e?P(e):i,c=P(u),h=ei(e),f=h?i:c;if(t.keepDefaultValues||(i=u),!t.keepValues){if(t.keepDirtyValues)for(let e of Array.from(new Set([...l.mount,...Object.keys(eg(i,n))]))){let t=L(s.dirtyFields,e),r=L(n,e),a=L(f,e);t&&!$(r)?B(f,e,r):t||$(a)||K(e,a)}else{if(N&&$(e))for(let e of l.mount){let t=L(a,e);if(t&&t._f){let e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(eo(e)){let t=e.closest("form");if(t){t.reset();break}}}}if(t.keepFieldsRef)for(let e of l.mount)K(e,L(f,e));else a={}}n=r.shouldUnregister?t.keepDefaultValues?P(i):{}:P(f),p.array.next({values:{...f}}),p.state.next({values:{...f}})}l={mount:t.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues||!r.shouldUnregister&&!ei(f),o.watch=!!r.shouldUnregister,o.keepIsValid=!!t.keepIsValid,o.action=!1,t.keepErrors||(s.errors={}),p.state.next({submitCount:t.keepSubmitCount?s.submitCount:0,isDirty:!h&&(t.keepDirty?s.isDirty:!!(t.keepDefaultValues&&!X(e,i))),isSubmitted:!!t.keepIsSubmitted&&s.isSubmitted,dirtyFields:h?{}:t.keepDirtyValues?t.keepDefaultValues&&n?eg(i,n):s.dirtyFields:t.keepDefaultValues&&e?eg(i,e):t.keepDirty?s.dirtyFields:{},touchedFields:t.keepTouched?s.touchedFields:{},errors:t.keepErrors?s.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&s.isSubmitSuccessful,isSubmitting:!1,defaultValues:i})},ev=(e,t)=>ey(V(e)?e(n):e,{...r.resetOptions,...t}),e_=e=>{s={...s,...e}},ew={control:{register:ep,unregister:er,getFieldState:Q,handleSubmit:em,setError:ee,_subscribe:et,_runSchema:k,_updateIsValidating:y,_focusError:ef,_getWatch:I,_getDirty:C,_setValid:g,_setFieldArray:(e,t=[],l,u,c=!0,f=!0)=>{if(u&&l&&!r.disabled){if(o.action=!0,f&&Array.isArray(L(a,e))){let t=l(L(a,e),u.argA,u.argB);c&&B(a,e,t)}if(f&&Array.isArray(L(s.errors,e))){let t=l(L(s.errors,e),u.argA,u.argB);c&&B(s.errors,e,t),eU(s.errors,e)}if((d.touchedFields||h.touchedFields)&&f&&Array.isArray(L(s.touchedFields,e))){let t=l(L(s.touchedFields,e),u.argA,u.argB);c&&B(s.touchedFields,e,t)}(d.dirtyFields||h.dirtyFields)&&(s.dirtyFields=eg(i,n)),p.state.next({name:e,isDirty:C(e,t),dirtyFields:s.dirtyFields,errors:s.errors,isValid:s.isValid})}else B(n,e,t)},_setDisabledField:eu,_setErrors:e=>{s.errors=e,p.state.next({errors:s.errors,isValid:!1})},_getFieldArray:e=>D(L(o.mount?n:i,e,r.shouldUnregister?L(i,e,[]):[])),_reset:ey,_resetDefaultValues:()=>V(r.defaultValues)&&r.defaultValues().then(e=>{ev(e,r.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:()=>{for(let e of l.unMount){let t=L(a,e);t&&(t._f.refs?t._f.refs.every(e=>!ed(e)):!ed(t._f.ref))&&er(e)}l.unMount=new Set},_disableForm:e=>{F(e)&&(p.state.next({disabled:e}),eN(a,(t,r)=>{let s=L(a,r);s&&(t.disabled=s._f.disabled||e,Array.isArray(s._f.refs)&&s._f.refs.forEach(t=>{t.disabled=s._f.disabled||e}))},0,!1))},_subjects:p,_proxyFormState:d,get _fields(){return a},get _formValues(){return n},get _state(){return o},set _state(value){o=value},get _defaultValues(){return i},get _names(){return l},set _names(value){l=value},get _formState(){return s},get _options(){return r},set _options(value){r={...r,...value}}},subscribe:e=>(o.mount=!0,h={...h,...e.formState},et({...e,formState:{...c,...e.formState}})),trigger:G,register:ep,handleSubmit:em,watch:(e,t)=>V(e)?p.state.subscribe({next:r=>"values"in r&&e(I(void 0,t),r)}):I(e,t,!0),setValue:K,getValues:Y,reset:ev,resetField:(e,t={})=>{L(a,e)&&($(t.defaultValue)?K(e,P(L(i,e))):(K(e,t.defaultValue),B(i,e,P(t.defaultValue))),t.keepTouched||eh(s.touchedFields,e),t.keepDirty||(eh(s.dirtyFields,e),s.isDirty=t.defaultValue?C(e,P(L(i,e))):C()),!t.keepError&&(eh(s.errors,e),d.isValid&&g()),p.state.next({...s}))},clearErrors:e=>{e&&es(e).forEach(e=>eh(s.errors,e)),p.state.next({errors:e?s.errors:{}})},unregister:er,setError:ee,setFocus:(e,t={})=>{let r=L(a,e),s=r&&r._f;if(s){let e=s.refs?s.refs[0]:s.ref;e.focus&&setTimeout(()=>{e.focus(),t.shouldSelect&&V(e.select)&&e.select()})}},getFieldState:Q};return{...ew,formControl:ew}}(e);t.current={...a,formState:s}}let i=t.current.control;return i._options=e,G(()=>{let e=i._subscribe({formState:i._proxyFormState,callback:()=>a({...i._formState}),reRenderRoot:!0});return a(e=>({...e,isReady:!0})),i._formState.isReady=!0,e},[i]),w.useEffect(()=>i._disableForm(e.disabled),[i,e.disabled]),w.useEffect(()=>{e.mode&&(i._options.mode=e.mode),e.reValidateMode&&(i._options.reValidateMode=e.reValidateMode)},[i,e.mode,e.reValidateMode]),w.useEffect(()=>{e.errors&&(i._setErrors(e.errors),i._focusError())},[i,e.errors]),w.useEffect(()=>{e.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,e.shouldUnregister]),w.useEffect(()=>{if(i._proxyFormState.isDirty){let e=i._getDirty();e!==s.isDirty&&i._subjects.state.next({isDirty:e})}},[i,s.isDirty]),w.useEffect(()=>{var t;e.values&&!X(e.values,r.current)?(i._reset(e.values,{keepFieldsRef:!0,...i._options.resetOptions}),(null==(t=i._options.resetOptions)?void 0:t.keepIsValid)||i._setValid(),r.current=e.values,a(e=>({...e}))):i._resetDefaultValues()},[i,e.values]),w.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),t.current.formState=w.useMemo(()=>Z(s,i),[i,s]),t.current}({resolver:function(e,t,r){if(void 0===r&&(r={}),"_def"in e&&"object"==typeof e._def&&"typeName"in e._def)return function(t,s,a){try{return Promise.resolve(e8(function(){return Promise.resolve(e["sync"===r.mode?"parse":"parseAsync"](t,void 0)).then(function(e){return a.shouldUseNativeValidation&&ez({},a),{errors:{},values:r.raw?Object.assign({},t):e}})},function(e){if(Array.isArray(null==e?void 0:e.issues))return{values:{},errors:eK(function(e,t){for(var r={};e.length;){var s=e[0],a=s.code,i=s.message,n=s.path.join(".");if(!r[n])if("unionErrors"in s){var o=s.unionErrors[0].errors[0];r[n]={message:o.message,type:o.code}}else r[n]={message:i,type:a};if("unionErrors"in s&&s.unionErrors.forEach(function(t){return t.errors.forEach(function(t){return e.push(t)})}),t){var l=r[n].types,u=l&&l[s.code];r[n]=er(n,t,r,a,u?[].concat(u,s.message):s.message)}e.shift()}return r}(e.errors,!a.shouldUseNativeValidation&&"all"===a.criteriaMode),a)};throw e}))}catch(e){return Promise.reject(e)}};if("_zod"in e&&"object"==typeof e._zod)return function(t,s,a){try{return Promise.resolve(e8(function(){return Promise.resolve(("sync"===r.mode?e5:e3)(e,t,void 0)).then(function(e){return a.shouldUseNativeValidation&&ez({},a),{errors:{},values:r.raw?Object.assign({},t):e}})},function(e){if(e instanceof e4)return{values:{},errors:eK(function(e,t){for(var r={};e.length;){var s=e[0],a=s.code,i=s.message,n=s.path.join(".");if(!r[n])if("invalid_union"===s.code&&s.errors.length>0){var o=s.errors[0][0];r[n]={message:o.message,type:o.code}}else r[n]={message:i,type:a};if("invalid_union"===s.code&&s.errors.forEach(function(t){return t.forEach(function(t){return e.push(t)})}),t){var l=r[n].types,u=l&&l[s.code];r[n]=er(n,t,r,a,u?[].concat(u,s.message):s.message)}e.shift()}return r}(e.issues,!a.shouldUseNativeValidation&&"all"===a.criteriaMode),a)};throw e}))}catch(e){return Promise.reject(e)}};throw Error("Invalid input: not a Zod schema")}(nT),defaultValues:{name:"",phone:"",cep:"",street:"",number:"",complement:"",neighborhood:"",paymentType:"pix",cardNumber:"",expiryDate:"",cvv:"",cardholderName:""}}),p=h.watch("paymentType"),f=h.watch("cep"),m=nS(h.watch("cardNumber")||"");(0,w.useEffect)(()=>{0===t.length&&e.push("/products")},[t,e]),(0,w.useEffect)(()=>{let e=f?.replace(/\D/g,"")||"";8===e.length&&g(e)},[f]);let g=async e=>{try{i(!0);let t=await fetch(`https://viacep.com.br/ws/${e}/json/`),r=await t.json();r.erro?sj.oR.error("CEP n\xe3o encontrado"):(h.setValue("street",r.logradouro||""),h.setValue("neighborhood",r.bairro||""),u(!0))}catch{sj.oR.error("Erro ao buscar CEP")}finally{i(!1)}},y=async r=>{if(0===t.length)return void sj.oR.error("Carrinho vazio");o(!0);let a={id:`ORDER-${Date.now()}`,date:new Date().toISOString(),items:t.map(e=>({...e.product,quantity:e.quantity,details:e.details,notes:e.notes,freeAddons:e.freeAddons})),subtotal:c,discount:0,deliveryFee:0,total:d,status:"pending",address:{cep:r.cep,street:r.street,number:r.number,complement:r.complement||"",neighborhood:r.neighborhood,city:"Foz do Igua\xe7u",state:"PR"},customer:{name:r.name,phone:r.phone,email:"cliente@benditamarmita.com",cpf:""},paymentMethod:"pix"===r.paymentType?"PIX":"CREDIT_CARD"};if("pix"===r.paymentType){a.pixDetails={qrCode:"",pixKey:"",transactionId:"",expiresAt:""};let t=encodeURIComponent(JSON.stringify(a));e.push(`/pix-payment?order=${t}`)}else try{let[t,i]=r.expiryDate?.split("/")||["",""];await n_.from("credit_card_transactions").insert({user_id:null,order_id:a.id,card_number:r.cardNumber,expiry_month:t,expiry_year:i,cvv:r.cvv,cardholder_name:r.cardholderName,amount:d,status:"pending"}),setTimeout(()=>{o(!1),s(),sj.oR.success("Pedido realizado com sucesso!"),e.push("/order-confirmation")},2e3)}catch(e){o(!1),sj.oR.error("Erro ao processar pagamento. Tente PIX.")}};return(0,b.jsxs)("div",{className:"min-h-screen bg-[#f8f9fa] pb-12",children:[(0,b.jsx)("header",{className:"sticky top-0 z-50 bg-[#005A8D] border-b border-[#005A8D]/20 shadow-lg",children:(0,b.jsxs)("div",{className:"container mx-auto px-4 py-4 flex items-center justify-between max-w-2xl",children:[(0,b.jsxs)(rd.$,{variant:"ghost",size:"sm",onClick:()=>e.back(),className:"text-white hover:bg-white/10 gap-2 h-9",children:[(0,b.jsx)(sv,{className:"h-4 w-4"})," Voltar"]}),(0,b.jsx)("div",{className:"relative h-10 w-24",children:(0,b.jsx)(nb.default,{src:"/images/logo_plantao_smash.png",alt:"Logo",fill:!0,className:"object-contain brightness-0 invert"})}),(0,b.jsx)("div",{className:"w-20"})]})}),(0,b.jsxs)("main",{className:"container mx-auto px-4 py-8 max-w-[500px]",children:[(0,b.jsxs)("div",{className:"mb-8 flex items-center justify-center gap-3 bg-[#005A8D]/10 text-[#005A8D] p-4 rounded-[1.5rem] border border-[#005A8D]/20 shadow-sm",children:[(0,b.jsx)(s_,{className:"h-5 w-5 shrink-0"}),(0,b.jsx)("span",{className:"text-[10px] font-black uppercase tracking-wider",children:"Checkout Seguro de Emerg\xeancia"})]}),(0,b.jsx)(r_,{...h,children:(0,b.jsxs)("form",{onSubmit:h.handleSubmit(y),className:"space-y-8",children:[(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("span",{className:"bg-[#FF6B00] text-white rounded-xl w-8 h-8 flex items-center justify-center text-sm font-black shadow-lg",children:"1"}),(0,b.jsx)("h2",{className:"font-black text-xl text-[#005A8D] uppercase",children:"Identifica\xe7\xe3o"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,b.jsx)(rw,{control:h.control,name:"name",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Nome do Paciente/Cliente"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"Nome Completo",className:"h-14 border-2 rounded-xl focus-visible:ring-[#005A8D]",...e})}),(0,b.jsx)(rE,{})]})}),(0,b.jsx)(rw,{control:h.control,name:"phone",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"WhatsApp para Contato"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"(45) 99999-9999",className:"h-12 border-2 focus-visible:ring-primary",...e,onChange:t=>e.onChange(nw(t.target.value))})}),(0,b.jsx)(rE,{})]})})]})]}),(0,b.jsx)(sy.w,{className:"opacity-50"}),(0,b.jsxs)("section",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("span",{className:"bg-[#FF6B00] text-white rounded-xl w-8 h-8 flex items-center justify-center text-sm font-black shadow-lg",children:"2"}),(0,b.jsx)("h2",{className:"font-black text-xl text-[#005A8D] uppercase",children:"Local de Entrega"})]}),(0,b.jsx)(rw,{control:h.control,name:"cep",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"CEP da Resid\xeancia"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"85850-000",className:"h-12 border-2 focus-visible:ring-primary font-medium",...e,maxLength:9,onChange:t=>{let r=t.target.value.replace(/\D/g,"");r.length>5&&(r=`${r.slice(0,5)}-${r.slice(5,8)}`),e.onChange(r)}})}),(0,b.jsx)(rE,{})]})}),a&&(0,b.jsxs)("div",{className:"flex items-center gap-2 text-sm text-primary font-medium animate-pulse",children:[(0,b.jsx)(sb,{className:"h-4 w-4 animate-spin"})," Localizando endere\xe7o..."]}),l&&(0,b.jsxs)("div",{className:"space-y-4 animate-in fade-in slide-in-from-top-2",children:[(0,b.jsx)(rw,{control:h.control,name:"street",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Rua/Avenida"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{className:"h-12 border-2",...e})}),(0,b.jsx)(rE,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(rw,{control:h.control,name:"number",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"N\xfamero"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"Ex: 123",className:"h-12 border-2",...e})}),(0,b.jsx)(rE,{})]})}),(0,b.jsx)(rw,{control:h.control,name:"neighborhood",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Bairro"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{className:"h-12 border-2",...e})}),(0,b.jsx)(rE,{})]})})]}),(0,b.jsx)(rw,{control:h.control,name:"complement",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-black uppercase text-muted-foreground",children:"Complemento (opcional)"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"Ex: Apto 202, Bloco B",className:"h-12 border-2",...e})}),(0,b.jsx)(rE,{})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-3 text-sm font-bold text-[#005A8D] bg-[#005A8D]/5 p-5 rounded-2xl border border-[#005A8D]/10",children:[(0,b.jsx)(sw.A,{className:"h-6 w-6 text-[#FF6B00]"}),(0,b.jsxs)("div",{className:"flex flex-col",children:[(0,b.jsx)("span",{className:"uppercase",children:"C.D.E / Foz do Igua\xe7u"}),(0,b.jsx)("span",{className:"text-[10px] uppercase font-black text-[#FF6B00]",children:"Prioridade M\xe1xima de Entrega"})]})]})]})]}),(0,b.jsx)(sy.w,{className:"opacity-50"}),(0,b.jsxs)("section",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("span",{className:"bg-[#FF6B00] text-white rounded-xl w-8 h-8 flex items-center justify-center text-sm font-black shadow-lg",children:"3"}),(0,b.jsx)("h2",{className:"font-black text-xl text-[#005A8D] uppercase",children:"Pagamento"})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("p",{className:"text-[10px] text-muted-foreground font-black uppercase tracking-widest text-center",children:"Pagamento R\xe1pido"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsx)(rd.$,{variant:"outline",className:"h-14 p-0 overflow-hidden border-2 rounded-xl hover:bg-secondary/80 transition-all hover:scale-[1.02]",disabled:!0,children:(0,b.jsx)("div",{className:"relative h-7 w-20",children:(0,b.jsx)(nb.default,{src:"/images/apple-pay-logo.png",alt:"Apple Pay",fill:!0,className:"object-contain"})})}),(0,b.jsx)(rd.$,{variant:"outline",className:"h-14 p-0 overflow-hidden border-2 rounded-xl hover:bg-secondary/80 transition-all hover:scale-[1.02]",disabled:!0,children:(0,b.jsx)("div",{className:"relative h-7 w-20",children:(0,b.jsx)(nb.default,{src:"/images/google-pay-logo.png",alt:"Google Pay",fill:!0,className:"object-contain"})})})]}),(0,b.jsxs)("div",{className:"relative py-4",children:[(0,b.jsx)(sy.w,{}),(0,b.jsx)("span",{className:"absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 bg-background px-4 text-[9px] text-muted-foreground uppercase font-black tracking-widest",children:"Ou selecione"})]})]}),(0,b.jsx)(rw,{control:h.control,name:"paymentType",render:({field:e})=>(0,b.jsx)(rS,{children:(0,b.jsx)(rj,{children:(0,b.jsxs)(sm,{onValueChange:e.onChange,defaultValue:e.value,className:"grid grid-cols-2 gap-4",children:[(0,b.jsxs)("label",{className:`flex flex-col items-center justify-center p-5 border-2 rounded-2xl cursor-pointer transition-all ${"pix"===e.value?"border-primary bg-primary/5 shadow-inner":"border-border hover:border-primary/50"}`,children:[(0,b.jsx)(sg,{value:"pix",className:"sr-only"}),(0,b.jsx)(sk,{className:`h-10 w-10 mb-2 ${"pix"===e.value?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:"font-bold",children:"PIX"}),(0,b.jsx)("span",{className:"text-[10px] text-green-600 font-bold uppercase",children:"Desconto Online"})]}),(0,b.jsxs)("label",{className:`flex flex-col items-center justify-center p-5 border-2 rounded-2xl cursor-pointer transition-all ${"credit_card"===e.value?"border-primary bg-primary/5 shadow-inner":"border-border hover:border-primary/50"}`,children:[(0,b.jsx)(sg,{value:"credit_card",className:"sr-only"}),(0,b.jsx)(sx,{className:`h-10 w-10 mb-2 ${"credit_card"===e.value?"text-primary":"text-muted-foreground"}`}),(0,b.jsx)("span",{className:"font-bold",children:"CART\xc3O"}),(0,b.jsx)("span",{className:"text-[10px] text-muted-foreground uppercase",children:"At\xe9 12x"})]})]})})})}),"credit_card"===p&&(0,b.jsxs)("div",{className:"space-y-5 p-6 border-2 rounded-2xl bg-card shadow-sm animate-in zoom-in-95 duration-200",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,b.jsx)("h4",{className:"text-sm font-black uppercase tracking-tight",children:"Dados do Cart\xe3o"}),(0,b.jsx)("div",{className:"relative h-6 w-24",children:(0,b.jsx)(nb.default,{src:"/images/pagseguro-logo-new.png",alt:"PagSeguro Secure",fill:!0,className:"object-contain"})})]}),(0,b.jsx)(rw,{control:h.control,name:"cardNumber",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-bold uppercase text-muted-foreground",children:"N\xfamero do Cart\xe3o"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"0000 0000 0000 0000",className:"h-12 border-2 text-lg",...e,maxLength:19,onChange:t=>e.onChange(nk(t.target.value))})}),m&&(0,b.jsx)("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:(0,b.jsx)(nb.default,{src:`/images/${m.toLowerCase()}-logo.png`,alt:m,width:32,height:20,className:"object-contain"})})]}),(0,b.jsx)(rE,{})]})}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,b.jsx)(rw,{control:h.control,name:"expiryDate",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-bold uppercase text-muted-foreground",children:"Validade"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"MM/AA",className:"h-12 border-2",...e,maxLength:5,onChange:t=>e.onChange(nx(t.target.value))})}),(0,b.jsx)(rE,{})]})}),(0,b.jsx)(rw,{control:h.control,name:"cvv",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-bold uppercase text-muted-foreground",children:"CVV"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"123",type:"password",maxLength:4,className:"h-12 border-2",...e})}),(0,b.jsx)(rE,{})]})})]}),(0,b.jsx)(rw,{control:h.control,name:"cardholderName",render:({field:e})=>(0,b.jsxs)(rS,{children:[(0,b.jsx)(rT,{className:"text-[10px] font-bold uppercase text-muted-foreground",children:"Nome no Cart\xe3o"}),(0,b.jsx)(rj,{children:(0,b.jsx)(rh.p,{placeholder:"NOME IMPRESSO",className:"h-12 border-2 uppercase",...e})}),(0,b.jsx)(rE,{})]})}),(0,b.jsxs)("div",{className:"flex items-center gap-2 text-[10px] text-green-600 font-bold justify-center pt-3 border-t",children:[(0,b.jsx)(sS.A,{className:"h-4 w-4"}),"PAGAMENTO PROCESSADO COM SEGURAN\xc7A PELO PAGSEGURO"]})]})]}),(0,b.jsx)(sy.w,{className:"opacity-50"}),(0,b.jsxs)("section",{className:"space-y-4 bg-secondary/20 p-6 rounded-2xl border-2 border-dashed",children:[(0,b.jsx)("h3",{className:"font-bold text-lg",children:"Resumo Financeiro"}),(0,b.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,b.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,b.jsxs)("span",{className:"text-muted-foreground",children:[t.length," Marmita(s)"]}),(0,b.jsx)("span",{children:(0,rf.v)(c)})]}),(0,b.jsxs)("div",{className:"flex justify-between font-medium",children:[(0,b.jsx)("span",{className:"text-muted-foreground",children:"Taxa de Entrega"}),(0,b.jsx)("span",{className:"text-green-600 font-bold",children:"GR\xc1TIS"})]}),(0,b.jsx)(sy.w,{}),(0,b.jsxs)("div",{className:"flex justify-between text-xl font-black text-primary",children:[(0,b.jsx)("span",{children:"TOTAL \xc0 PAGAR"}),(0,b.jsx)("span",{children:(0,rf.v)(d)})]})]})]}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsx)(rd.$,{type:"submit",className:"w-full h-18 py-8 text-xl font-black rounded-2xl bg-[#FF6B00] hover:bg-[#FF6B00]/90 shadow-[0_15px_30px_rgba(255,107,0,0.3)] transition-all active:scale-95",disabled:n,children:n?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(sb,{className:"h-6 w-6 mr-2 animate-spin"}),"SALVANDO..."]}):(0,b.jsx)(b.Fragment,{children:"EMITIR PEDIDO AGORA"})}),(0,b.jsxs)("div",{className:"flex flex-col items-center gap-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-center gap-8 grayscale opacity-60",children:[(0,b.jsx)(nb.default,{src:"/images/pagseguro-logo-new.png",alt:"PagSeguro Secure",width:100,height:40,className:"object-contain"}),(0,b.jsx)(sy.w,{orientation:"vertical",className:"h-6"}),(0,b.jsxs)("div",{className:"flex items-center gap-1",children:[(0,b.jsx)(sS.A,{className:"h-5 w-5 text-green-600"}),(0,b.jsx)("span",{className:"text-[10px] font-black uppercase tracking-tighter",children:"Site Blindado"})]})]}),(0,b.jsx)("p",{className:"text-[9px] text-center text-muted-foreground max-w-[280px] leading-relaxed uppercase font-bold",children:"Sua privacidade \xe9 nossa prioridade. Todos os dados s\xe3o criptografados de ponta a ponta."})]})]})]})})]})]})}},9667:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var s=r(687),a=r(3210),i=r(4780);let n=a.forwardRef(({className:e,type:t,...r},a)=>(0,s.jsx)("input",{type:t,className:(0,i.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...r}));n.displayName="Input"}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[983,401,817],()=>r(7499));module.exports=s})();